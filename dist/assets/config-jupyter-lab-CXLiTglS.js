const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./antd-C-FgyWyA.js","./vue-PnzzEkKE.js"])))=>i.map(i=>d[i]);
import{k as ql,_ as Al}from"./index-D3w9uP0F.js";import{d as Il,ak as Nl,f as m,o as Vl,w as te,c as Ie,_ as g,a1 as f,$ as r,k as a,ac as F,a7 as s,F as x,ag as O,u as b,a6 as A,G as p,a9 as j,H as Pl,a2 as jl,ab as El,y as Ne}from"./vue-PnzzEkKE.js";import{R as Ve,u as fe,a as $l,s as Hl,c as Dl,g as Pe,d as Bl}from"./RichTextEditor-C2cgNlsO.js";import{b as me,d as Gl,a as je,c as Kl}from"./index-qgaYDQbP.js";import{u as Ol,a as zl,d as Jl}from"./dictionary-B4hIx2p6.js";import{g as Wl,a as Ql}from"./dictionary-CklELoci.js";import{H as V,j as Xl,t as Yl,x as ge,c as Zl,a as ea,m as la,u as aa,F as ta,b as oa,R as sa,N as na,d as ra,e as ia}from"./useFileTree-zzg9VuCs.js";import{a0 as n,a1 as ua,a2 as da,z as va,I as ca,a3 as pa,a4 as fa,a5 as ma,a6 as ga,a7 as ya,ab as _a,a8 as ka,H as ha,J as ba,K as wa,a9 as Ta,aa as Ca,f as Ua,e as xa,s as Sa,af as Ra,ae as Fa,T as Ma,D as La}from"./antd-C-FgyWyA.js";const qa={class:"config-jupyter-lab-page"},Aa={class:"page-container"},Ia={class:"steps-section"},Na={key:0},Va={class:"form-section"},Pa={class:"flex items-top gap-16px"},ja={class:"flex flex-col gap-12px"},Ea={key:0,class:"image-preview"},$a=["src"],Ha={class:"flex items-top gap-16px"},Da={class:"flex flex-col gap-12px"},Ba={key:0,class:"image-preview"},Ga=["src"],Ka={class:"form-section"},Oa={key:1},za={class:"form-section repository-section"},Ja={class:"repository-top-bar flex items-center gap-16px justify-between"},Wa={class:"repository-url-group"},Qa={class:"repository-main-area"},Xa={class:"repository-left"},Ya={class:"repository-switch-box flex items-center justify-between"},Za={class:"flex items-center gap-12px"},et={key:1,class:"repository-tips"},lt={class:"repository-right"},at={key:1,class:"empty-area"},tt={key:2,class:"step-content evaluation-step"},ot={class:"evaluation-section"},st={class:"section-block"},nt={class:"block-content"},rt={class:"file-select-wrapper"},it={class:"selected-files-list"},ut={style:{display:"flex","align-items":"center",gap:"8px"}},dt={key:0,class:"section-block"},vt={class:"block-header"},ct={class:"header-actions"},pt={class:"block-content"},ft={class:"test-set-label"},mt={class:"tab-footer-buttons"},gt={class:"reference-section"},yt={class:"section-block"},_t={class:"block-content"},kt={class:"tab-footer-buttons"},ht={key:3,class:"step-content environment-step"},bt={class:"environment-section"},wt={class:"environment-container"},Tt={class:"environment-left"},Ct={class:"search-box"},Ut={class:"environment-list"},xt=["onClick"],St={class:"environment-right"},Rt={class:"environment-config-header"},Ft={style:{display:"flex","align-items":"center",gap:"8px"}},Mt={class:"page-footer"},Ee="http://101.200.13.193",Lt=Il({name:"ConfigJupyterLab",__name:"config-jupyter-lab",setup(qt){V.registerLanguage("javascript",Xl),V.registerLanguage("typescript",Yl),V.registerLanguage("xml",ge),V.registerLanguage("html",ge),V.registerLanguage("vue",ge),V.registerLanguage("css",Zl),V.registerLanguage("json",ea),V.registerLanguage("markdown",la);const ye=Nl(),k=m(0),T=m(null),M=m(null),z=m(),_e=m(),oe=m(""),se=m(""),J=m(!1),W=m(!1),t=m({name:"",tag:"",fieldType:void 0,difficulty:1,environment:void 0,secondType:void 0,classHour:"",topCover:"",cover:"",description:"",showTaskRequire:!1,authType:1,enableCodeRepository:!1,repositoryType:"代码仓库",gitUrl:""});Vl(async()=>{var e;ne.load(),he.load(),$.load(),await $e();const l=history.state;console.log("接收到的路由数据:",l),l&&l.name?(t.value.name=l.name||"",t.value.description=l.description||"",t.value.difficulty=l.difficulty||1,t.value.environment=l.environment,t.value.secondType=l.secondType,t.value.classHour=l.classHour||"",t.value.showTaskRequire=l.showTaskRequire||!1,console.log("已自动填充表单数据:",{name:t.value.name,description:t.value.description,descriptionLength:((e=t.value.description)==null?void 0:e.length)||0,difficulty:t.value.difficulty,environment:t.value.environment,secondType:t.value.secondType,classHour:t.value.classHour,showTaskRequire:t.value.showTaskRequire})):console.log("未接收到路由数据")}),te(k,async(l,e)=>{l===2&&e===1&&!M.value&&T.value&&(console.log("进入第三步，自动创建任务..."),await hl())});const ke={name:[{required:!0,message:"请输入名称",trigger:"blur"}],tag:[{required:!0,message:"请输入技能标签",trigger:"blur"}],fieldType:[{required:!0,message:"请选择领域类别",trigger:"change"}],difficulty:[{required:!0,message:"请选择难度",trigger:"change"}],environment:[{required:!0,message:"请选择实验环境",trigger:"change"}],secondType:[{required:!0,message:"请选择小类别",trigger:"change"}],classHour:[{required:!0,message:"请输入学时",trigger:"blur"}],topCover:[{required:!0,message:"请上传顶部背景图",trigger:"change"}],cover:[{required:!0,message:"请上传封面图",trigger:"change"}],authType:[{required:!0,message:"请选择培训公开范围",trigger:"change"}]},ne=Ol(),he=zl(),$=Jl(),S=m([]),re=m(!1),$e=async()=>{try{re.value=!0;const l=Wl(3),e=await Ql({code:l});e&&e.list&&(S.value=e.list.map(u=>({label:u.name,value:String(u.value)})),console.log("加载环境选项:",{environmentOptions:S.value,currentEnvironment:t.value.environment}),t.value.environment?(R.value=String(t.value.environment),w.value.dockerImage=String(t.value.environment),console.log("使用第一步的环境:",t.value.environment)):!R.value&&S.value.length>0&&(R.value=S.value[0].value,w.value.dockerImage=S.value[0].value,t.value.environment=S.value[0].value,console.log("默认选中第一个环境:",S.value[0])))}catch(l){console.error("加载实验环境选项失败：",l),n.error("加载实验环境选项失败")}finally{re.value=!1}},He=[{label:"切换仓库",value:"切换仓库"},{label:"代码仓库",value:"代码仓库"},{label:"私密代码仓库",value:"私密代码仓库"}],H=m(!1),ie=m(new Set),De=[{title:"基本信息"},{title:"代码仓库"},{title:"评测设置"},{title:"实验环境"}],{fileTreeData:be,expandedKeys:ue,selectedFile:Be,highlightedCode:Ge,dynamicFileContents:Ke,handleSelectFile:Oe,getNodePath:we,addFileToTree:Te,addFolderToTree:ze,handleRenameNode:Je,handleCopyPath:We,loadRemoteFileTree:Qe,loadChildrenData:Xe,getNodePathFromMap:de}=aa(),D=m(!1),Q=m(!1),X=m(!1),Y=m(!1),B=m("/"),G=m("/"),Ce=m(null),Z=m("/"),Ye=async l=>{var c;if(!(l.size/1024/1024<12))return n.error("图片大小不能超过 12MB!"),!1;if(!(l.type==="image/jpeg"||l.type==="image/png"))return n.error("只能上传 JPG/PNG 格式的图片!"),!1;try{J.value=!0;const i=await fe(l);oe.value=Ee+i,t.value.topCover=i,(c=z.value)==null||c.validateFields(["topCover"]),n.success("顶部背景图上传成功")}catch{n.error("顶部背景图上传失败")}finally{J.value=!1}return!1},Ze=async l=>{var c;if(!(l.size/1024/1024<12))return n.error("图片大小不能超过 12MB!"),!1;if(!(l.type==="image/jpeg"||l.type==="image/png"))return n.error("只能上传 JPG/PNG 格式的图片!"),!1;try{W.value=!0;const i=await fe(l);se.value=Ee+i,t.value.cover=i,(c=z.value)==null||c.validateFields(["cover"]),n.success("封面图上传成功")}catch{n.error("封面图上传失败")}finally{W.value=!1}return!1},el=l=>{(typeof l=="boolean"?l:!!l)?D.value=!0:t.value.enableCodeRepository=!1},Ue=async()=>{try{const l=n.loading("正在查询仓库文件...",0),e=await Pe(t.value.gitUrl,"");Qe(e),ie.value.clear(),l(),n.success("仓库文件查询成功"),console.log("查询仓库地址：",t.value.gitUrl),console.log("获取到的文件列表：",e)}catch(l){n.error(l.message||"仓库文件查询失败"),console.error("仓库文件查询失败：",l)}},ll=async()=>{if(!t.value.gitUrl||!t.value.gitUrl.trim()){n.error("请先配置仓库地址"),xe();return}t.value.enableCodeRepository=!0,D.value=!1,H.value=!0,await Ue()},xe=()=>{t.value.enableCodeRepository=!1,D.value=!1};te(()=>t.value.repositoryType,l=>{l==="切换仓库"&&t.value.enableCodeRepository&&(H.value=!1,n.info("已解锁仓库地址，请重新输入"),Ne(()=>{t.value.repositoryType="代码仓库"}))});const al=()=>{var l;t.value.enableCodeRepository&&!H.value&&((l=t.value.gitUrl)!=null&&l.trim())&&(H.value=!0,Ue())},tl=async(l,e)=>{const{expanded:u,node:c}=e;if(u&&!c.isLeaf){const i=String(c.key);if(ie.value.has(i)){console.log("文件夹已加载，跳过：",i);return}try{const d=de(i);console.log("加载文件夹：",d,"节点key:",i);const h=n.loading(`正在加载 ${c.title}...`,0),y=await Pe(t.value.gitUrl,d);Xe(i,y),ie.value.add(i),h(),console.log("文件夹加载成功：",d,y)}catch(d){n.error(d.message||"加载文件夹失败"),console.error("加载文件夹失败：",d)}}},ol=l=>{switch(String(l.key)){case"newFile":Re();break;case"newFolder":Fe();break;case"upload":Se("/");break}},sl=(l,e)=>{const u=String(l.key),c=de(e.key)||we(e.key);switch(u){case"newFile":Re(c);break;case"newFolder":Fe(c);break;case"upload":Se(c);break;case"rename":Je(e);break;case"copyPath":We(e);break;case"delete":rl(e);break}},nl=l=>{const e=u=>{const c=u.findIndex(i=>i.key===l);if(c!==-1)return u.splice(c,1),!0;for(const i of u)if(i.children&&e(i.children))return!0;return!1};e(be.value)},rl=async l=>{const e=l.children!==void 0||l.isLeaf===!1,u=l.title,i=(de(l.key)||we(l.key)).split("/");i.pop();const d=i.join("/")||"",{Modal:h}=await ql(async()=>{const{Modal:y}=await import("./antd-C-FgyWyA.js").then(q=>q.aw);return{Modal:y}},__vite__mapDeps([0,1]),import.meta.url);h.confirm({title:"确认删除",content:`确定要删除${e?"文件夹":"文件"} "${u}" 吗？${e?"文件夹下的所有内容也会被删除。":""}`,okText:"确定",cancelText:"取消",okType:"danger",onOk:async()=>{let y=null;try{y=n.loading("正在删除...",0),await Bl({fileName:u,gitUrl:t.value.gitUrl,path:d}),nl(l.key),y(),n.success("删除成功"),console.log("删除成功：",{fileName:u,path:d})}catch(q){y&&y(),n.error(q.message||"删除失败"),console.error("删除失败：",q)}}})},Se=l=>{var e;Z.value=l,(e=Ce.value)==null||e.click()},il=async l=>{var c;const e=l.target,u=(c=e.files)==null?void 0:c[0];if(u)try{let i=Z.value==="/"?"":Z.value.replace(/^\//,"");const d=n.loading(`正在上传 ${u.name}...`,0);await $l(u,t.value.gitUrl,i);const h=new FileReader;h.onload=y=>{var _;const q=(_=y.target)==null?void 0:_.result;Te(u.name,q,Z.value)},h.readAsText(u),d(),n.success(`文件 ${u.name} 上传成功`),console.log("文件上传成功：",{fileName:u.name,path:i})}catch(i){n.error(i.message||"文件上传失败"),console.error("文件上传失败：",i)}finally{e&&(e.value="")}},Re=(l="/")=>{Q.value=!0,B.value=l},ul=async l=>{try{let e=B.value==="/"?"":B.value.replace(/^\//,"");const u=n.loading("正在保存文件...",0);await Hl({fileContent:l.fileContent,fileName:l.fileName,gitUrl:t.value.gitUrl,path:e,commit:l.commitMessage}),Te(l.fileName,l.fileContent,B.value),u(),n.success("文件创建成功"),Q.value=!1,console.log("文件保存成功：",{fileName:l.fileName,path:e})}catch(e){n.error(e.message||"文件创建失败"),console.error("文件创建失败：",e)}},Fe=(l="/")=>{X.value=!0,G.value=l},dl=async l=>{try{let e=G.value==="/"?l.folderName:`${G.value.replace(/^\//,"")}/${l.folderName}`;const u=n.loading("正在创建文件夹...",0);await Dl({commit:l.commitMessage,gitUrl:t.value.gitUrl,path:e}),ze(l.folderName,G.value),u(),n.success("文件夹创建成功"),X.value=!1,console.log("文件夹创建成功：",{folderName:l.folderName,path:e})}catch(e){n.error(e.message||"文件夹创建失败"),console.error("文件夹创建失败：",e)}},Me=m("settings"),v=m({openTestValidate:1,testValidateFiles:"",testValidateSh:"",timeLimitM:"",scoreRule:1,evaluationSetting:1,testSets:[{id:1,arg:"",answer:"",select:1},{id:2,arg:"",answer:"",select:1}]}),C=m({showAnswer:1,prohibitCopyAnswer:1,referenceAnswer:""}),ee=m(!1),le=m(!1);let vl=3;const cl=()=>{v.value.testSets.push({id:vl++,arg:"",answer:"",select:1})},pl=l=>{if(v.value.testSets.length===1){n.warning("至少保留一个测试集");return}v.value.testSets=v.value.testSets.filter(e=>e.id!==l),n.success("删除成功")},fl=(l,e)=>{l.select=e?1:2},I=m([]),ml=l=>{const{onSuccess:e}=l;setTimeout(()=>{e("ok")},0)},gl=async l=>{const{fileList:e}=l,u=e.filter(i=>i.status==="uploading"||i.status==="done"||!i.status);I.value=u;const c=u.filter(i=>i.originFileObj&&!i.url).map(async i=>{try{const d=await fe(i.originFileObj);return i.url=d,d}catch(d){return console.error("文件上传失败:",d),n.error(`文件 ${i.name} 上传失败`),null}});if(c.length>0){const d=(await Promise.all(c)).filter(h=>h!==null);if(d.length>0){const h=u.filter(y=>y.url).map(y=>y.url).join(",");v.value.testValidateFiles=h,n.success(`成功上传 ${d.length} 个文件`)}}},yl=l=>{I.value=l.map(u=>({uid:u.uid,name:u.name,status:"done",url:u.path}));const e=l.map(u=>u.path).join(",");v.value.testValidateFiles=e,n.success(`已选择 ${l.length} 个文件`),Y.value=!1},Le=()=>{k.value===0?ye.back():(k.value--,L())},_l=async()=>{try{const l={projectType:3,environment:t.value.environment,name:t.value.name,tag:t.value.tag,fieldType:t.value.fieldType,difficulty:t.value.difficulty,classHour:t.value.classHour,topCover:t.value.topCover,cover:t.value.cover,description:t.value.description,showTaskRequire:t.value.showTaskRequire?1:2,authType:t.value.authType,enableCodeRepository:t.value.enableCodeRepository,secondType:t.value.secondType};t.value.enableCodeRepository&&(l.repositoryType=t.value.repositoryType,l.gitUrl=t.value.gitUrl),console.log("提交项目数据：",l);let e;T.value?(l.id=T.value,e=await je(l),n.success("项目更新成功！"),console.log("更新成功：",e)):(e=await Kl(l),e&&e.id&&(T.value=e.id,console.log("项目ID已保存：",T.value)),n.success("项目创建成功！"),console.log("创建成功：",e)),k.value=2,L()}catch(l){console.error("操作失败：",l),n.error(T.value?"项目更新失败，请稍后重试":"项目创建失败，请稍后重试"),L()}},kl=async()=>{var l,e;if(k.value===0)try{await Promise.all([(l=z.value)==null?void 0:l.validate(),(e=_e.value)==null?void 0:e.validate()]),console.log("表单数据：",t.value),k.value=1,L()}catch{n.error("请完善必填信息"),L()}else if(k.value===1){if(t.value.enableCodeRepository&&(!t.value.gitUrl||t.value.gitUrl.trim()==="")){n.error("请输入仓库地址"),L();return}await _l()}else if(k.value===2){if(!ee.value){n.error("请先保存评测设置后再进行下一步"),L();return}if(!le.value){n.error("请先保存参考答案后再进行下一步"),L();return}k.value=3,L()}},hl=async()=>{try{if(!T.value){console.error("项目ID不存在，无法创建任务");return}const l={type:4,projectId:T.value,name:"JupyterLab环境实训任务"};console.log("自动提交任务数据：",l);const e=await Gl(l);e&&e.taskId&&(M.value=e.taskId,console.log("任务ID已保存：",M.value),n.success("任务创建成功！"))}catch(l){console.error("任务创建失败：",l),n.error("任务创建失败，请稍后重试")}},bl=async()=>{try{if(!M.value){n.error("任务ID不存在，请重新创建任务");return}if(v.value.openTestValidate===1){if(!v.value.testValidateFiles||v.value.testValidateFiles.trim()===""){n.error("请上传评测文件");return}if(!v.value.testValidateSh||v.value.testValidateSh.trim()===""){n.error("请输入评测执行命令");return}if(!v.value.timeLimitM){n.error("请输入评测时长限制");return}if(!v.value.testSets||v.value.testSets.length===0){n.error("请至少添加一个测试集");return}const u=v.value.testSets.filter(c=>c.select===1);if(u.length===0){n.error("请至少选中一个测试集");return}for(let c=0;c<u.length;c++){const i=u[c];if(!i.arg||i.arg.trim()===""){n.error(`测试集${c+1}的输入内容不能为空`);return}if(!i.answer||i.answer.trim()===""){n.error(`测试集${c+1}的期望输出不能为空`);return}}}const l=v.value.testSets.map(u=>({arg:u.arg,answer:u.answer,select:u.select})),e={taskId:M.value,projectId:T.value,openTestValidate:v.value.openTestValidate,testValidateFiles:v.value.testValidateFiles,testValidateSh:v.value.testValidateSh,timeLimitM:v.value.timeLimitM,scoreRule:v.value.scoreRule,evaluationSetting:v.value.evaluationSetting,testContent:JSON.stringify(l)};console.log("保存评测设置数据：",e),await me(e),ee.value=!0,n.success("评测设置保存成功！")}catch(l){console.error("评测设置保存失败：",l),n.error("评测设置保存失败，请重试")}},wl=async()=>{try{if(!M.value){n.error("任务ID不存在，请重新创建任务");return}if(!C.value.referenceAnswer||C.value.referenceAnswer.trim()===""){n.error("请输入参考答案内容");return}if(!C.value.referenceAnswer.replace(/<[^>]*>/g,"").trim()){n.error("请输入参考答案内容");return}const e={taskId:M.value,projectId:T.value,showAnswer:C.value.showAnswer,prohibitCopyAnswer:C.value.prohibitCopyAnswer,referenceAnswer:C.value.referenceAnswer};console.log("保存参考答案数据：",e),await me(e),le.value=!0,n.success("参考答案保存成功！")}catch(l){console.error("参考答案保存失败：",l),n.error("参考答案保存失败，请重试")}},Tl=async()=>{try{if(!T.value){n.error("项目ID不存在，请重新创建项目");return}if(!M.value){n.error("任务ID不存在，请重新创建任务");return}if(!ee.value){n.error("请先保存评测设置后再完成创建");return}if(!le.value){n.error("请先保存参考答案后再完成创建");return}if(!w.value.dockerImage){n.error("请选择实验环境");return}if(!w.value.timeLimitM){n.error("请输入实验环境使用时长");return}await me({taskId:M.value,projectId:T.value,dockerImage:w.value.dockerImage,secondType:w.value.secondType,timeLimitM:w.value.timeLimitM}),await je({id:T.value,status:10}),n.success("项目创建成功！"),setTimeout(()=>{ye.push("/dashboard/analysis")},500)}catch(l){console.error("完成创建失败：",l),n.error("完成创建失败，请重试")}},R=m(""),ae=m(""),Cl=Ie(()=>ae.value?S.value.filter(l=>l.label.toLowerCase().includes(ae.value.toLowerCase())):S.value),Ul=Ie(()=>{const l=S.value.find(e=>e.value===R.value);return l?l.label:"未选择"}),w=m({dockerImage:"",secondType:"Css",timeLimitM:""}),xl=l=>{R.value=l,w.value.dockerImage=l,t.value.environment!==l&&(t.value.environment=l)};te(()=>t.value.environment,l=>{console.log("formData.environment 变化:",l,"当前 selectedEnvironment:",R.value),l&&String(l)!==R.value&&(R.value=String(l),w.value.dockerImage=String(l),console.log("已同步到第四步:",R.value))}),te(()=>R.value,l=>{console.log("selectedEnvironment 变化为:",l)});const L=()=>{Ne(()=>{window.scrollTo({top:0,behavior:"smooth"}),document.documentElement.scrollTop=0,document.body.scrollTop=0;const l=document.querySelector(".page-content");l&&(l.scrollTop=0);const e=document.querySelector(".ant-layout-content");e&&(e.scrollTop=0),document.querySelectorAll("*").forEach(c=>{c.scrollTop>0&&(c.scrollTop=0)})})};return(l,e)=>{const u=ua,c=da,i=ca,d=va,h=fa,y=ma,q=pa,_=ya,P=ga,ve=_a,U=ha,ce=ka,qe=ba,K=wa,Sl=Ta,pe=xa,Rl=Ua,Fl=La,Ml=Ra,Ae=Sa,Ll=Ma;return f(),g("div",qa,[e[74]||(e[74]=r("div",{class:"page-header"},[r("h2",null,"JupyterLab环境实训项目配置")],-1)),r("div",Aa,[r("div",Ia,[a(c,{current:k.value,class:"custom-steps"},{default:s(()=>[(f(),g(x,null,O(De,(o,N)=>a(u,{key:N,title:o.title},null,8,["title"])),64))]),_:1},8,["current"])]),k.value===0?(f(),g("div",Na,[e[38]||(e[38]=r("div",{class:"section-title"},[r("h3",null,"基本信息")],-1)),r("div",Va,[a(K,{ref_key:"formRef",ref:z,model:t.value,rules:ke,layout:"horizontal","label-col":{span:2},"wrapper-col":{span:18}},{default:s(()=>[a(d,{label:"名称",name:"name",required:""},{default:s(()=>[a(i,{value:t.value.name,"onUpdate:value":e[0]||(e[0]=o=>t.value.name=o),placeholder:"请输入名称"},null,8,["value"])]),_:1}),a(q,null,{default:s(()=>[a(h,{span:12},{default:s(()=>[a(d,{label:"技能标签",name:"tag",required:"","label-col":{span:4},"wrapper-col":{span:20}},{default:s(()=>[a(i,{value:t.value.tag,"onUpdate:value":e[1]||(e[1]=o=>t.value.tag=o),placeholder:"请输入技能标签"},null,8,["value"])]),_:1})]),_:1}),a(h,{span:12},{default:s(()=>[a(d,{label:"领域类别",name:"fieldType",required:"","label-col":{span:4},"wrapper-col":{span:12}},{default:s(()=>[a(y,{value:t.value.fieldType,"onUpdate:value":e[2]||(e[2]=o=>t.value.fieldType=o),placeholder:"请选择领域类别",options:b(ne).options.value,loading:b(ne).loading.value},null,8,["value","options","loading"])]),_:1})]),_:1})]),_:1}),a(d,{label:"难度",name:"difficulty",required:""},{default:s(()=>[a(P,{value:t.value.difficulty,"onUpdate:value":e[3]||(e[3]=o=>t.value.difficulty=o),class:"custom-radio"},{default:s(()=>[(f(!0),g(x,null,O(b(he).data.value,o=>(f(),A(_,{key:o.value,value:Number(o.value)},{default:s(()=>[p(j(o.name),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value"])]),_:1}),a(q,null,{default:s(()=>[a(h,{span:12},{default:s(()=>[a(d,{label:"实验环境",name:"environment",required:"","label-col":{span:4},"wrapper-col":{span:20}},{default:s(()=>[a(y,{value:t.value.environment,"onUpdate:value":e[4]||(e[4]=o=>t.value.environment=o),placeholder:"请选择实验环境",options:S.value,loading:re.value},null,8,["value","options","loading"])]),_:1})]),_:1}),a(h,{span:12},{default:s(()=>[a(d,{label:"小类别",name:"secondType",required:"","label-col":{span:4},"wrapper-col":{span:12}},{default:s(()=>[a(y,{value:t.value.secondType,"onUpdate:value":e[5]||(e[5]=o=>t.value.secondType=o),placeholder:"请选择小类别",options:b($).options.value,loading:b($).loading.value},null,8,["value","options","loading"])]),_:1})]),_:1})]),_:1}),a(d,{label:"学时",name:"classHour",required:""},{default:s(()=>[a(ve,{min:0,class:"w-full",value:t.value.classHour,"onUpdate:value":e[6]||(e[6]=o=>t.value.classHour=o),placeholder:"请输入学时"},null,8,["value"])]),_:1}),a(d,{label:"顶部背景图",name:"topCover",required:""},{default:s(()=>[r("div",Pa,[r("div",ja,[a(ce,{"before-upload":Ye,"show-upload-list":!1,accept:"image/png,image/jpeg"},{default:s(()=>[a(U,{loading:J.value},{default:s(()=>[J.value?(f(),g(x,{key:1},[p("上传中...")],64)):(f(),g(x,{key:0},[p("选择文件")],64))]),_:1},8,["loading"])]),_:1}),oe.value?(f(),g("div",Ea,[r("img",{src:oe.value,alt:"顶部背景图预览",style:{"max-width":"290px","max-height":"218px","border-radius":"4px"}},null,8,$a)])):F("",!0)]),e[31]||(e[31]=r("div",{class:"upload-hint"}," 说明：支持上传png/jpeg等格式文件，文件大小不能超过12M,建议使用290*218像素。 ",-1))])]),_:1}),a(d,{label:"封面图",name:"cover",required:""},{default:s(()=>[r("div",Ha,[r("div",Da,[a(ce,{"before-upload":Ze,"show-upload-list":!1,accept:"image/png,image/jpeg"},{default:s(()=>[a(U,{loading:W.value},{default:s(()=>[W.value?(f(),g(x,{key:1},[p("上传中...")],64)):(f(),g(x,{key:0},[p("选择文件")],64))]),_:1},8,["loading"])]),_:1}),se.value?(f(),g("div",Ba,[r("img",{src:se.value,alt:"封面图预览",style:{"max-width":"290px","max-height":"218px","border-radius":"4px"}},null,8,Ga)])):F("",!0)]),e[32]||(e[32]=r("div",{class:"upload-hint"}," 说明：支持上传png/jpeg等格式文件，文件大小不能超过12M,建议使用290*218像素。 ",-1))])]),_:1}),a(d,{label:"简介",name:"description"},{default:s(()=>[a(Ve,{modelValue:t.value.description,"onUpdate:modelValue":e[7]||(e[7]=o=>t.value.description=o)},null,8,["modelValue"])]),_:1}),a(d,{label:"任务要求",name:"showTaskRequire"},{default:s(()=>[a(qe,{checked:t.value.showTaskRequire,"onUpdate:checked":e[8]||(e[8]=o=>t.value.showTaskRequire=o)},{default:s(()=>e[33]||(e[33]=[p(" 显示任务要求（勾选后，将帮作为任务要求显示在任务项目政策面） ")])),_:1,__:[33]},8,["checked"])]),_:1})]),_:1},8,["model"])]),e[39]||(e[39]=r("div",{class:"section-title"},[r("h3",null,"培训公开范围")],-1)),r("div",Ka,[a(K,{ref_key:"trainingScopeFormRef",ref:_e,model:t.value,rules:ke,layout:"horizontal","label-col":{span:2},"wrapper-col":{span:18}},{default:s(()=>[a(d,{label:"培训公开范围",name:"authType",required:""},{default:s(()=>[a(P,{value:t.value.authType,"onUpdate:value":e[9]||(e[9]=o=>t.value.authType=o),class:"custom-radio"},{default:s(()=>[a(_,{value:1},{default:s(()=>e[34]||(e[34]=[p("完全公开")])),_:1,__:[34]}),a(_,{value:2},{default:s(()=>e[35]||(e[35]=[p("全院公开")])),_:1,__:[35]}),a(_,{value:3},{default:s(()=>e[36]||(e[36]=[p("本单位公开")])),_:1,__:[36]}),a(_,{value:4},{default:s(()=>e[37]||(e[37]=[p("不公开")])),_:1,__:[37]})]),_:1},8,["value"])]),_:1})]),_:1},8,["model"])])])):F("",!0),k.value===1?(f(),g("div",Oa,[r("div",za,[r("div",Ja,[a(y,{value:t.value.repositoryType,"onUpdate:value":e[10]||(e[10]=o=>t.value.repositoryType=o),options:He,class:"repository-type-select"},null,8,["value"]),r("div",Wa,[e[40]||(e[40]=r("span",{class:"url-label"},"仓库地址：",-1)),a(i,{value:t.value.gitUrl,"onUpdate:value":e[11]||(e[11]=o=>t.value.gitUrl=o),placeholder:"请输入仓库地址",class:"url-input",disabled:H.value,onBlur:al},null,8,["value","disabled"])])]),r("div",Qa,[r("div",Xa,[r("div",Ya,[r("div",Za,[e[41]||(e[41]=r("span",{class:"switch-label"},"代码仓库",-1)),a(Sl,{checked:t.value.enableCodeRepository,disabled:t.value.enableCodeRepository,onChange:el},null,8,["checked","disabled"])]),t.value.enableCodeRepository?(f(),A(Fl,{key:0},{overlay:s(()=>[a(Rl,{onClick:ol},{default:s(()=>[a(pe,{key:"newFile"},{default:s(()=>e[42]||(e[42]=[p("新建文件")])),_:1,__:[42]}),a(pe,{key:"newFolder"},{default:s(()=>e[43]||(e[43]=[p("新建文件夹")])),_:1,__:[43]}),a(pe,{key:"upload"},{default:s(()=>e[44]||(e[44]=[p("上传")])),_:1,__:[44]})]),_:1})]),default:s(()=>[a(U,{type:"primary",size:"small"},{default:s(()=>[a(b(Ca)),e[45]||(e[45]=p(" 新建 "))]),_:1,__:[45]})]),_:1})):F("",!0)]),t.value.enableCodeRepository?(f(),A(ta,{key:0,"file-tree-data":b(be),"expanded-keys":b(ue),"onUpdate:expandedKeys":e[12]||(e[12]=o=>Pl(ue)?ue.value=o:null),onSelect:b(Oe),onMenuClick:sl,onExpand:tl},null,8,["file-tree-data","expanded-keys","onSelect"])):F("",!0),t.value.enableCodeRepository?(f(),g("div",et,e[46]||(e[46]=[jl('<div class="tips-title" data-v-327f7d94>提示：</div><div class="tips-content" data-v-327f7d94> 此处存放本实训所需的所有代码等相关文件，你可以通过以下： </div><div class="tips-list" data-v-327f7d94> 1、<a href="#" class="tips-link" data-v-327f7d94>Gitee客户端</a> 上传已有文件来开始使用。 </div><div class="tips-list" data-v-327f7d94> 2、直接在平台上创建文件目录以及相关代码文件。 </div>',4)]))):F("",!0)]),r("div",lt,[t.value.enableCodeRepository?(f(),A(oa,{key:0,"selected-file":b(Be),"highlighted-code":b(Ge),"dynamic-file-contents":b(Ke)},null,8,["selected-file","highlighted-code","dynamic-file-contents"])):(f(),g("div",at," 在左侧代码仓库区域点击目录打开文件 "))])])])])):F("",!0),k.value===2?(f(),g("div",tt,[a(Ll,{activeKey:Me.value,"onUpdate:activeKey":e[23]||(e[23]=o=>Me.value=o),class:"evaluation-tabs"},{default:s(()=>[a(Ae,{key:"settings",tab:"评测设置"},{default:s(()=>[r("div",ot,[r("div",st,[e[59]||(e[59]=r("div",{class:"block-header"},"评测文件",-1)),r("div",nt,[a(K,{layout:"horizontal","label-col":{span:3},"wrapper-col":{span:20}},{default:s(()=>[a(d,{label:"是否启用评测功能",required:""},{default:s(()=>[a(P,{value:v.value.openTestValidate,"onUpdate:value":e[13]||(e[13]=o=>v.value.openTestValidate=o),class:"custom-radio"},{default:s(()=>[a(_,{value:1},{default:s(()=>e[47]||(e[47]=[p("是")])),_:1,__:[47]}),a(_,{value:2},{default:s(()=>e[48]||(e[48]=[p("否")])),_:1,__:[48]})]),_:1},8,["value"])]),_:1}),v.value.openTestValidate===1?(f(),g(x,{key:0},[a(d,{label:"评测文件",required:""},{default:s(()=>[t.value.enableCodeRepository?(f(),g(x,{key:1},[r("div",rt,[a(U,{type:"primary",onClick:e[15]||(e[15]=o=>Y.value=!0)},{default:s(()=>e[51]||(e[51]=[p("点击选择")])),_:1,__:[51]}),r("div",it,[(f(!0),g(x,null,O(I.value,o=>(f(),A(Ml,{key:o.uid,closable:"",onClose:()=>{I.value=I.value.filter(N=>N.uid!==o.uid),v.value.testValidateFiles=I.value.map(N=>N.url).join(",")},style:{margin:"4px"}},{default:s(()=>[p(j(o.name),1)]),_:2},1032,["onClose"]))),128))])]),e[52]||(e[52]=r("div",{class:"upload-hint"}," 说明：从代码仓库中选择文件。（点击评测按钮时调用的文件，用于检验学员任务结果是否正确） ",-1))],64)):(f(),g(x,{key:0},[a(ce,{"file-list":I.value,"onUpdate:fileList":e[14]||(e[14]=o=>I.value=o),"custom-request":ml,onChange:gl,"max-count":10},{default:s(()=>[a(U,{type:"primary"},{default:s(()=>e[49]||(e[49]=[p("点击上传")])),_:1,__:[49]})]),_:1},8,["file-list"]),e[50]||(e[50]=r("div",{class:"upload-hint"}," 说明：支持上传多个文件，每个文件大小不能超过500M。 ",-1))],64))]),_:1}),a(d,{label:"评测执行命令",required:""},{default:s(()=>[a(i,{value:v.value.testValidateSh,"onUpdate:value":e[16]||(e[16]=o=>v.value.testValidateSh=o),placeholder:"请输入评测执行命令，例如：python main.py"},null,8,["value"]),e[53]||(e[53]=r("div",{class:"upload-hint"}," （执行评测文件的命令，如：python main.py、node index.js、java Main 等） ",-1))]),_:1,__:[53]}),a(d,{label:"评测时长限制",required:""},{default:s(()=>[r("div",ut,[a(ve,{value:v.value.timeLimitM,"onUpdate:value":e[17]||(e[17]=o=>v.value.timeLimitM=o),min:1,placeholder:"请输入评测时长（分钟）",style:{width:"580px"}},null,8,["value"]),e[54]||(e[54]=r("span",null,"分钟",-1))])]),_:1}),a(d,{label:"系统评分规则"},{default:s(()=>[a(P,{value:v.value.scoreRule,"onUpdate:value":e[18]||(e[18]=o=>v.value.scoreRule=o),class:"custom-radio"},{default:s(()=>[a(_,{value:1},{default:s(()=>e[55]||(e[55]=[p(" 通过全部测试集（仅当所有测试集都正确时，获得项目学时） ")])),_:1,__:[55]}),a(_,{value:2},{default:s(()=>e[56]||(e[56]=[p(" 通过部分测试集（任意一个测试集正确时，获得项目学时） ")])),_:1,__:[56]})]),_:1},8,["value"])]),_:1}),a(d,{label:"评测设置",required:""},{default:s(()=>[a(P,{value:v.value.evaluationSetting,"onUpdate:value":e[19]||(e[19]=o=>v.value.evaluationSetting=o),class:"custom-radio"},{default:s(()=>[a(_,{value:1},{default:s(()=>e[57]||(e[57]=[p(" 通过所有代码块评测（对学员任务文件的所有非空代码块进行评测） ")])),_:1,__:[57]}),a(_,{value:2},{default:s(()=>e[58]||(e[58]=[p(" 通过指定代码块评测（对学员任务文件的指定非空代码块进行评测） ")])),_:1,__:[58]})]),_:1},8,["value"])]),_:1})],64)):F("",!0)]),_:1})])]),v.value.openTestValidate===1?(f(),g("div",dt,[r("div",vt,[e[61]||(e[61]=r("span",null,"测试集",-1)),r("div",ct,[a(U,{onClick:cl},{default:s(()=>e[60]||(e[60]=[p("新增测试集")])),_:1,__:[60]})])]),r("div",pt,[(f(!0),g(x,null,O(v.value.testSets,(o,N)=>(f(),g("div",{key:o.id,class:"test-set-item"},[a(qe,{checked:o.select===1,onChange:E=>fl(o,E.target.checked),class:"test-set-checkbox"},null,8,["checked","onChange"]),r("span",ft,"测试集"+j(N+1),1),a(i,{value:o.arg,"onUpdate:value":E=>o.arg=E,placeholder:"请输入输入内容",class:"test-set-input"},null,8,["value","onUpdate:value"]),a(i,{value:o.answer,"onUpdate:value":E=>o.answer=E,placeholder:"请输入期望输出",class:"test-set-input"},null,8,["value","onUpdate:value"]),a(b(Fa),{class:"delete-test-set-icon",onClick:E=>pl(o.id)},null,8,["onClick"])]))),128))])])):F("",!0),r("div",mt,[a(U,{type:"primary",onClick:bl},{default:s(()=>[p(j(ee.value?"更新":"保存"),1)]),_:1})])])]),_:1}),a(Ae,{key:"reference",tab:"参考答案"},{default:s(()=>[r("div",gt,[r("div",yt,[e[66]||(e[66]=r("div",{class:"block-header"},"参考答案",-1)),r("div",_t,[a(K,{layout:"horizontal","label-col":{span:3},"wrapper-col":{span:20}},{default:s(()=>[a(d,{label:"是否显示参考答案模块",required:""},{default:s(()=>[a(P,{value:C.value.showAnswer,"onUpdate:value":e[20]||(e[20]=o=>C.value.showAnswer=o),class:"custom-radio"},{default:s(()=>[a(_,{value:1},{default:s(()=>e[62]||(e[62]=[p("是")])),_:1,__:[62]}),a(_,{value:2},{default:s(()=>e[63]||(e[63]=[p("否")])),_:1,__:[63]})]),_:1},8,["value"])]),_:1}),a(d,{label:"是否禁止复制参考答案",required:""},{default:s(()=>[a(P,{value:C.value.prohibitCopyAnswer,"onUpdate:value":e[21]||(e[21]=o=>C.value.prohibitCopyAnswer=o),class:"custom-radio"},{default:s(()=>[a(_,{value:1},{default:s(()=>e[64]||(e[64]=[p("是")])),_:1,__:[64]}),a(_,{value:2},{default:s(()=>e[65]||(e[65]=[p("否")])),_:1,__:[65]})]),_:1},8,["value"])]),_:1}),a(d,{label:"参考答案",required:""},{default:s(()=>[a(Ve,{modelValue:C.value.referenceAnswer,"onUpdate:modelValue":e[22]||(e[22]=o=>C.value.referenceAnswer=o)},null,8,["modelValue"])]),_:1})]),_:1})])]),r("div",kt,[a(U,{type:"primary",onClick:wl},{default:s(()=>[p(j(le.value?"更新":"保存"),1)]),_:1})])])]),_:1})]),_:1},8,["activeKey"])])):F("",!0),k.value===3?(f(),g("div",ht,[r("div",bt,[e[69]||(e[69]=r("h3",{class:"section-main-title"},"实验环境",-1)),r("div",wt,[r("div",Tt,[r("div",Ct,[a(i,{value:ae.value,"onUpdate:value":e[24]||(e[24]=o=>ae.value=o),placeholder:"搜索需要的实验环境","allow-clear":""},{suffix:s(()=>e[67]||(e[67]=[r("span",{class:"search-icon"},"🔍",-1)])),_:1},8,["value"])]),r("div",Ut,[(f(!0),g(x,null,O(Cl.value,o=>(f(),g("div",{key:o.value,class:El(["environment-item",{active:R.value===o.value}]),onClick:N=>xl(o.value)},j(o.label),11,xt))),128))])]),r("div",St,[r("div",Rt," 实验环境: "+j(Ul.value),1),a(K,{model:w.value,layout:"horizontal","label-col":{span:6},"wrapper-col":{span:16}},{default:s(()=>[a(d,{label:"附带环境"},{default:s(()=>[a(y,{value:w.value.secondType,"onUpdate:value":e[25]||(e[25]=o=>w.value.secondType=o),placeholder:"请选择附带环境",options:b($).options.value,loading:b($).loading.value},null,8,["value","options","loading"])]),_:1}),a(d,{label:"实验环境使用时长"},{default:s(()=>[r("div",Ft,[a(ve,{value:w.value.timeLimitM,"onUpdate:value":e[26]||(e[26]=o=>w.value.timeLimitM=o),min:1,placeholder:"请输入实验环境使用时长",style:{flex:"1"}},null,8,["value"]),e[68]||(e[68]=r("span",null,"分",-1))])]),_:1})]),_:1},8,["model"])])])])])):F("",!0),r("div",Mt,[k.value===0?(f(),A(U,{key:0,onClick:Le},{default:s(()=>e[70]||(e[70]=[p("返回")])),_:1,__:[70]})):(f(),A(U,{key:1,onClick:Le},{default:s(()=>e[71]||(e[71]=[p("上一步")])),_:1,__:[71]})),k.value===3?(f(),A(U,{key:2,type:"primary",onClick:Tl},{default:s(()=>e[72]||(e[72]=[p("完成创建")])),_:1,__:[72]})):(f(),A(U,{key:3,type:"primary",onClick:kl},{default:s(()=>e[73]||(e[73]=[p("下一步")])),_:1,__:[73]}))])]),r("input",{ref_key:"fileUploadInput",ref:Ce,type:"file",style:{display:"none"},onChange:il},null,544),a(sa,{open:D.value,"onUpdate:open":e[27]||(e[27]=o=>D.value=o),onConfirm:ll,onCancel:xe},null,8,["open"]),a(na,{open:Q.value,"onUpdate:open":e[28]||(e[28]=o=>Q.value=o),"parent-path":B.value,onConfirm:ul},null,8,["open","parent-path"]),a(ra,{open:X.value,"onUpdate:open":e[29]||(e[29]=o=>X.value=o),"parent-path":G.value,onConfirm:dl},null,8,["open","parent-path"]),a(ia,{open:Y.value,"onUpdate:open":e[30]||(e[30]=o=>Y.value=o),title:"选择评测文件","git-url":t.value.gitUrl,onConfirm:yl},null,8,["open","git-url"])])}}}),Ht=Al(Lt,[["__scopeId","data-v-327f7d94"]]);export{Ht as default};
