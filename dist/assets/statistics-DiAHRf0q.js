import{d as X,a9 as Z,am as ee,f as p,c as D,o as te,_ as c,a1 as k,$ as n,k as t,aa as _,a7 as s,G as u,ad as B,F as T,ac as h,ah as ae,u as K}from"./vue-C8C4cLDH.js";import{n as se}from"./index-H3_z31XN.js";import{H as ne,K as ie,aa as le,ab as ue,U as re,V as oe,w as de,aq as me,T as pe,a7 as ce}from"./antd-BIZT1SGM.js";import{_ as ke}from"./index-DUZqzru9.js";const ve={class:"project-statistics-page"},_e={class:"page-header"},ye={class:"page-content"},fe={class:"filter-section"},be={class:"filter-form"},Ne={class:"filter-actions"},xe={class:"table-section"},Se={class:"table-header"},Te={class:"table-info"},ge={class:"total-info"},we={class:"total-number"},he={key:0,class:"user-link"},Ie={key:2,class:"status-cell"},Ce={class:"filter-section"},Le={class:"filter-form"},Ue={class:"filter-actions"},je={class:"task-completion-container"},Ee={class:"task-level-sidebar"},$e={class:"task-level-search"},Pe={class:"task-level-list"},ze=["onClick"],De={class:"task-table-area"},Be={class:"table-header"},Ke={key:0,class:"user-link"},Ve=X({name:"ProjectStatistics",__name:"statistics",setup(Fe){const V=Z(),I=ee(),F=p(I.query.name||"实训项目管理详情"),C=p("participation"),l=p({userNumber:"",userName:"",unit:void 0,trainingStatus:void 0}),L=[{label:"中国科学院计算机网络信息中心",value:"中国科学院计算机网络信息中心"}],q=[{label:"已完成",value:"已完成"},{label:"进行中",value:"进行中"},{label:"未开始",value:"未开始"}],U=[{id:"1",name:"第1关：编码任务"},{id:"2",name:"第2关：选择题任务"},{id:"3",name:"第3关：内嵌链接任务"},{id:"4",name:"第4关：lab任务"},{id:"5",name:"第5关：notebook任务"}],g=p("1"),b=p(""),M=D(()=>b.value?U.filter(i=>i.name.toLowerCase().includes(b.value.toLowerCase())):U),R=i=>{g.value=i},H=[{title:"用户编号",dataIndex:"userId",key:"userId",width:150},{title:"用户姓名",dataIndex:"nickName",key:"nickName",width:150},{title:"单位",dataIndex:"orgName",key:"orgName",width:300},{title:"参训时间",dataIndex:"joinTime",key:"joinTime",width:200},{title:"参训状态",dataIndex:"currentTask",key:"currentTask",width:150,align:"center"}],O=D(()=>{const i=g.value;return i==="1"?[{title:"用户编号",dataIndex:"userNumber",key:"userNumber",width:150},{title:"用户姓名",dataIndex:"userName",key:"userName",width:150},{title:"单位",dataIndex:"unit",key:"unit",width:300},{title:"任务开始时间",dataIndex:"taskStartTime",key:"taskStartTime",width:200},{title:"实验状态",dataIndex:"experimentStatus",key:"experimentStatus",width:150}]:i==="2"?[{title:"用户编号",dataIndex:"userNumber",key:"userNumber",width:150},{title:"用户姓名",dataIndex:"userName",key:"userName",width:150},{title:"单位",dataIndex:"unit",key:"unit",width:250},{title:"任务开始时间",dataIndex:"taskStartTime",key:"taskStartTime",width:180},{title:"任务结束时间",dataIndex:"taskEndTime",key:"taskEndTime",width:180},{title:"累计时间",dataIndex:"totalTime",key:"totalTime",width:120},{title:"实验状态",dataIndex:"experimentStatus",key:"experimentStatus",width:120}]:i==="3"?[{title:"用户编号",dataIndex:"userNumber",key:"userNumber",width:150},{title:"用户姓名",dataIndex:"userName",key:"userName",width:150},{title:"单位",dataIndex:"unit",key:"unit",width:300},{title:"任务开始时间",dataIndex:"taskStartTime",key:"taskStartTime",width:200},{title:"实验状态",dataIndex:"experimentStatus",key:"experimentStatus",width:150}]:i==="4"?[{title:"用户编号",dataIndex:"userNumber",key:"userNumber",width:150},{title:"用户姓名",dataIndex:"userName",key:"userName",width:150},{title:"单位",dataIndex:"unit",key:"unit",width:300},{title:"任务开始时间",dataIndex:"taskStartTime",key:"taskStartTime",width:200},{title:"实验状态",dataIndex:"experimentStatus",key:"experimentStatus",width:150}]:i==="5"?[{title:"用户编号",dataIndex:"userNumber",key:"userNumber",width:150},{title:"用户姓名",dataIndex:"userName",key:"userName",width:150},{title:"单位",dataIndex:"unit",key:"unit",width:300},{title:"任务开始时间",dataIndex:"taskStartTime",key:"taskStartTime",width:200},{title:"实验状态",dataIndex:"experimentStatus",key:"experimentStatus",width:150}]:[{title:"用户编号",dataIndex:"userNumber",key:"userNumber",width:150},{title:"用户姓名",dataIndex:"userName",key:"userName",width:150},{title:"单位",dataIndex:"unit",key:"unit",width:300},{title:"任务开始时间",dataIndex:"taskStartTime",key:"taskStartTime",width:200},{title:"实验状态",dataIndex:"experimentStatus",key:"experimentStatus",width:150}]}),j=p([]),A=p([{key:"1",userNumber:"ceshi123456",userName:"李清照",unit:"中国科学院计算机网络信息中心",taskStartTime:"2025-07-21  12:12:12",taskEndTime:"2025-07-21  12:12:12",totalTime:"12:12:12",experimentStatus:"已完成",statusType:"completed"},{key:"2",userNumber:"ceshi123456",userName:"李清照",unit:"中国科学院计算机网络信息中心",taskStartTime:"2025-07-21  12:12:12",taskEndTime:"2025-07-21  12:12:12",totalTime:"12:12:12",experimentStatus:"已完成",statusType:"completed"},{key:"3",userNumber:"ceshi123456",userName:"李清照",unit:"中国科学院计算机网络信息中心",taskStartTime:"2025-07-21  12:12:12",taskEndTime:"2025-07-21  12:12:12",totalTime:"12:12:12",experimentStatus:"进行中",statusType:"inProgress"},{key:"4",userNumber:"ceshi123456",userName:"李清照",unit:"中国科学院计算机网络信息中心",taskStartTime:"2025-07-21  12:12:12",taskEndTime:"2025-07-21  12:12:12",totalTime:"12:12:12",experimentStatus:"进行中",statusType:"inProgress"},{key:"5",userNumber:"ceshi123456",userName:"李清照",unit:"中国科学院计算机网络信息中心",taskStartTime:"2025-07-21  12:12:12",taskEndTime:"2025-07-21  12:12:12",totalTime:"12:12:12",experimentStatus:"进行中",statusType:"inProgress"},{key:"6",userNumber:"ceshi123456",userName:"李清照",unit:"中国科学院计算机网络信息中心",taskStartTime:"2025-07-21  12:12:12",taskEndTime:"2025-07-21  12:12:12",totalTime:"12:12:12",experimentStatus:"进行中",statusType:"inProgress"}]),m=p({current:1,pageSize:20,total:0,showSizeChanger:!0,showQuickJumper:!0,showTotal:i=>`数据共 ${i} 条`}),w=p(!1),G=p(Number(I.query.id)||0),J=i=>{if(!i)return"-";const e=i<1e10?i*1e3:i,r=new Date(e),y=r.getFullYear(),v=String(r.getMonth()+1).padStart(2,"0"),d=String(r.getDate()).padStart(2,"0"),f=String(r.getHours()).padStart(2,"0"),x=String(r.getMinutes()).padStart(2,"0"),S=String(r.getSeconds()).padStart(2,"0");return`${y}-${v}-${d} ${f}:${x}:${S}`},N=async()=>{w.value=!0;try{const i={limit:m.value.pageSize,page:m.value.current,projectId:G.value};l.value.userNumber&&(i.userId=l.value.userNumber),l.value.userName&&(i.nickName=l.value.userName),l.value.unit&&(i.orgName=l.value.unit),l.value.trainingStatus;const e=await se(i);e&&e.list&&(j.value=e.list,m.value.total=e.total)}catch(i){console.error("获取参训数据失败:",i),ce.error("获取参训数据失败")}finally{w.value=!1}},E=()=>{console.log("查询",l.value),m.value.current=1,N()},$=()=>{l.value={userNumber:"",userName:"",unit:void 0,trainingStatus:void 0},m.value.current=1,N()},P=()=>{console.log("导出数据")},Q=()=>{V.back()},Y=i=>{m.value.current=i.current,m.value.pageSize=i.pageSize,N()};return te(()=>{N()}),(i,e)=>{const r=ne,y=oe,v=re,d=ue,f=de,x=le,S=me,z=ie,W=pe;return k(),c("div",ve,[n("div",_e,[n("h2",null,_(F.value),1),t(r,{onClick:Q},{default:s(()=>e[9]||(e[9]=[u("返回")])),_:1,__:[9]})]),n("div",ye,[t(W,{activeKey:C.value,"onUpdate:activeKey":e[8]||(e[8]=a=>C.value=a),class:"statistics-tabs"},{default:s(()=>[t(z,{key:"participation",tab:"参训整体情况"},{default:s(()=>[n("div",fe,[e[12]||(e[12]=n("div",{class:"filter-title"},"筛选查询",-1)),n("div",be,[t(x,{gutter:16,align:"middle"},{default:s(()=>[t(d,{span:5},{default:s(()=>[t(v,{label:"用户编号：","label-col":{span:9},"wrapper-col":{span:15}},{default:s(()=>[t(y,{value:l.value.userNumber,"onUpdate:value":e[0]||(e[0]=a=>l.value.userNumber=a),placeholder:"请输入"},null,8,["value"])]),_:1})]),_:1}),t(d,{span:5},{default:s(()=>[t(v,{label:"用户姓名：","label-col":{span:9},"wrapper-col":{span:15}},{default:s(()=>[t(y,{value:l.value.userName,"onUpdate:value":e[1]||(e[1]=a=>l.value.userName=a),placeholder:"请输入"},null,8,["value"])]),_:1})]),_:1}),t(d,{span:5},{default:s(()=>[t(v,{label:"单位：","label-col":{span:6},"wrapper-col":{span:18}},{default:s(()=>[t(f,{value:l.value.unit,"onUpdate:value":e[2]||(e[2]=a=>l.value.unit=a),placeholder:"请选择",options:L,"allow-clear":""},null,8,["value"])]),_:1})]),_:1}),t(d,{span:5},{default:s(()=>[t(v,{label:"参训状态：","label-col":{span:9},"wrapper-col":{span:15}},{default:s(()=>[t(f,{value:l.value.trainingStatus,"onUpdate:value":e[3]||(e[3]=a=>l.value.trainingStatus=a),placeholder:"请选择",options:q,"allow-clear":""},null,8,["value"])]),_:1})]),_:1}),t(d,{span:4},{default:s(()=>[n("div",Ne,[t(r,{type:"primary",onClick:E},{default:s(()=>e[10]||(e[10]=[u("查询")])),_:1,__:[10]}),t(r,{onClick:$},{default:s(()=>e[11]||(e[11]=[u("重置")])),_:1,__:[11]})])]),_:1})]),_:1})])]),n("div",xe,[n("div",Se,[n("div",Te,[e[15]||(e[15]=u(" 数据列表 ")),n("span",ge,[e[13]||(e[13]=u("数据共 ")),n("span",we,_(m.value.total),1),e[14]||(e[14]=u(" 条"))])]),t(r,{type:"primary",onClick:P},{default:s(()=>e[16]||(e[16]=[u("导出")])),_:1,__:[16]})]),t(S,{columns:H,"data-source":j.value,pagination:m.value,loading:w.value,"row-key":a=>a.id,scroll:{x:1e3},onChange:Y},{bodyCell:s(({column:a,record:o})=>[a.key==="nickName"?(k(),c("a",he,_(o.nickName),1)):a.key==="joinTime"?(k(),c(T,{key:1},[u(_(J(o.joinTime)),1)],64)):a.key==="currentTask"?(k(),c("div",Ie,[n("span",null,_(o.currentTask)+" / "+_(o.currentTask),1),n("span",{class:h(["status-icon",o.currentTask>=o.currentTask?"completed":"inProgress"])},[o.currentTask>=o.currentTask?(k(),c(T,{key:0},[u("✓")],64)):(k(),c(T,{key:1},[u("⟳")],64))],2)])):B("",!0)]),_:1},8,["data-source","pagination","loading","row-key"])])]),_:1}),t(z,{key:"task",tab:"任务完成情况"},{default:s(()=>[n("div",Ce,[e[19]||(e[19]=n("div",{class:"filter-title"},"筛选查询",-1)),n("div",Le,[t(x,{gutter:16,align:"middle"},{default:s(()=>[t(d,{span:6},{default:s(()=>[t(v,{label:"用户编号：","label-col":{span:8},"wrapper-col":{span:16}},{default:s(()=>[t(y,{value:l.value.userNumber,"onUpdate:value":e[4]||(e[4]=a=>l.value.userNumber=a),placeholder:"请输入"},null,8,["value"])]),_:1})]),_:1}),t(d,{span:6},{default:s(()=>[t(v,{label:"用户姓名：","label-col":{span:8},"wrapper-col":{span:16}},{default:s(()=>[t(y,{value:l.value.userName,"onUpdate:value":e[5]||(e[5]=a=>l.value.userName=a),placeholder:"请输入"},null,8,["value"])]),_:1})]),_:1}),t(d,{span:6},{default:s(()=>[t(v,{label:"单位：","label-col":{span:6},"wrapper-col":{span:18}},{default:s(()=>[t(f,{value:l.value.unit,"onUpdate:value":e[6]||(e[6]=a=>l.value.unit=a),placeholder:"请选择",options:L,"allow-clear":""},null,8,["value"])]),_:1})]),_:1}),t(d,{span:6},{default:s(()=>[n("div",Ue,[t(r,{type:"primary",onClick:E},{default:s(()=>e[17]||(e[17]=[u("查询")])),_:1,__:[17]}),t(r,{onClick:$},{default:s(()=>e[18]||(e[18]=[u("重置")])),_:1,__:[18]})])]),_:1})]),_:1})])]),n("div",je,[n("div",Ee,[n("div",$e,[t(y,{value:b.value,"onUpdate:value":e[7]||(e[7]=a=>b.value=a),placeholder:"请输入内容","allow-clear":""},{suffix:s(()=>e[20]||(e[20]=[n("span",{class:"search-icon"},"🔍",-1)])),_:1},8,["value"])]),n("div",Pe,[(k(!0),c(T,null,ae(K(M),a=>(k(),c("div",{key:a.id,class:h(["task-level-item",{active:g.value===a.id}]),onClick:o=>R(a.id)},_(a.name),11,ze))),128))])]),n("div",De,[n("div",Be,[e[22]||(e[22]=n("div",{class:"table-info"},[u(" 数据列表 "),n("span",{class:"total-info"},[u("数据共 "),n("span",{class:"total-number"},"123"),u(" 条")])],-1)),t(r,{type:"primary",onClick:P},{default:s(()=>e[21]||(e[21]=[u("导出")])),_:1,__:[21]})]),t(S,{columns:K(O),"data-source":A.value,pagination:m.value,scroll:{x:1200}},{bodyCell:s(({column:a,record:o})=>[a.key==="userName"?(k(),c("a",Ke,_(o.userName),1)):a.key==="experimentStatus"?(k(),c("span",{key:1,class:h(["status-tag",o.statusType])},_(o.experimentStatus),3)):B("",!0)]),_:1},8,["columns","data-source","pagination"])])])]),_:1})]),_:1},8,["activeKey"])])])}}}),Oe=ke(Ve,[["__scopeId","data-v-69d247dc"]]);export{Oe as default};
