import{Z as M,f as _,s as N,d as R,am as k,l as y,ao as T,k as S,S as A,a5 as b,a6 as d,a1 as P,a7 as x,m as V,u as v,ap as E,af as L}from"./vue-PnzzEkKE.js";import{b as I,f as B,e as w,i as K}from"./index-DmgcJQeo.js";const O=["/login","/404","/403"],W=M("multi-tab",()=>{const n=_([]),i=N(),l=_(null),o=I(),a=_([]),f=B(),r=e=>{if(!e||e.path.startsWith("/redirect")||e.path.startsWith("/common")||e.path==="/"||O.includes(e.path))return;if(l.value&&setTimeout(()=>{l.value&&(l.value.loading=!1,l.value=null)},500),n.value.some(m=>m.fullPath===e.fullPath)){!a.value.includes(e==null?void 0:e.name)&&o.layoutSetting.keepAlive&&e.meta.keepAlive&&e.name&&a.value.push(e.name);return}const t={path:e.path,fullPath:e.fullPath,title:e.meta.title,name:e.name,icon:e.meta.icon,affix:e.meta.affix,locale:e.meta.locale};!a.value.includes(t==null?void 0:t.name)&&o.layoutSetting.keepAlive&&e.meta.keepAlive&&e.name&&a.value.push(e.name),n.value.push(t)},c=e=>{if(n.value.length<=1){f.error("不能关闭最后一个标签页");return}const t=n.value.findIndex(s=>s.fullPath===e);if(t<0){f.error("当前页签不存在无法关闭");return}const m=n.value[t];if(m.fullPath===i.value){const s=t===0?n.value[t+1]:n.value[t-1];i.value=s.fullPath,w.push(s.fullPath)}o.layoutSetting.keepAlive&&m.name&&(a.value=a.value.filter(s=>s!==m.name)),n.value=n.value.filter(s=>s.fullPath!==e)},h=e=>{const t=n.value.find(m=>m.fullPath===e);t&&(a.value=a.value.filter(m=>m!==t.name),t.loading=!0,l.value=t,w.replace(`/redirect/${encodeURIComponent(t.fullPath)}`))},u=e=>{e!==i.value&&w.push(e)};return{list:n,activeKey:i,cacheList:a,close:c,clear:()=>{n.value=[],a.value=[],i.value=void 0,l.value=null},closeLeft:e=>{u(e);const t=n.value.findIndex(s=>s.fullPath===e);n.value.slice(0,t).forEach(s=>{s.affix||c(s.fullPath)})},closeRight:e=>{u(e);const t=n.value.findIndex(s=>s.fullPath===e);n.value.slice(t+1).forEach(s=>{s.affix||c(s.fullPath)})},closeOther:e=>{u(e),n.value.forEach(t=>{t.affix||t.fullPath!==e&&c(t.fullPath)})},refresh:h,switchTab:u,addItem:r}}),D=R({name:"ParentCompConsumer",setup(n,{slots:i}){const l=k(),o=new Map;return()=>{var r,c,h;const a=(r=l.meta)==null?void 0:r.parentName,f=(c=l.meta)==null?void 0:c.parentComps;if(a){if(o.has(a))return o.get(a);if(f!=null&&f.length){let u;for(const p of[...f].reverse()){const C=K(p)?T(p):p;u?u=y(C,null,{default:()=>u}):u=y(C,null,i)}if(u)return o.set(a,u),u}}return(h=i==null?void 0:i.default)==null?void 0:h.call(i)}}}),g=new Map;function F(){const n=k();return{getComp:l=>{var c;if(!n.name)return l;const o=(c=l==null?void 0:l.type)==null?void 0:c.name,a=n.name;if(g.has(a))return g.get(a);const f=l;if(o&&o===a)return g.set(a,f),f;const r=S(f);return r.type||(r.type={}),r.type.name=a,g.set(a,r),r}}}const q=R({name:"CustomRouteView",__name:"route-view",setup(n){const i=I(),{layoutSetting:l}=A(i),o=W(),{cacheList:a}=A(o),{getComp:f}=F();return(r,c)=>{const h=b("RouterView");return P(),d(v(D),null,{default:x(()=>[S(h,null,{default:x(({Component:u,route:p})=>[S(V,{appear:"",name:v(l).animationName,mode:"out-in"},{default:x(()=>[v(l).keepAlive?(P(),d(E,{key:0,include:[...v(a)]},[(P(),d(L(v(f)(u)),{key:p.fullPath}))],1032,["include"])):(P(),d(L(u),{key:p.fullPath}))]),_:2},1032,["name"])]),_:1})]),_:1})}}});export{q as _,W as u};
