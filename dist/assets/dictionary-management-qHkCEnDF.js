import{d as $e,f as c,r as W,w as Me,o as Ee,_ as C,a1 as f,$ as u,k as t,u as b,a7 as s,a6 as O,ad as X,F as ue,ah as Le,G as _,aa as I,l as Y,ac as Fe,B as re}from"./vue-C8C4cLDH.js";import{t as V,v as ve,w as ye,_ as qe}from"./index-CHvkwZeu.js";import{ar as ze,ae as de,H as Ae,as as Be,V as Pe,al as Ve,ag as Qe,U as Ke,w as Re,x as je,S as Ge,a0 as He,aj as ce,at as Je,au as We,am as Xe,aq as Ye,ab as Ze,ac as et,af as tt,an as at,M as P,ak as r,ap as Z,ai as lt,u as st}from"./antd-C7Px7a_9.js";async function ot(v){return V("/dictionary/type/list",v)}async function nt(v){return V("/dictionary/type/create",v)}async function it(v,h){return ye(`/dictionary/type/${v}`,h)}async function ut(v){return ve(`/dictionary/type/${v}`)}async function rt(v){return V("/dictionary/item/list",v)}async function dt(v){return V("/dictionary/item/create",v)}async function ct(v,h){return ye(`/dictionary/item/${v}`,h)}async function pe(v){return ve(`/dictionary/item/${v}`)}const pt={class:"dictionary-management"},vt={class:"content-wrapper"},yt={class:"left-panel"},_t={class:"panel-header"},mt={class:"header-title"},ft={class:"title-icon"},gt={class:"search-box"},bt={key:0,class:"loading-container"},kt={key:1,class:"type-list"},wt=["onClick"],Ct={class:"type-info"},ht={class:"type-name"},It={class:"type-code"},xt={class:"type-actions"},Tt={class:"right-panel"},Dt={key:0,class:"empty-state"},Nt={class:"panel-header-info"},Ut={class:"type-code-tag"},St={key:0},Ot={class:"query-section"},$t={class:"query-form"},Mt={class:"table-section"},Et={class:"table-header"},Lt={class:"table-info"},Ft={class:"info-value"},qt={class:"table-actions"},zt={class:"table-container"},At=$e({name:"DictionaryManagement",__name:"dictionary-management",setup(v){const h=c(!1),x=c([]),d=c(null),$=c(""),Q=c(!1),M=c([]),T=c(0),n=W({typeId:void 0,label:"",value:"",status:void 0,page:1,limit:10,orderbyFiled:"sort:asc"}),D=c(!1),K=c(!1),R=c("新建字典类型"),N=c(!1),E=c(void 0),i=W({typeName:"",typeCode:"",description:"",status:1,sort:0}),U=c(!1),j=c(!1),G=c("新建字典项"),L=c(!1),F=c(void 0),o=W({typeId:void 0,label:"",value:"",description:"",status:1,sort:0}),g=c([]),S=c([]),_e=[{title:"字典标签",dataIndex:"label",key:"label"},{title:"字典值",dataIndex:"value",key:"value"},{title:"状态",dataIndex:"status",key:"status",width:100},{title:"排序",dataIndex:"sort",key:"sort",width:80},{title:"描述",dataIndex:"description",key:"description",ellipsis:!0},{title:"操作",key:"action",width:150,fixed:"right"}],q=async()=>{h.value=!0;try{const a={page:1,limit:1e3,orderbyFiled:"sort:asc"};$.value.trim()&&(a.typeName=$.value.trim());const e=await ot(a);if(e.data)if(x.value=e.data.list||[],d.value){const p=x.value.find(m=>{var z;return m.id===((z=d.value)==null?void 0:z.id)});p&&(d.value=p)}else x.value.length>0&&(d.value=x.value[0])}catch{r.error("获取字典类型列表失败")}finally{h.value=!1}},k=async()=>{var a,e;if(!d.value){M.value=[],T.value=0;return}Q.value=!0;try{const p={typeId:d.value.id,page:n.page,limit:n.limit,orderbyFiled:n.orderbyFiled};(a=n.label)!=null&&a.trim()&&(p.label=n.label),(e=n.value)!=null&&e.trim()&&(p.value=n.value),n.status!==void 0&&(p.status=n.status);const m=await rt(p);m.data&&(M.value=m.data.list||[],T.value=m.data.count||0)}catch{r.error("获取字典项列表失败")}finally{Q.value=!1}},me=a=>{d.value=a,n.page=1,n.label="",n.value="",n.status=void 0,g.value=[],S.value=[],k()};Me(()=>d.value,()=>{d.value&&k()});const fe=()=>{R.value="新建字典类型",N.value=!1,E.value=void 0,i.typeName="",i.typeCode="",i.description="",i.status=1,i.sort=0,D.value=!0},ge=a=>{R.value="编辑字典类型",N.value=!0,E.value=a.id,i.typeName=a.typeName,i.typeCode=a.typeCode,i.description=a.description||"",i.status=a.status,i.sort=a.sort,D.value=!0},be=async()=>{if(!i.typeName.trim()){r.error("请输入字典类型名称");return}if(!i.typeCode.trim()){r.error("请输入字典类型编码");return}K.value=!0;try{const a={typeName:i.typeName,typeCode:i.typeCode,description:i.description,status:i.status,sort:i.sort};N.value&&E.value?(await it(E.value,a),r.success("更新成功")):(await nt(a),r.success("创建成功")),D.value=!1,q()}catch{r.error(N.value?"更新失败":"创建失败")}finally{K.value=!1}},ke=a=>{P.confirm({title:"确认删除",icon:Y(Z),content:`确定要删除字典类型"${a.typeName}"吗？删除后该类型下的所有字典项也将被删除。`,okText:"确定",okType:"danger",cancelText:"取消",onOk:async()=>{var e;try{await ut(a.id),r.success("删除成功"),((e=d.value)==null?void 0:e.id)===a.id&&(d.value=null,M.value=[],T.value=0),q()}catch{r.error("删除失败")}}})},we=()=>{if(!d.value){r.warning("请先选择字典类型");return}G.value="新建字典项",L.value=!1,F.value=void 0,o.typeId=d.value.id,o.label="",o.value="",o.description="",o.status=1,o.sort=0,U.value=!0},Ce=a=>{G.value="编辑字典项",L.value=!0,F.value=a.id,o.typeId=a.typeId,o.label=a.label,o.value=a.value,o.description=a.description||"",o.status=a.status,o.sort=a.sort,U.value=!0},he=async()=>{if(!o.label.trim()){r.error("请输入字典标签");return}if(!o.value.trim()){r.error("请输入字典值");return}j.value=!0;try{const a={typeId:o.typeId,label:o.label,value:o.value,description:o.description,status:o.status,sort:o.sort};L.value&&F.value?(await ct(F.value,a),r.success("更新成功")):(await dt(a),r.success("创建成功")),U.value=!1,k()}catch{r.error(L.value?"更新失败":"创建失败")}finally{j.value=!1}},Ie=a=>{P.confirm({title:"确认删除",icon:Y(Z),content:`确定要删除字典项"${a.label}"吗？`,okText:"确定",okType:"danger",cancelText:"取消",onOk:async()=>{try{await pe(a.id),r.success("删除成功"),k()}catch{r.error("删除失败")}}})},xe=()=>{if(g.value.length===0){r.warning("请选择要删除的字典项");return}P.confirm({title:"确认批量删除",icon:Y(Z),content:`确定要删除选中的 ${g.value.length} 个字典项吗？`,okText:"确定",okType:"danger",cancelText:"取消",onOk:async()=>{try{await Promise.all(g.value.map(a=>pe(a))),r.success("批量删除成功"),g.value=[],S.value=[],k()}catch{r.error("批量删除失败")}}})},H=()=>{n.page=1,g.value=[],S.value=[],k()},Te=()=>{n.label="",n.value="",n.status=void 0,n.page=1,g.value=[],S.value=[],k()},De=(a,e)=>{g.value=a,S.value=e},Ne=a=>{n.page=a.current,n.limit=a.pageSize,k()};return Ee(()=>{q()}),(a,e)=>{const p=Ae,m=Pe,z=Ve,ee=st,te=Qe,y=Ke,ae=je,Ue=Re,le=Ge,J=He,Se=Je,Oe=Ye,A=et,se=Ze,oe=tt,ne=at,ie=P;return f(),C("div",pt,[u("div",vt,[u("div",yt,[u("div",_t,[u("div",mt,[u("div",ft,[t(b(ze))]),e[16]||(e[16]=u("span",{class:"title-text"},"字典类型",-1))]),t(p,{type:"primary",size:"small",onClick:fe},{icon:s(()=>[t(b(de))]),_:1})]),u("div",gt,[t(m,{value:$.value,"onUpdate:value":e[0]||(e[0]=l=>$.value=l),placeholder:"搜索字典类型...","allow-clear":"",class:"modern-search",onPressEnter:q},{prefix:s(()=>[t(b(Be))]),_:1},8,["value"])]),h.value?(f(),C("div",bt,[t(z,{size:"large",tip:"加载中..."})])):(f(),C("div",kt,[(f(!0),C(ue,null,Le(x.value,l=>{var w;return f(),C("div",{key:l.id,class:Fe(["type-item",{active:((w=d.value)==null?void 0:w.id)===l.id}]),onClick:B=>me(l)},[u("div",Ct,[u("div",ht,I(l.typeName),1),u("div",It,I(l.typeCode),1)]),u("div",xt,[t(ee,{title:"编辑"},{default:s(()=>[t(b(lt),{class:"action-icon",onClick:re(B=>ge(l),["stop"])},null,8,["onClick"])]),_:2},1024),t(ee,{title:"删除"},{default:s(()=>[t(b(ce),{class:"action-icon danger",onClick:re(B=>ke(l),["stop"])},null,8,["onClick"])]),_:2},1024)])],10,wt)}),128)),x.value.length===0?(f(),O(te,{key:0,description:"暂无数据",style:{"margin-top":"60px"}})):X("",!0)]))]),u("div",Tt,[d.value?(f(),C(ue,{key:1},[u("div",Nt,[u("h3",null,[_(I(d.value.typeName)+" ",1),u("span",Ut,I(d.value.typeCode),1)]),d.value.description?(f(),C("p",St,I(d.value.description),1)):X("",!0)]),u("div",Ot,[e[21]||(e[21]=u("div",{class:"query-header"},[u("h4",null,"筛选查询")],-1)),u("div",$t,[t(J,{layout:"inline"},{default:s(()=>[t(y,{label:"字典标签"},{default:s(()=>[t(m,{value:n.label,"onUpdate:value":e[1]||(e[1]=l=>n.label=l),placeholder:"请输入","allow-clear":"",style:{width:"180px"},onPressEnter:H},null,8,["value"])]),_:1}),t(y,{label:"字典值"},{default:s(()=>[t(m,{value:n.value,"onUpdate:value":e[2]||(e[2]=l=>n.value=l),placeholder:"请输入","allow-clear":"",style:{width:"180px"},onPressEnter:H},null,8,["value"])]),_:1}),t(y,{label:"状态"},{default:s(()=>[t(Ue,{value:n.status,"onUpdate:value":e[3]||(e[3]=l=>n.status=l),placeholder:"请选择","allow-clear":"",style:{width:"120px"}},{default:s(()=>[t(ae,{value:1},{default:s(()=>e[17]||(e[17]=[_("启用")])),_:1,__:[17]}),t(ae,{value:0},{default:s(()=>e[18]||(e[18]=[_("禁用")])),_:1,__:[18]})]),_:1},8,["value"])]),_:1}),t(y,null,{default:s(()=>[t(le,null,{default:s(()=>[t(p,{type:"primary",onClick:H},{default:s(()=>e[19]||(e[19]=[_(" 查询 ")])),_:1,__:[19]}),t(p,{onClick:Te},{default:s(()=>e[20]||(e[20]=[_(" 重置 ")])),_:1,__:[20]})]),_:1})]),_:1})]),_:1})])]),u("div",Mt,[u("div",Et,[u("div",Lt,[e[22]||(e[22]=u("span",{class:"info-label"},"数据列表",-1)),e[23]||(e[23]=u("span",{class:"info-divider"},"数据共",-1)),u("span",Ft,I(T.value),1),e[24]||(e[24]=u("span",{class:"info-unit"},"条",-1))]),u("div",qt,[t(p,{type:"primary",onClick:we},{icon:s(()=>[t(b(de))]),default:s(()=>[e[25]||(e[25]=_(" 新建字典项 "))]),_:1,__:[25]}),t(p,{danger:"",disabled:g.value.length===0,onClick:xe},{icon:s(()=>[t(b(ce))]),default:s(()=>[e[26]||(e[26]=_(" 批量删除 "))]),_:1,__:[26]},8,["disabled"])])]),u("div",zt,[t(Oe,{columns:_e,"data-source":M.value,loading:Q.value,pagination:{current:n.page,pageSize:n.limit,total:T.value,showSizeChanger:!0,showQuickJumper:!0,showTotal:l=>`共 ${l} 条`},"row-selection":{selectedRowKeys:g.value,onChange:De},scroll:{x:900},"row-key":l=>l.id,onChange:Ne},{bodyCell:s(({column:l,record:w})=>[l.key==="status"?(f(),O(Se,{key:0,color:w.status===1?"success":"error"},{icon:s(()=>[w.status===1?(f(),O(b(We),{key:0})):(f(),O(b(Xe),{key:1}))]),default:s(()=>[_(" "+I(w.status===1?"启用":"禁用"),1)]),_:2},1032,["color"])):l.key==="action"?(f(),O(le,{key:1},{default:s(()=>[t(p,{type:"link",size:"small",onClick:B=>Ce(w)},{default:s(()=>e[27]||(e[27]=[_(" 编辑 ")])),_:2,__:[27]},1032,["onClick"]),t(p,{type:"link",size:"small",danger:"",onClick:B=>Ie(w)},{default:s(()=>e[28]||(e[28]=[_(" 删除 ")])),_:2,__:[28]},1032,["onClick"])]),_:2},1024)):X("",!0)]),_:1},8,["data-source","loading","pagination","row-selection","row-key"])])])],64)):(f(),C("div",Dt,[t(te,{description:"请在左侧选择字典类型"})]))])]),t(ie,{open:D.value,"onUpdate:open":e[9]||(e[9]=l=>D.value=l),title:R.value,width:600,"confirm-loading":K.value,onOk:be},{default:s(()=>[t(J,{model:i,"label-col":{span:6},"wrapper-col":{span:16},style:{"margin-top":"24px"}},{default:s(()=>[t(y,{label:"字典类型名称",required:""},{default:s(()=>[t(m,{value:i.typeName,"onUpdate:value":e[4]||(e[4]=l=>i.typeName=l),placeholder:"请输入字典类型名称","allow-clear":""},null,8,["value"])]),_:1}),t(y,{label:"字典类型编码",required:""},{default:s(()=>[t(m,{value:i.typeCode,"onUpdate:value":e[5]||(e[5]=l=>i.typeCode=l),placeholder:"请输入字典类型编码","allow-clear":"",disabled:N.value},null,8,["value","disabled"])]),_:1}),t(y,{label:"状态"},{default:s(()=>[t(se,{value:i.status,"onUpdate:value":e[6]||(e[6]=l=>i.status=l)},{default:s(()=>[t(A,{value:1},{default:s(()=>e[29]||(e[29]=[_("启用")])),_:1,__:[29]}),t(A,{value:0},{default:s(()=>e[30]||(e[30]=[_("禁用")])),_:1,__:[30]})]),_:1},8,["value"])]),_:1}),t(y,{label:"排序"},{default:s(()=>[t(oe,{value:i.sort,"onUpdate:value":e[7]||(e[7]=l=>i.sort=l),min:0,style:{width:"100%"}},null,8,["value"])]),_:1}),t(y,{label:"描述"},{default:s(()=>[t(ne,{value:i.description,"onUpdate:value":e[8]||(e[8]=l=>i.description=l),placeholder:"请输入描述",rows:3,"allow-clear":""},null,8,["value"])]),_:1})]),_:1},8,["model"])]),_:1},8,["open","title","confirm-loading"]),t(ie,{open:U.value,"onUpdate:open":e[15]||(e[15]=l=>U.value=l),title:G.value,width:600,"confirm-loading":j.value,onOk:he},{default:s(()=>[t(J,{model:o,"label-col":{span:6},"wrapper-col":{span:16},style:{"margin-top":"24px"}},{default:s(()=>[t(y,{label:"字典标签",required:""},{default:s(()=>[t(m,{value:o.label,"onUpdate:value":e[10]||(e[10]=l=>o.label=l),placeholder:"请输入字典标签","allow-clear":""},null,8,["value"])]),_:1}),t(y,{label:"字典值",required:""},{default:s(()=>[t(m,{value:o.value,"onUpdate:value":e[11]||(e[11]=l=>o.value=l),placeholder:"请输入字典值","allow-clear":""},null,8,["value"])]),_:1}),t(y,{label:"状态"},{default:s(()=>[t(se,{value:o.status,"onUpdate:value":e[12]||(e[12]=l=>o.status=l)},{default:s(()=>[t(A,{value:1},{default:s(()=>e[31]||(e[31]=[_("启用")])),_:1,__:[31]}),t(A,{value:0},{default:s(()=>e[32]||(e[32]=[_("禁用")])),_:1,__:[32]})]),_:1},8,["value"])]),_:1}),t(y,{label:"排序"},{default:s(()=>[t(oe,{value:o.sort,"onUpdate:value":e[13]||(e[13]=l=>o.sort=l),min:0,style:{width:"100%"}},null,8,["value"])]),_:1}),t(y,{label:"描述"},{default:s(()=>[t(ne,{value:o.description,"onUpdate:value":e[14]||(e[14]=l=>o.description=l),placeholder:"请输入描述",rows:3,"allow-clear":""},null,8,["value"])]),_:1})]),_:1},8,["model"])]),_:1},8,["open","title","confirm-loading"])])}}}),Qt=qe(At,[["__scopeId","data-v-9e660059"]]);export{Qt as default};
