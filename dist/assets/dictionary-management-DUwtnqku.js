import{d as Oe,f as c,c as Ue,r as J,w as Ae,o as Me,_ as I,a1 as _,$ as s,k as t,u as w,a7 as l,a6 as A,ac as Y,F as ie,ag as Ee,G as y,a9 as T,l as W,ab as Fe,B as ue}from"./vue-PnzzEkKE.js";import{n as b,_ as $e}from"./index-D3w9uP0F.js";import{ao as ze,aa as re,H as qe,ap as Be,I as Ve,ai as Pe,ac as Ke,z as Ne,a5 as Qe,ag as Re,S as je,K as He,ae as de,af as Je,aq as Ye,aj as We,an as Xe,ab as Ze,ak as et,M as B,a6 as tt,a7 as at,a0 as r,am as X,Y as nt,ah as lt}from"./antd-C-FgyWyA.js";async function ot(v){return b("/admin/api/dicGroup/getList",v||{},{customDev:!0})}async function st(v){return b("/admin/api/dicGroup/create",v,{customDev:!0})}async function it(v,C){return b("/admin/api/dicGroup/update",{dicGroupId:v,...C},{customDev:!0})}async function ut(v){return b("/admin/api/dicGroup/del",{dicGroupId:v},{customDev:!0})}async function rt(v){return b("/admin/api/dic/getList",v,{customDev:!0})}async function dt(v){return b("/admin/api/dic/create",v,{customDev:!0})}async function ct(v,C){return b("/admin/api/dic/update",{id:v,...C},{customDev:!0})}async function ce(v){return b("/admin/api/dic/del",{id:v},{customDev:!0})}const pt={class:"dictionary-management"},vt={class:"content-wrapper"},mt={class:"left-panel"},_t={class:"panel-header"},ft={class:"header-title"},yt={class:"title-icon"},gt={class:"search-box"},wt={key:0,class:"loading-container"},kt={key:1,class:"type-list"},ht=["onClick"],It={class:"type-info"},bt={class:"type-name"},Ct={class:"type-code"},Tt={class:"type-actions"},xt={class:"right-panel"},Dt={key:0,class:"empty-state"},Gt={class:"panel-header-info"},Lt={class:"type-code-tag"},St={key:0},Ot={class:"query-section"},Ut={class:"query-form"},At={class:"table-section"},Mt={class:"table-header"},Et={class:"table-info"},Ft={class:"info-value"},$t={class:"table-actions"},zt={class:"table-container"},qt=Oe({name:"DictionaryManagement",__name:"dictionary-management",setup(v){const C=c(!1),x=c([]),d=c(null),M=c(""),Z=Ue(()=>{if(!M.value.trim())return x.value;const a=M.value.trim().toLowerCase();return x.value.filter(e=>e.name.toLowerCase().includes(a)||e.code.toLowerCase().includes(a))}),V=c(!1),G=c([]),D=c(0),o=J({dicGroupId:void 0,name:"",content:"",status:void 0,page:1,limit:10,orderbyFiled:"weight:asc"}),L=c(!1),P=c(!1),K=c("新建字典类型"),S=c(!1),E=c(void 0),u=J({name:"",code:"",remark:"",weight:0}),O=c(!1),N=c(!1),Q=c("新建字典项"),F=c(!1),$=c(void 0),i=J({dicGroupId:void 0,name:"",content:"",status:1,weight:0}),g=c([]),U=c([]),pe=[{title:"字典标签",dataIndex:"name",key:"name"},{title:"字典值",dataIndex:"content",key:"content"},{title:"状态",dataIndex:"status",key:"status",width:100},{title:"权重",dataIndex:"weight",key:"weight",width:80},{title:"操作",key:"action",width:150,fixed:"right"}],R=async()=>{C.value=!0;try{const e=await ot({page:1,limit:1e3,orderbyFiled:"weight:asc"});if(e.data)if(x.value=Array.isArray(e.data)?e.data:e.data.list||[],d.value){const p=x.value.find(m=>{var z;return m.dicGroupId===((z=d.value)==null?void 0:z.dicGroupId)});p&&(d.value=p)}else x.value.length>0&&(d.value=x.value[0])}catch{r.error("获取字典类型列表失败")}finally{C.value=!1}},k=async()=>{var a,e;if(!d.value){G.value=[],D.value=0;return}V.value=!0;try{const p={dicGroupId:d.value.dicGroupId,page:o.page,limit:o.limit,orderbyFiled:o.orderbyFiled};(a=o.name)!=null&&a.trim()&&(p.name=o.name),(e=o.content)!=null&&e.trim()&&(p.content=o.content),o.status!==void 0&&(p.status=o.status);const m=await rt(p);m.data&&(Array.isArray(m.data)?(G.value=m.data,D.value=m.data.length):(G.value=m.data.list||[],D.value=m.data.count||0))}catch{r.error("获取字典项列表失败")}finally{V.value=!1}},ve=a=>{d.value=a,o.page=1,o.name="",o.content="",o.status=void 0,g.value=[],U.value=[],k()};Ae(()=>d.value,()=>{d.value&&k()});const me=()=>{K.value="新建字典类型",S.value=!1,E.value=void 0,u.name="",u.code="",u.remark="",u.weight=0,L.value=!0},_e=a=>{K.value="编辑字典类型",S.value=!0,E.value=a.dicGroupId,u.name=a.name,u.code=a.code,u.remark=a.remark||"",u.weight=a.weight,L.value=!0},fe=async()=>{if(!u.name.trim()){r.error("请输入字典类型名称");return}if(!u.code.trim()){r.error("请输入字典类型编码");return}P.value=!0;try{const a={name:u.name,code:u.code,remark:u.remark,weight:u.weight};S.value&&E.value?(await it(E.value,a),r.success("更新成功")):(await st(a),r.success("创建成功")),L.value=!1,R()}catch{r.error(S.value?"更新失败":"创建失败")}finally{P.value=!1}},ye=a=>{B.confirm({title:"确认删除",icon:W(X),content:`确定要删除字典类型"${a.name}"吗？删除后该类型下的所有字典项也将被删除。`,okText:"确定",okType:"danger",cancelText:"取消",onOk:async()=>{var e;try{await ut(a.dicGroupId),r.success("删除成功"),((e=d.value)==null?void 0:e.dicGroupId)===a.dicGroupId&&(d.value=null,G.value=[],D.value=0),R()}catch{r.error("删除失败")}}})},ge=()=>{if(!d.value){r.warning("请先选择字典类型");return}Q.value="新建字典项",F.value=!1,$.value=void 0,i.dicGroupId=d.value.dicGroupId,i.name="",i.content="",i.status=1,i.weight=0,O.value=!0},we=a=>{Q.value="编辑字典项",F.value=!0,$.value=a.id,i.dicGroupId=a.dicGroupId,i.name=a.name,i.content=a.content,i.status=a.status,i.weight=a.weight,O.value=!0},ke=async()=>{if(!i.name.trim()){r.error("请输入字典标签");return}if(!i.content.trim()){r.error("请输入字典值");return}N.value=!0;try{const a={dicGroupId:i.dicGroupId,name:i.name,content:i.content,status:i.status,weight:i.weight};F.value&&$.value?(await ct($.value,a),r.success("更新成功")):(await dt(a),r.success("创建成功")),O.value=!1,k()}catch{r.error(F.value?"更新失败":"创建失败")}finally{N.value=!1}},he=a=>{B.confirm({title:"确认删除",icon:W(X),content:`确定要删除字典项"${a.name}"吗？`,okText:"确定",okType:"danger",cancelText:"取消",onOk:async()=>{try{await ce(a.id),r.success("删除成功"),k()}catch{r.error("删除失败")}}})},Ie=()=>{if(g.value.length===0){r.warning("请选择要删除的字典项");return}B.confirm({title:"确认批量删除",icon:W(X),content:`确定要删除选中的 ${g.value.length} 个字典项吗？`,okText:"确定",okType:"danger",cancelText:"取消",onOk:async()=>{try{await Promise.all(g.value.map(a=>ce(a))),r.success("批量删除成功"),g.value=[],U.value=[],k()}catch{r.error("批量删除失败")}}})},j=()=>{o.page=1,g.value=[],U.value=[],k()},be=()=>{o.name="",o.content="",o.status=void 0,o.page=1,g.value=[],U.value=[],k()},Ce=(a,e)=>{g.value=a,U.value=e},Te=a=>{o.page=a.current,o.limit=a.pageSize,k()};return Me(()=>{R()}),(a,e)=>{const p=qe,m=Ve,z=Pe,ee=lt,te=Ke,f=Ne,ae=Re,xe=Qe,ne=je,H=He,De=Je,Ge=Xe,le=Ze,Le=et,oe=B,se=at,Se=tt;return _(),I("div",pt,[s("div",vt,[s("div",mt,[s("div",_t,[s("div",ft,[s("div",yt,[t(w(ze))]),e[14]||(e[14]=s("span",{class:"title-text"},"字典类型",-1))]),t(p,{type:"primary",size:"small",onClick:me},{icon:l(()=>[t(w(re))]),_:1})]),s("div",gt,[t(m,{value:M.value,"onUpdate:value":e[0]||(e[0]=n=>M.value=n),placeholder:"搜索字典类型...","allow-clear":"",class:"modern-search"},{prefix:l(()=>[t(w(Be))]),_:1},8,["value"])]),C.value?(_(),I("div",wt,[t(z,{size:"large",tip:"加载中..."})])):(_(),I("div",kt,[(_(!0),I(ie,null,Ee(Z.value,n=>{var h;return _(),I("div",{key:n.dicGroupId,class:Fe(["type-item",{active:((h=d.value)==null?void 0:h.dicGroupId)===n.dicGroupId}]),onClick:q=>ve(n)},[s("div",It,[s("div",bt,T(n.name),1),s("div",Ct,T(n.code),1)]),s("div",Tt,[t(ee,{title:"编辑"},{default:l(()=>[t(w(nt),{class:"action-icon",onClick:ue(q=>_e(n),["stop"])},null,8,["onClick"])]),_:2},1024),t(ee,{title:"删除"},{default:l(()=>[t(w(de),{class:"action-icon danger",onClick:ue(q=>ye(n),["stop"])},null,8,["onClick"])]),_:2},1024)])],10,ht)}),128)),Z.value.length===0?(_(),A(te,{key:0,description:"暂无数据",style:{"margin-top":"60px"}})):Y("",!0)]))]),s("div",xt,[d.value?(_(),I(ie,{key:1},[s("div",Gt,[s("h3",null,[y(T(d.value.name)+" ",1),s("span",Lt,T(d.value.code),1)]),d.value.remark?(_(),I("p",St,T(d.value.remark),1)):Y("",!0)]),s("div",Ot,[e[19]||(e[19]=s("div",{class:"query-header"},[s("h4",null,"筛选查询")],-1)),s("div",Ut,[t(H,{layout:"inline"},{default:l(()=>[t(f,{label:"字典标签"},{default:l(()=>[t(m,{value:o.name,"onUpdate:value":e[1]||(e[1]=n=>o.name=n),placeholder:"请输入","allow-clear":"",style:{width:"180px"},onPressEnter:j},null,8,["value"])]),_:1}),t(f,{label:"字典值"},{default:l(()=>[t(m,{value:o.content,"onUpdate:value":e[2]||(e[2]=n=>o.content=n),placeholder:"请输入","allow-clear":"",style:{width:"180px"},onPressEnter:j},null,8,["value"])]),_:1}),t(f,{label:"状态"},{default:l(()=>[t(xe,{value:o.status,"onUpdate:value":e[3]||(e[3]=n=>o.status=n),placeholder:"请选择","allow-clear":"",style:{width:"120px"}},{default:l(()=>[t(ae,{value:1},{default:l(()=>e[15]||(e[15]=[y("启用")])),_:1,__:[15]}),t(ae,{value:0},{default:l(()=>e[16]||(e[16]=[y("禁用")])),_:1,__:[16]})]),_:1},8,["value"])]),_:1}),t(f,null,{default:l(()=>[t(ne,null,{default:l(()=>[t(p,{type:"primary",onClick:j},{default:l(()=>e[17]||(e[17]=[y(" 查询 ")])),_:1,__:[17]}),t(p,{onClick:be},{default:l(()=>e[18]||(e[18]=[y(" 重置 ")])),_:1,__:[18]})]),_:1})]),_:1})]),_:1})])]),s("div",At,[s("div",Mt,[s("div",Et,[e[20]||(e[20]=s("span",{class:"info-label"},"数据列表",-1)),e[21]||(e[21]=s("span",{class:"info-divider"},"数据共",-1)),s("span",Ft,T(D.value),1),e[22]||(e[22]=s("span",{class:"info-unit"},"条",-1))]),s("div",$t,[t(p,{type:"primary",onClick:ge},{icon:l(()=>[t(w(re))]),default:l(()=>[e[23]||(e[23]=y(" 新建字典项 "))]),_:1,__:[23]}),t(p,{danger:"",disabled:g.value.length===0,onClick:Ie},{icon:l(()=>[t(w(de))]),default:l(()=>[e[24]||(e[24]=y(" 批量删除 "))]),_:1,__:[24]},8,["disabled"])])]),s("div",zt,[t(Ge,{columns:pe,"data-source":G.value,loading:V.value,pagination:{current:o.page,pageSize:o.limit,total:D.value,showSizeChanger:!0,showQuickJumper:!0,showTotal:n=>`共 ${n} 条`},"row-selection":{selectedRowKeys:g.value,onChange:Ce},scroll:{x:900},"row-key":n=>n.id,onChange:Te},{bodyCell:l(({column:n,record:h})=>[n.key==="status"?(_(),A(De,{key:0,color:h.status===1?"success":"error"},{icon:l(()=>[h.status===1?(_(),A(w(Ye),{key:0})):(_(),A(w(We),{key:1}))]),default:l(()=>[y(" "+T(h.status===1?"启用":"禁用"),1)]),_:2},1032,["color"])):n.key==="action"?(_(),A(ne,{key:1},{default:l(()=>[t(p,{type:"link",size:"small",onClick:q=>we(h)},{default:l(()=>e[25]||(e[25]=[y(" 编辑 ")])),_:2,__:[25]},1032,["onClick"]),t(p,{type:"link",size:"small",danger:"",onClick:q=>he(h)},{default:l(()=>e[26]||(e[26]=[y(" 删除 ")])),_:2,__:[26]},1032,["onClick"])]),_:2},1024)):Y("",!0)]),_:1},8,["data-source","loading","pagination","row-selection","row-key"])])])],64)):(_(),I("div",Dt,[t(te,{description:"请在左侧选择字典类型"})]))])]),t(oe,{open:L.value,"onUpdate:open":e[8]||(e[8]=n=>L.value=n),title:K.value,width:600,"confirm-loading":P.value,onOk:fe},{default:l(()=>[t(H,{model:u,"label-col":{span:6},"wrapper-col":{span:16},style:{"margin-top":"24px"}},{default:l(()=>[t(f,{label:"字典类型名称",required:""},{default:l(()=>[t(m,{value:u.name,"onUpdate:value":e[4]||(e[4]=n=>u.name=n),placeholder:"请输入字典类型名称","allow-clear":""},null,8,["value"])]),_:1}),t(f,{label:"字典类型编码",required:""},{default:l(()=>[t(m,{value:u.code,"onUpdate:value":e[5]||(e[5]=n=>u.code=n),placeholder:"请输入字典类型编码","allow-clear":"",disabled:S.value},null,8,["value","disabled"])]),_:1}),t(f,{label:"权重"},{default:l(()=>[t(le,{value:u.weight,"onUpdate:value":e[6]||(e[6]=n=>u.weight=n),min:0,style:{width:"100%"}},null,8,["value"])]),_:1}),t(f,{label:"备注"},{default:l(()=>[t(Le,{value:u.remark,"onUpdate:value":e[7]||(e[7]=n=>u.remark=n),placeholder:"请输入备注",rows:3,"allow-clear":""},null,8,["value"])]),_:1})]),_:1},8,["model"])]),_:1},8,["open","title","confirm-loading"]),t(oe,{open:O.value,"onUpdate:open":e[13]||(e[13]=n=>O.value=n),title:Q.value,width:600,"confirm-loading":N.value,onOk:ke},{default:l(()=>[t(H,{model:i,"label-col":{span:6},"wrapper-col":{span:16},style:{"margin-top":"24px"}},{default:l(()=>[t(f,{label:"字典标签",required:""},{default:l(()=>[t(m,{value:i.name,"onUpdate:value":e[9]||(e[9]=n=>i.name=n),placeholder:"请输入字典标签","allow-clear":""},null,8,["value"])]),_:1}),t(f,{label:"字典值",required:""},{default:l(()=>[t(m,{value:i.content,"onUpdate:value":e[10]||(e[10]=n=>i.content=n),placeholder:"请输入字典值","allow-clear":""},null,8,["value"])]),_:1}),t(f,{label:"状态"},{default:l(()=>[t(Se,{value:i.status,"onUpdate:value":e[11]||(e[11]=n=>i.status=n)},{default:l(()=>[t(se,{value:1},{default:l(()=>e[27]||(e[27]=[y("启用")])),_:1,__:[27]}),t(se,{value:0},{default:l(()=>e[28]||(e[28]=[y("禁用")])),_:1,__:[28]})]),_:1},8,["value"])]),_:1}),t(f,{label:"权重"},{default:l(()=>[t(le,{value:i.weight,"onUpdate:value":e[12]||(e[12]=n=>i.weight=n),min:0,style:{width:"100%"}},null,8,["value"])]),_:1})]),_:1},8,["model"])]),_:1},8,["open","title","confirm-loading"])])}}}),Kt=$e(qt,[["__scopeId","data-v-34273e0d"]]);export{Kt as default};
