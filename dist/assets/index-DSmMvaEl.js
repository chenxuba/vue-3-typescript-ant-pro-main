import{d as R,ab as D,f as C,o as G,a0 as u,a3 as r,a1 as s,k as a,a9 as i,G as _,ac as v,af as Q,F as g,ae as S}from"./vue-CLfcZxUN.js";import{i as q,f as H,j as K}from"./index-MAkF_cTe.js";import{ad as W,ae as X,Q as Y,U as Z,v as ee,G as te,$ as ae,E as ne,ap as oe,aa as h,a9 as $}from"./antd-Du2BR_SQ.js";import{_ as se}from"./index-BNgW0Kx4.js";const le={class:"raining-project-management"},ie={class:"search-section"},ce={class:"table-section"},ue={class:"table-header"},re={class:"table-tabs"},pe={class:"tabs-left"},de={class:"data-count"},_e={class:"tabs-right"},ve={key:4,class:"public-scope-cell"},me={key:5,class:"action-links"},ge=["onClick"],ye=["onClick"],he=["onClick"],ke=["onClick"],be=["onClick"],fe=R({name:"RainingProjectManagement",__name:"index",setup(Ce){const j=D(),c=C({projectName:"",environment:void 0,organizer:void 0}),w=[{label:"全栈环境",value:"全栈环境"},{label:"JupyterNotebook环境",value:"JupyterNotebook环境"},{label:"JupyterLab环境",value:"JupyterLab环境"},{label:"其他",value:"其他"}],P=[{label:"中国科学院计算机网络信息中心",value:"中国科学院计算机网络信息中心"}],o=C({current:1,pageSize:10,total:0}),I=[{title:"项目名称",dataIndex:"projectName",key:"projectName"},{title:"实验环境",dataIndex:"environment",key:"environment"},{title:"技能标签",dataIndex:"skillTag",key:"skillTag"},{title:"主办单位",dataIndex:"organizer",key:"organizer"},{title:"公开范围",dataIndex:"publicScope",key:"publicScope"},{title:"操作",key:"action",width:280}],k=C([]),T=C(!1),m=async()=>{T.value=!0;try{const n={page:o.value.current,limit:o.value.pageSize,startNum:(o.value.current-1)*o.value.pageSize,name:c.value.projectName||void 0,orgName:c.value.organizer||void 0,orderbyFiled:"createTime:desc"},e=await q(n);k.value=e.list,o.value.total=e.count}catch(n){h.error(n.message||"获取项目列表失败"),k.value=[],o.value.total=0}finally{T.value=!1}},F=n=>{o.value.current=n.current,o.value.pageSize=n.pageSize,m()},J=()=>{c.value={projectName:"",environment:void 0,organizer:void 0},o.value.current=1,m()},U=()=>{o.value.current=1,m()};G(()=>{m()});const V=()=>{j.push("/dashboard/raining-project-management/create")},B=n=>{j.push({path:"/dashboard/raining-project-management/statistics",query:{id:n.key,name:n.projectName}})},N=n=>{const e=n.status===1,p=e?"取消发布":"发布",y=e?0:1;$.confirm({title:`确认${p}`,content:`确定要${p}项目"${n.name}"吗？`,okText:"确认",cancelText:"取消",onOk:async()=>{try{await H({id:n.id,status:y}),h.success(`${p}成功`),m()}catch(d){console.error(`${p}失败：`,d),h.error(d.message||`${p}失败`)}}})},L=n=>{console.log("编辑",n)},O=n=>{$.confirm({title:"确认删除",content:`确定要删除项目"${n.name}"吗？删除后数据将无法恢复！`,okText:"确认删除",okType:"danger",cancelText:"取消",onOk:async()=>{try{await K({id:n.id}),h.success("删除成功"),k.value.length===1&&o.value.current>1&&(o.value.current-=1),m()}catch(e){console.error("删除失败：",e),h.error(e.message||"删除失败")}}})};return(n,e)=>{const p=Z,y=Y,d=X,x=ee,z=te,A=W,E=ae,b=ne,M=oe;return r(),u("div",le,[s("div",ie,[e[5]||(e[5]=s("h3",{class:"section-title"},"筛选查询",-1)),a(E,{model:c.value,layout:"horizontal",class:"search-form"},{default:i(()=>[a(A,{gutter:24},{default:i(()=>[a(d,{span:6},{default:i(()=>[a(y,{label:"项目名称：",name:"projectName"},{default:i(()=>[a(p,{value:c.value.projectName,"onUpdate:value":e[0]||(e[0]=l=>c.value.projectName=l),placeholder:"请输入项目名称"},null,8,["value"])]),_:1})]),_:1}),a(d,{span:6},{default:i(()=>[a(y,{label:"实验环境：",name:"environment"},{default:i(()=>[a(x,{value:c.value.environment,"onUpdate:value":e[1]||(e[1]=l=>c.value.environment=l),placeholder:"请选择实验环境",options:w,"allow-clear":""},null,8,["value"])]),_:1})]),_:1}),a(d,{span:6},{default:i(()=>[a(y,{label:"主办单位：",name:"organizer"},{default:i(()=>[a(x,{value:c.value.organizer,"onUpdate:value":e[2]||(e[2]=l=>c.value.organizer=l),placeholder:"请选择主办单位",options:P,"allow-clear":""},null,8,["value"])]),_:1})]),_:1}),a(d,{span:6,class:"form-actions"},{default:i(()=>[a(z,{type:"primary",onClick:U},{default:i(()=>e[3]||(e[3]=[_("查询")])),_:1,__:[3]}),a(z,{onClick:J},{default:i(()=>e[4]||(e[4]=[_("重置")])),_:1,__:[4]})]),_:1})]),_:1})]),_:1},8,["model"])]),s("div",ce,[s("div",ue,[s("div",re,[s("div",pe,[e[6]||(e[6]=s("span",{class:"tab-item active"},"数据列表",-1)),s("span",de,"数据共 "+v(o.value.total)+" 条",1)]),s("div",_e,[a(z,{type:"primary",onClick:V},{default:i(()=>e[7]||(e[7]=[_("新建项目")])),_:1,__:[7]})])])]),a(M,{columns:I,"data-source":k.value,loading:T.value,pagination:{current:o.value.current,pageSize:o.value.pageSize,total:o.value.total,showSizeChanger:!0,showQuickJumper:!0,showTotal:l=>`共 ${l} 条`},onChange:F,bordered:""},{bodyCell:i(({column:l,record:t})=>[l.key==="projectName"?(r(),u(g,{key:0},[_(v(t.name),1)],64)):l.key==="environment"?(r(),u(g,{key:1},[_(v(t.environment==1?"全栈环境":t.environment==2?"Python3.6":t.environment==3?"Python3.13":t.environment==4?"Python3.12/VNC":"-"),1)],64)):l.key==="skillTag"?(r(),u(g,{key:2},[_(v(t.tag),1)],64)):l.key==="organizer"?(r(),u(g,{key:3},[_(v(t.connectUnit||"-"),1)],64)):l.key==="publicScope"?(r(),u("div",ve,[s("div",{class:S(["status-badge",{"status-published":t.status===1,"status-unpublished":t.status!==1}])},v(t.status===1?"已发布":"未发布"),3),s("div",{class:S(["scope-badge",{"scope-full":t.authType===1,"scope-academy":t.authType===2,"scope-unit":t.authType===3,"scope-private":t.authType===4}])},v(t.authType===1?"完全公开":t.authType===2?"全院公开":t.authType===3?"本单位公开":t.authType===4?"不公开":"-"),3)])):l.key==="action"?(r(),u("div",me,[s("a",{onClick:f=>B(t)},"统计",8,ge),t.status===1?(r(),u(g,{key:0},[a(b,{type:"vertical"}),s("a",{onClick:f=>N(t)},"取消发布",8,ye),a(b,{type:"vertical"}),s("a",{onClick:f=>L(t)},"编辑",8,he)],64)):(r(),u(g,{key:1},[a(b,{type:"vertical"}),s("a",{onClick:f=>N(t)},"发布",8,ke)],64)),a(b,{type:"vertical"}),s("a",{class:"danger-link",onClick:f=>O(t)},"删除",8,be)])):Q("",!0)]),_:1},8,["data-source","loading","pagination"])])])}}}),xe=se(fe,[["__scopeId","data-v-01ccebd6"]]);export{xe as default};
