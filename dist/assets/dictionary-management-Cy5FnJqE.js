import{d as Ue,f as c,c as Oe,r as J,w as Ae,o as Me,_ as I,a1 as f,$ as i,k as t,u as w,a7 as l,a6 as A,ac as Y,F as ie,ag as Fe,G as y,a9 as T,l as Z,ab as $e,B as ue}from"./vue-PnzzEkKE.js";import{k as b,_ as ze}from"./index-DtsGq2fy.js";import{aq as Ee,ab as re,H as qe,ar as Be,I as Ve,Y as Pe,ad as Ke,z as Ne,a6 as Qe,ai as Re,S as je,K as He,af as de,ag as Je,as as Ye,am as Ze,an as We,ac as Xe,ah as et,M as B,a7 as tt,a8 as at,a1 as r,al as W,Z as nt,aj as lt}from"./antd-Cme2pY03.js";async function ot(m){return b("/admin/api/dicGroup/getList",m||{},{customDev:!0})}async function st(m){return b("/admin/api/dicGroup/create",m,{customDev:!0})}async function it(m,C){return b("/admin/api/dicGroup/update",{dicGroupId:m,...C},{customDev:!0})}async function ut(m){return b("/admin/api/dicGroup/del",{dicGroupId:m},{customDev:!0})}async function rt(m){return b("/admin/api/dic/getList",m,{customDev:!0})}async function dt(m){return b("/admin/api/dic/create",m,{customDev:!0})}async function ct(m,C){return b("/admin/api/dic/update",{id:m,...C},{customDev:!0})}async function ce(m){return b("/admin/api/dic/del",{id:m},{customDev:!0})}const pt={class:"dictionary-management"},vt={class:"content-wrapper"},mt={class:"left-panel"},_t={class:"panel-header"},ft={class:"header-title"},yt={class:"title-icon"},gt={class:"search-box"},wt={key:0,class:"loading-container"},kt={key:1,class:"type-list"},ht=["onClick"],It={class:"type-info"},bt={class:"type-name"},Ct={class:"type-code"},Tt={class:"type-actions"},xt={class:"right-panel"},Dt={key:0,class:"empty-state"},Gt={class:"panel-header-info"},Lt={class:"type-code-tag"},St={key:0},Ut={class:"query-section"},Ot={class:"query-form"},At={class:"table-section"},Mt={class:"table-header"},Ft={class:"table-info"},$t={class:"info-value"},zt={class:"table-actions"},Et={class:"table-container"},qt=Ue({name:"DictionaryManagement",__name:"dictionary-management",setup(m){const C=c(!1),x=c([]),d=c(null),M=c(""),X=Oe(()=>{if(!M.value.trim())return x.value;const a=M.value.trim().toLowerCase();return x.value.filter(e=>e.name.toLowerCase().includes(a)||e.code.toLowerCase().includes(a))}),V=c(!1),G=c([]),D=c(0),s=J({dicGroupId:void 0,name:"",content:"",status:void 0,page:1,limit:10,orderbyFiled:"weight:asc"}),L=c(!1),P=c(!1),K=c("新建字典类型"),S=c(!1),F=c(void 0),u=J({name:"",code:"",remark:"",weight:0}),U=c(!1),N=c(!1),Q=c("新建字典项"),$=c(!1),z=c(void 0),o=J({dicGroupId:void 0,name:"",content:"",config:"",status:1,weight:0}),g=c([]),O=c([]),pe=[{title:"字典标签",dataIndex:"name",key:"name"},{title:"字典值",dataIndex:"content",key:"content"},{title:"状态",dataIndex:"status",key:"status",width:100},{title:"权重",dataIndex:"weight",key:"weight",width:80},{title:"操作",key:"action",width:150,fixed:"right"}],R=async()=>{C.value=!0;try{const e=await ot({page:1,limit:1e3,orderbyFiled:"weight:asc"});if(e.data)if(x.value=Array.isArray(e.data)?e.data:e.data.list||[],d.value){const p=x.value.find(v=>{var E;return v.dicGroupId===((E=d.value)==null?void 0:E.dicGroupId)});p&&(d.value=p)}else x.value.length>0&&(d.value=x.value[0])}catch{r.error("获取字典类型列表失败")}finally{C.value=!1}},k=async()=>{var a,e;if(!d.value){G.value=[],D.value=0;return}V.value=!0;try{const p={dicGroupId:d.value.dicGroupId,page:s.page,limit:s.limit,orderbyFiled:s.orderbyFiled};(a=s.name)!=null&&a.trim()&&(p.name=s.name),(e=s.content)!=null&&e.trim()&&(p.content=s.content),s.status!==void 0&&(p.status=s.status);const v=await rt(p);v.data&&(Array.isArray(v.data)?(G.value=v.data,D.value=v.data.length):(G.value=v.data.list||[],D.value=v.data.total||0))}catch{r.error("获取字典项列表失败")}finally{V.value=!1}},ve=a=>{d.value=a,s.page=1,s.name="",s.content="",s.status=void 0,g.value=[],O.value=[],k()};Ae(()=>d.value,()=>{d.value&&k()});const me=()=>{K.value="新建字典类型",S.value=!1,F.value=void 0,u.name="",u.code="",u.remark="",u.weight=0,L.value=!0},_e=a=>{K.value="编辑字典类型",S.value=!0,F.value=a.dicGroupId,u.name=a.name,u.code=a.code,u.remark=a.remark||"",u.weight=a.weight,L.value=!0},fe=async()=>{if(!u.name.trim()){r.error("请输入字典类型名称");return}if(!u.code.trim()){r.error("请输入字典类型编码");return}P.value=!0;try{const a={name:u.name,code:u.code,remark:u.remark,weight:u.weight};S.value&&F.value?(await it(F.value,a),r.success("更新成功")):(await st(a),r.success("创建成功")),L.value=!1,R()}catch{r.error(S.value?"更新失败":"创建失败")}finally{P.value=!1}},ye=a=>{B.confirm({title:"确认删除",icon:Z(W),content:`确定要删除字典类型"${a.name}"吗？删除后该类型下的所有字典项也将被删除。`,okText:"确定",okType:"danger",cancelText:"取消",onOk:async()=>{var e;try{await ut(a.dicGroupId),r.success("删除成功"),((e=d.value)==null?void 0:e.dicGroupId)===a.dicGroupId&&(d.value=null,G.value=[],D.value=0),R()}catch{r.error("删除失败")}}})},ge=()=>{if(!d.value){r.warning("请先选择字典类型");return}Q.value="新建字典项",$.value=!1,z.value=void 0,o.dicGroupId=d.value.dicGroupId,o.name="",o.content="",o.config="",o.status=1,o.weight=0,U.value=!0},we=a=>{Q.value="编辑字典项",$.value=!0,z.value=a.id,o.dicGroupId=a.dicGroupId,o.name=a.name,o.content=a.content,o.config=a.config||"",o.status=a.status,o.weight=a.weight,U.value=!0},ke=async()=>{if(!o.name.trim()){r.error("请输入字典标签");return}if(!o.content.trim()){r.error("请输入字典值");return}N.value=!0;try{const a={dicGroupId:o.dicGroupId,name:o.name,content:o.content,config:o.config,status:o.status,weight:o.weight};$.value&&z.value?(await ct(z.value,a),r.success("更新成功")):(await dt(a),r.success("创建成功")),U.value=!1,k()}catch{r.error($.value?"更新失败":"创建失败")}finally{N.value=!1}},he=a=>{B.confirm({title:"确认删除",icon:Z(W),content:`确定要删除字典项"${a.name}"吗？`,okText:"确定",okType:"danger",cancelText:"取消",onOk:async()=>{try{await ce(a.id),r.success("删除成功"),k()}catch{r.error("删除失败")}}})},Ie=()=>{if(g.value.length===0){r.warning("请选择要删除的字典项");return}B.confirm({title:"确认批量删除",icon:Z(W),content:`确定要删除选中的 ${g.value.length} 个字典项吗？`,okText:"确定",okType:"danger",cancelText:"取消",onOk:async()=>{try{await Promise.all(g.value.map(a=>ce(a))),r.success("批量删除成功"),g.value=[],O.value=[],k()}catch{r.error("批量删除失败")}}})},j=()=>{s.page=1,g.value=[],O.value=[],k()},be=()=>{s.name="",s.content="",s.status=void 0,s.page=1,g.value=[],O.value=[],k()},Ce=(a,e)=>{g.value=a,O.value=e},Te=a=>{s.page=a.current,s.limit=a.pageSize,k()};return Me(()=>{R()}),(a,e)=>{const p=qe,v=Ve,E=Pe,ee=lt,te=Ke,_=Ne,ae=Re,xe=Qe,ne=je,H=He,De=Je,Ge=We,le=Xe,Le=et,oe=B,se=at,Se=tt;return f(),I("div",pt,[i("div",vt,[i("div",mt,[i("div",_t,[i("div",ft,[i("div",yt,[t(w(Ee))]),e[15]||(e[15]=i("span",{class:"title-text"},"字典类型",-1))]),t(p,{type:"primary",size:"small",onClick:me},{icon:l(()=>[t(w(re))]),_:1})]),i("div",gt,[t(v,{value:M.value,"onUpdate:value":e[0]||(e[0]=n=>M.value=n),placeholder:"搜索字典类型...","allow-clear":"",class:"modern-search"},{prefix:l(()=>[t(w(Be))]),_:1},8,["value"])]),C.value?(f(),I("div",wt,[t(E,{size:"large",tip:"加载中..."})])):(f(),I("div",kt,[(f(!0),I(ie,null,Fe(X.value,n=>{var h;return f(),I("div",{key:n.dicGroupId,class:$e(["type-item",{active:((h=d.value)==null?void 0:h.dicGroupId)===n.dicGroupId}]),onClick:q=>ve(n)},[i("div",It,[i("div",bt,T(n.name),1),i("div",Ct,T(n.code),1)]),i("div",Tt,[t(ee,{title:"编辑"},{default:l(()=>[t(w(nt),{class:"action-icon",onClick:ue(q=>_e(n),["stop"])},null,8,["onClick"])]),_:2},1024),t(ee,{title:"删除"},{default:l(()=>[t(w(de),{class:"action-icon danger",onClick:ue(q=>ye(n),["stop"])},null,8,["onClick"])]),_:2},1024)])],10,ht)}),128)),X.value.length===0?(f(),A(te,{key:0,description:"暂无数据",style:{"margin-top":"60px"}})):Y("",!0)]))]),i("div",xt,[d.value?(f(),I(ie,{key:1},[i("div",Gt,[i("h3",null,[y(T(d.value.name)+" ",1),i("span",Lt,T(d.value.code),1)]),d.value.remark?(f(),I("p",St,T(d.value.remark),1)):Y("",!0)]),i("div",Ut,[e[20]||(e[20]=i("div",{class:"query-header"},[i("h4",null,"筛选查询")],-1)),i("div",Ot,[t(H,{layout:"inline"},{default:l(()=>[t(_,{label:"字典标签"},{default:l(()=>[t(v,{value:s.name,"onUpdate:value":e[1]||(e[1]=n=>s.name=n),placeholder:"请输入","allow-clear":"",style:{width:"180px"},onPressEnter:j},null,8,["value"])]),_:1}),t(_,{label:"字典值"},{default:l(()=>[t(v,{value:s.content,"onUpdate:value":e[2]||(e[2]=n=>s.content=n),placeholder:"请输入","allow-clear":"",style:{width:"180px"},onPressEnter:j},null,8,["value"])]),_:1}),t(_,{label:"状态"},{default:l(()=>[t(xe,{value:s.status,"onUpdate:value":e[3]||(e[3]=n=>s.status=n),placeholder:"请选择","allow-clear":"",style:{width:"120px"}},{default:l(()=>[t(ae,{value:1},{default:l(()=>e[16]||(e[16]=[y("启用")])),_:1,__:[16]}),t(ae,{value:0},{default:l(()=>e[17]||(e[17]=[y("禁用")])),_:1,__:[17]})]),_:1},8,["value"])]),_:1}),t(_,null,{default:l(()=>[t(ne,null,{default:l(()=>[t(p,{type:"primary",onClick:j},{default:l(()=>e[18]||(e[18]=[y(" 查询 ")])),_:1,__:[18]}),t(p,{onClick:be},{default:l(()=>e[19]||(e[19]=[y(" 重置 ")])),_:1,__:[19]})]),_:1})]),_:1})]),_:1})])]),i("div",At,[i("div",Mt,[i("div",Ft,[e[21]||(e[21]=i("span",{class:"info-label"},"数据列表",-1)),e[22]||(e[22]=i("span",{class:"info-divider"},"数据共",-1)),i("span",$t,T(D.value),1),e[23]||(e[23]=i("span",{class:"info-unit"},"条",-1))]),i("div",zt,[t(p,{type:"primary",onClick:ge},{icon:l(()=>[t(w(re))]),default:l(()=>[e[24]||(e[24]=y(" 新建字典项 "))]),_:1,__:[24]}),t(p,{danger:"",disabled:g.value.length===0,onClick:Ie},{icon:l(()=>[t(w(de))]),default:l(()=>[e[25]||(e[25]=y(" 批量删除 "))]),_:1,__:[25]},8,["disabled"])])]),i("div",Et,[t(Ge,{columns:pe,"data-source":G.value,loading:V.value,pagination:{current:s.page,pageSize:s.limit,total:D.value,showSizeChanger:!0,showQuickJumper:!0,showTotal:n=>`共 ${n} 条`},"row-selection":{selectedRowKeys:g.value,onChange:Ce},scroll:{x:900},"row-key":n=>n.id,onChange:Te},{bodyCell:l(({column:n,record:h})=>[n.key==="status"?(f(),A(De,{key:0,color:h.status===1?"success":"error"},{icon:l(()=>[h.status===1?(f(),A(w(Ye),{key:0})):(f(),A(w(Ze),{key:1}))]),default:l(()=>[y(" "+T(h.status===1?"启用":"禁用"),1)]),_:2},1032,["color"])):n.key==="action"?(f(),A(ne,{key:1},{default:l(()=>[t(p,{type:"link",size:"small",onClick:q=>we(h)},{default:l(()=>e[26]||(e[26]=[y(" 编辑 ")])),_:2,__:[26]},1032,["onClick"]),t(p,{type:"link",size:"small",danger:"",onClick:q=>he(h)},{default:l(()=>e[27]||(e[27]=[y(" 删除 ")])),_:2,__:[27]},1032,["onClick"])]),_:2},1024)):Y("",!0)]),_:1},8,["data-source","loading","pagination","row-selection","row-key"])])])],64)):(f(),I("div",Dt,[t(te,{description:"请在左侧选择字典类型"})]))])]),t(oe,{open:L.value,"onUpdate:open":e[8]||(e[8]=n=>L.value=n),title:K.value,width:600,"confirm-loading":P.value,onOk:fe},{default:l(()=>[t(H,{model:u,"label-col":{span:6},"wrapper-col":{span:16},style:{"margin-top":"24px"}},{default:l(()=>[t(_,{label:"字典类型名称",required:""},{default:l(()=>[t(v,{value:u.name,"onUpdate:value":e[4]||(e[4]=n=>u.name=n),placeholder:"请输入字典类型名称","allow-clear":""},null,8,["value"])]),_:1}),t(_,{label:"字典类型编码",required:""},{default:l(()=>[t(v,{value:u.code,"onUpdate:value":e[5]||(e[5]=n=>u.code=n),placeholder:"请输入字典类型编码","allow-clear":"",disabled:S.value},null,8,["value","disabled"])]),_:1}),t(_,{label:"权重"},{default:l(()=>[t(le,{value:u.weight,"onUpdate:value":e[6]||(e[6]=n=>u.weight=n),min:0,style:{width:"100%"}},null,8,["value"])]),_:1}),t(_,{label:"备注"},{default:l(()=>[t(Le,{value:u.remark,"onUpdate:value":e[7]||(e[7]=n=>u.remark=n),placeholder:"请输入备注",rows:3,"allow-clear":""},null,8,["value"])]),_:1})]),_:1},8,["model"])]),_:1},8,["open","title","confirm-loading"]),t(oe,{open:U.value,"onUpdate:open":e[14]||(e[14]=n=>U.value=n),title:Q.value,width:600,"confirm-loading":N.value,onOk:ke},{default:l(()=>[t(H,{model:o,"label-col":{span:6},"wrapper-col":{span:16},style:{"margin-top":"24px"}},{default:l(()=>[t(_,{label:"字典标签",required:""},{default:l(()=>[t(v,{value:o.name,"onUpdate:value":e[9]||(e[9]=n=>o.name=n),placeholder:"请输入字典标签","allow-clear":""},null,8,["value"])]),_:1}),t(_,{label:"字典值",required:""},{default:l(()=>[t(v,{value:o.content,"onUpdate:value":e[10]||(e[10]=n=>o.content=n),placeholder:"请输入字典值","allow-clear":""},null,8,["value"])]),_:1}),t(_,{label:"配置"},{default:l(()=>[t(v,{value:o.config,"onUpdate:value":e[11]||(e[11]=n=>o.config=n),placeholder:"请输入配置（可选）","allow-clear":""},null,8,["value"])]),_:1}),t(_,{label:"状态"},{default:l(()=>[t(Se,{value:o.status,"onUpdate:value":e[12]||(e[12]=n=>o.status=n)},{default:l(()=>[t(se,{value:1},{default:l(()=>e[28]||(e[28]=[y("启用")])),_:1,__:[28]}),t(se,{value:0},{default:l(()=>e[29]||(e[29]=[y("禁用")])),_:1,__:[29]})]),_:1},8,["value"])]),_:1}),t(_,{label:"权重"},{default:l(()=>[t(le,{value:o.weight,"onUpdate:value":e[13]||(e[13]=n=>o.weight=n),min:0,style:{width:"100%"}},null,8,["value"])]),_:1})]),_:1},8,["model"])]),_:1},8,["open","title","confirm-loading"])])}}}),Kt=ze(qt,[["__scopeId","data-v-fe94432c"]]);export{Kt as default};
