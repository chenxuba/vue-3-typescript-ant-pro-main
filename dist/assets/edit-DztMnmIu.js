import{d as G,ab as L,ao as $,f as p,w as z,c as D,o as W,a0 as _,a3 as v,a1 as c,k as o,a9 as l,G as u,af as T,F as q,ac as C,a8 as N}from"./vue-CHyeelTQ.js";import{R as K}from"./RichTextEditor-DzAN3D0d.js";import{g as Q,a as X}from"./dictionary-Dwb1_Ndf.js";import{e as Y}from"./index-CIFBU6iq.js";import{a7 as i,ac as Z,ad as ee,a0 as ae,U as te,V as oe,$ as ne,w as re,H as le,al as se}from"./antd-CtyD9qUH.js";import{_ as ue}from"./index-DxV6Ufq3.js";const ie={class:"edit-project-page"},de={class:"page-content"},ce={class:"project-type-section"},pe={class:"project-type-desc"},ve={class:"project-form-section"},me={class:"form-title"},fe={key:0},_e={class:"page-footer"},ge=G({name:"EditRainingProject",__name:"edit",setup(ye){const m=L(),E=$(),g=p(),w=p(),y=p(!1),h=p(!1),n=p(1),t=p({name:"",description:"",difficulty:void 0,environment:void 0,secondType:void 0,classHour:"",showTaskRequire:!1}),U={name:[{required:!0,message:"请输入名称",trigger:"blur"}],description:[{required:!0,validator:(a,e)=>!e||!e.replace(/<[^>]*>/g,"").trim()?Promise.reject("请输入简介"):Promise.resolve(),trigger:"blur"}],difficulty:[{required:!0,message:"请选择难度",trigger:"change"}],environment:[{required:!0,message:"请选择实验环境",trigger:"change"}],secondType:[{required:!0,message:"请选择小类别",trigger:"change"}]},H=[{label:"简单",value:1},{label:"适中",value:2},{label:"困难",value:3}],b=p({1:[],2:[],3:[]}),M=()=>(b.value[n.value]||[]).map(r=>({label:r.name,value:r.value})),R=async a=>{if(!(b.value[a].length>0))try{h.value=!0;const e=Q(a);if(!e)return;const r=await X({code:e});r&&r.list&&(b.value[a]=r.list)}catch{i.error("加载实验环境选项失败")}finally{h.value=!1}},V=()=>n.value!==2&&n.value!==3?[]:[{label:"Bwapp",value:1},{label:"CSS",value:2},{label:"DataTurks",value:3}],B=async()=>{if(!g.value){i.error("缺少项目ID"),m.back();return}try{y.value=!0;const a=await Y({id:g.value});a.projectType&&(n.value=a.projectType,await R(a.projectType)),t.value={name:a.name||"",description:a.description||"",difficulty:a.difficulty||void 0,environment:a.environment||void 0,secondType:a.secondType||void 0,classHour:a.classHour?String(a.classHour):"",showTaskRequire:a.showTaskRequire===1}}catch(a){i.error(a.message||"获取项目详情失败"),m.back()}finally{y.value=!1}},P=()=>{m.back()},S=async()=>{var k,f;try{await((k=w.value)==null?void 0:k.validate())}catch{return}if(!t.value.name){i.error("请输入名称");return}if(!(((f=t.value.description)==null?void 0:f.replace(/<[^>]*>/g,"").trim())||"")){i.error("请输入简介");return}if(!t.value.difficulty){i.error("请选择难度");return}if(!t.value.environment){i.error("请选择实验环境");return}if((n.value===2||n.value===3)&&!t.value.secondType){i.error("请选择小类别");return}const r={1:"/dashboard/raining-project-management/edit-full-stack",2:"/dashboard/raining-project-management/edit-jupyter-notebook",3:"/dashboard/raining-project-management/edit-jupyter-lab"}[n.value];r?m.push({path:r,query:{id:g.value}}):i.error("未知的项目类型")};z(n,a=>{t.value.environment=void 0,t.value.secondType=void 0,t.value.showTaskRequire=!1,R(a)});const I=D(()=>({1:"全栈环境",2:"JupyterNotebook环境",3:"JupyterLab环境"})[n.value]||""),O=D(()=>{if(!t.value.environment)return"";const e=(b.value[n.value]||[]).find(r=>r.value===t.value.environment);return(e==null?void 0:e.name)||""});return W(()=>{const a=E.query.id;a?(g.value=Number(a),B()):(i.error("缺少项目ID"),m.back())}),(a,e)=>{const r=ee,k=Z,f=oe,d=te,F=ne,j=re,J=ae,x=le,A=se;return v(),_("div",ie,[e[14]||(e[14]=c("div",{class:"page-header"},[c("h2",null,"编辑实训项目")],-1)),o(A,{spinning:y.value},{default:l(()=>[c("div",de,[c("div",ce,[o(k,{value:n.value,"onUpdate:value":e[0]||(e[0]=s=>n.value=s),class:"custom-radio",disabled:""},{default:l(()=>[o(r,{value:1},{default:l(()=>e[8]||(e[8]=[u("全栈环境实训项目")])),_:1,__:[8]}),o(r,{value:2},{default:l(()=>e[9]||(e[9]=[u("JupyterNotebook环境实训项目")])),_:1,__:[9]}),o(r,{value:3},{default:l(()=>e[10]||(e[10]=[u("JupyterLab环境实训项目")])),_:1,__:[10]})]),_:1},8,["value"])]),c("div",pe,[n.value===1?(v(),_(q,{key:0},[u(" 多功能新型实战项目模式，支持图形化桌面、Web IDE、命令行、提供仿真拟真等种实验场景，适用于各类复杂工程项目研发。 ")],64)):n.value===2?(v(),_(q,{key:1},[u(" 多功能实时交互实验模式，支持实时代码、数学方程、可视化和MarkDown等。 适用于数据清理、数值模拟、统计建模、机器学习等系列实验。 ")],64)):n.value===3?(v(),_(q,{key:2},[u(" 多功能实时交互实验模式，支持实时代码、数学方程、可视化和MarkDown等。 适用于数据清理、数值模拟、统计建模、机器学习等系列实验。 ")],64)):T("",!0)]),c("div",ve,[c("div",me,[u(C(I.value)+"实训项目 ",1),t.value.environment?(v(),_("span",fe," 实验环境: "+C(O.value),1)):T("",!0)]),o(J,{ref_key:"formRef",ref:w,model:t.value,rules:U,layout:"horizontal","label-col":{span:3},"wrapper-col":{span:18}},{default:l(()=>[o(d,{label:"名称",name:"name",required:""},{default:l(()=>[o(f,{value:t.value.name,"onUpdate:value":e[1]||(e[1]=s=>t.value.name=s),placeholder:"请输入名称"},null,8,["value"])]),_:1}),o(d,{label:"简介",name:"description",required:""},{default:l(()=>[o(K,{modelValue:t.value.description,"onUpdate:modelValue":e[2]||(e[2]=s=>t.value.description=s),placeholder:"请输入简介内容",height:200},null,8,["modelValue"])]),_:1}),n.value===2?(v(),N(d,{key:0,label:"任务要求",name:"showTaskRequire"},{default:l(()=>[o(F,{checked:t.value.showTaskRequire,"onUpdate:checked":e[3]||(e[3]=s=>t.value.showTaskRequire=s)},{default:l(()=>e[11]||(e[11]=[u(" 显示任务要求（勾选后，将简介作为任务要求显示在实践项目挑战页面） ")])),_:1,__:[11]},8,["checked"])]),_:1})):T("",!0),o(d,{label:"难度",name:"difficulty",required:""},{default:l(()=>[o(j,{value:t.value.difficulty,"onUpdate:value":e[4]||(e[4]=s=>t.value.difficulty=s),placeholder:"请选择难度",options:H},null,8,["value"])]),_:1}),o(d,{label:"实验环境",name:"environment",required:""},{default:l(()=>[o(j,{value:t.value.environment,"onUpdate:value":e[5]||(e[5]=s=>t.value.environment=s),placeholder:"请选择实验环境",options:M(),loading:h.value},null,8,["value","options","loading"])]),_:1}),n.value===2||n.value===3?(v(),N(d,{key:1,label:"小类别",name:"secondType",required:""},{default:l(()=>[o(j,{value:t.value.secondType,"onUpdate:value":e[6]||(e[6]=s=>t.value.secondType=s),placeholder:"请选择小类别",options:V()},null,8,["value","options"])]),_:1})):T("",!0),o(d,{label:"学时",name:"classHour"},{default:l(()=>[o(f,{value:t.value.classHour,"onUpdate:value":e[7]||(e[7]=s=>t.value.classHour=s),placeholder:"配置任务后自动计算",disabled:""},null,8,["value"])]),_:1})]),_:1},8,["model"])]),c("div",_e,[o(x,{onClick:P},{default:l(()=>e[12]||(e[12]=[u("返回")])),_:1,__:[12]}),o(x,{type:"primary",loading:y.value,onClick:S},{default:l(()=>e[13]||(e[13]=[u("下一步")])),_:1,__:[13]},8,["loading"])])])]),_:1},8,["spinning"])])}}}),Re=ue(ge,[["__scopeId","data-v-41e0360a"]]);export{Re as default};
