import{d as Ye,ak as Qe,am as We,f as p,c as we,w as he,o as Xe,_,a1 as g,$ as n,k as a,a7 as l,ac as V,F as x,ag as W,u as F,a6 as Ze,G as f,a9 as L,ab as be,y as ke}from"./vue-PnzzEkKE.js";import{R as Te,u as Se}from"./RichTextEditor-BZ6k2msk.js";import{e as et,f as tt,b as X,a as at,g as lt,s as st}from"./index-B1Xh1V9A.js";import{g as ot,a as rt}from"./dictionary-DmnWjV1N.js";import{u as nt,a as it,e as ut}from"./dictionary-BH2xq6oF.js";import{H as I,j as vt,t as dt,x as re,c as ct,a as pt,m as ft,F as mt}from"./FileSelectModal-DSnXUhqr.js";import{a1 as r,a3 as gt,a2 as _t,K as yt,z as wt,I as ht,a4 as bt,a5 as kt,a6 as Tt,a7 as St,a8 as Ct,ac as At,a9 as xt,H as Lt,J as Ut,aj as Vt,Y as It,T as Rt,s as jt,ah as qt,af as Mt}from"./antd-Cme2pY03.js";import{_ as Ht}from"./index-Du0fLm_v.js";const Pt={class:"edit-jupyter-lab-page"},Ft={class:"page-container"},Dt={class:"steps-section"},Et={key:0},Nt={class:"form-section"},Jt={class:"flex items-top gap-16px"},zt={class:"flex flex-col gap-12px"},$t={key:0,class:"image-preview"},Bt=["src"],Ot={class:"flex items-top gap-16px"},Gt={class:"flex flex-col gap-12px"},Kt={key:0,class:"image-preview"},Yt=["src"],Qt={class:"form-section"},Wt={key:1,class:"step-content"},Xt={class:"jupyter-header"},Zt={class:"jupyter-actions"},ea={class:"jupyter-iframe-wrapper"},ta={key:0,class:"loading-container"},aa=["src"],la={key:2,class:"step-content evaluation-step"},sa={class:"evaluation-section"},oa={class:"section-block"},ra={class:"block-content"},na={style:{display:"flex","align-items":"center",gap:"8px"}},ia={key:0,class:"section-block"},ua={class:"block-header"},va={class:"header-actions"},da={class:"block-content"},ca={class:"test-set-label"},pa={class:"tab-footer-buttons"},fa={class:"reference-section"},ma={class:"section-block"},ga={class:"block-content"},_a={class:"tab-footer-buttons"},ya={key:3,class:"step-content environment-step"},wa={class:"environment-section"},ha={class:"environment-container"},ba={class:"environment-left"},ka={class:"search-box"},Ta={class:"environment-list"},Sa=["onClick"],Ca={class:"environment-right"},Aa={class:"environment-config-header"},xa={style:{display:"flex","align-items":"center",gap:"8px"}},La={class:"page-footer"},Ua=Ye({name:"EditJupyterLab",__name:"edit-jupyter-lab",setup(Va){I.registerLanguage("javascript",vt),I.registerLanguage("typescript",dt),I.registerLanguage("xml",re),I.registerLanguage("html",re),I.registerLanguage("vue",re),I.registerLanguage("css",ct),I.registerLanguage("json",pt),I.registerLanguage("markdown",ft);const D=Qe(),Ce=We(),C=p(null),y=p(null),w=p(0),j=p(!1),N=p(),ne=p(),i=p({name:"",tag:"",fieldType:void 0,difficulty:1,environment:void 0,secondType:void 0,classHour:0,topCover:"",cover:"",description:"",showTaskRequire:!1,authType:1,enableCodeRepository:!1,repositoryType:"ä»£ç ä»“åº“",gitUrl:""}),J=p(""),z=p(""),$=p(!1),B=p(!1),O=window.location.origin,Z=p(""),q=p(!1),ee=p(!1),Ae=()=>{q.value=!q.value},ie={name:[{required:!0,message:"è¯·è¾“å…¥åç§°",trigger:"blur"}],tag:[{required:!0,message:"è¯·è¾“å…¥æŠ€èƒ½æ ‡ç­¾",trigger:"blur"}],fieldType:[{required:!0,message:"è¯·é€‰æ‹©é¢†åŸŸç±»åˆ«",trigger:"change"}],difficulty:[{required:!0,message:"è¯·é€‰æ‹©éš¾åº¦",trigger:"change"}],environment:[{required:!0,message:"è¯·é€‰æ‹©å®éªŒç¯å¢ƒ",trigger:"change"}],topCover:[{required:!0,message:"è¯·ä¸Šä¼ é¡¶éƒ¨èƒŒæ™¯å›¾",trigger:"change"}],cover:[{required:!0,message:"è¯·ä¸Šä¼ å°é¢å›¾",trigger:"change"}],authType:[{required:!0,message:"è¯·é€‰æ‹©åŸ¹è®­å…¬å¼€èŒƒå›´",trigger:"change"}]},te=nt(),ue=it(),ae=ut(),S=p([]),le=p(!1),xe=async()=>{try{le.value=!0;const t=ot(3),e=await rt({code:t});e&&e.list&&(S.value=e.list.map(u=>({label:u.name,value:String(u.value)})),console.log("åŠ è½½ç¯å¢ƒé€‰é¡¹:",{environmentOptions:S.value,currentEnvironment:i.value.environment}),i.value.environment?(k.value=String(i.value.environment),h.value.dockerImage=String(i.value.environment),console.log("ä½¿ç”¨ç¬¬ä¸€æ­¥çš„ç¯å¢ƒ:",i.value.environment)):!k.value&&S.value.length>0&&(k.value=S.value[0].value,h.value.dockerImage=S.value[0].value,i.value.environment=S.value[0].value,console.log("é»˜è®¤é€‰ä¸­ç¬¬ä¸€ä¸ªç¯å¢ƒ:",S.value[0])))}catch(t){console.error("åŠ è½½å®éªŒç¯å¢ƒé€‰é¡¹å¤±è´¥ï¼š",t),r.error("åŠ è½½å®éªŒç¯å¢ƒé€‰é¡¹å¤±è´¥")}finally{le.value=!1}},Le=[{title:"åŸºæœ¬ä¿¡æ¯"},{title:"å®éªŒå†…å®¹"},{title:"è¯„æµ‹è®¾ç½®"},{title:"å®éªŒç¯å¢ƒ"}],se=p(!1),ve=p("settings"),s=p({openTestValidate:1,testValidateFiles:"",testValidateSh:"",timeLimitM:"",classHour:void 0,scoreRule:1,evaluationSetting:1,testSets:[]}),m=p({showAnswer:1,prohibitCopyAnswer:1,referenceAnswer:""}),M=p(!1),H=p(!1);let oe=1;const Ue=()=>{s.value.testSets.push({id:oe++,answer:"",select:1})},Ve=t=>{if(s.value.testSets.length===1){r.warning("è‡³å°‘ä¿ç•™ä¸€ä¸ªæµ‹è¯•é›†");return}s.value.testSets=s.value.testSets.filter(e=>e.id!==t),r.success("åˆ é™¤æˆåŠŸ")},Ie=(t,e)=>{t.select=e?1:2},de=p([]),Re=t=>{de.value=t.map(u=>({uid:u.uid,name:u.name,status:"done",url:u.path}));const e=t.map(u=>u.path).join(",");s.value.testValidateFiles=e,r.success(`å·²é€‰æ‹© ${t.length} ä¸ªæ–‡ä»¶`),se.value=!1},k=p(""),G=p(""),je=we(()=>G.value?S.value.filter(t=>t.label.toLowerCase().includes(G.value.toLowerCase())):S.value),qe=we(()=>{const t=S.value.find(e=>e.value===k.value);return t?t.label:"æœªé€‰æ‹©"}),h=p({dockerImage:"",secondType:"Css",timeLimitM:""}),Me=t=>{k.value=t,h.value.dockerImage=t,i.value.environment!==t&&(i.value.environment=t)},He=async()=>{if(!C.value){r.error("ç¼ºå°‘é¡¹ç›®ID"),D.back();return}try{j.value=!0;const t=await et({id:C.value});i.value={name:t.name||"",tag:t.tag||"",fieldType:t.fieldType,difficulty:t.difficulty||1,environment:t.environment,secondType:t.secondType,classHour:Number(t.classHour)||void 0,topCover:t.topCover||"",cover:t.cover||"",description:t.description||"",showTaskRequire:t.showTaskRequire===1,authType:t.authType||1,enableCodeRepository:t.gitUrl?!0:t.enableCodeRepository||!1,repositoryType:t.repositoryType||"ä»£ç ä»“åº“",gitUrl:t.gitUrl||""},t.topCover&&(J.value=O+t.topCover),t.cover&&(z.value=O+t.cover),t.environment&&(await ke(),k.value=String(t.environment),h.value.dockerImage=String(t.environment),console.log("åŒæ­¥ç¯å¢ƒåˆ°ç¬¬å››æ­¥:",{environment:t.environment,selectedEnvironment:k.value,environmentOptions:S.value})),await Pe()}catch(t){console.error("è·å–é¡¹ç›®è¯¦æƒ…å¤±è´¥ï¼š",t),r.error(t.message||"è·å–é¡¹ç›®è¯¦æƒ…å¤±è´¥"),D.back()}finally{j.value=!1}},Pe=async()=>{if(C.value)try{const t=await tt({projectId:C.value,orderbyFiled:"weight:asc"});let e=[];if(Array.isArray(t)?e=t:t&&typeof t=="object"&&(e=t.list||t.data||t.tasks||[]),e&&e.length>0){const u=e[0];if(u){if(y.value=u.taskId,s.value={openTestValidate:u.openTestValidate||1,testValidateFiles:u.testValidateFiles||"",testValidateSh:u.testValidateSh||"",timeLimitM:u.timeLimitM||"",classHour:u.classHour||void 0,scoreRule:u.scoreRule||1,evaluationSetting:u.evaluationSetting||1,testSets:[]},u.testContent)try{const d=JSON.parse(u.testContent);s.value.testSets=d.map((c,v)=>({id:v+1,answer:c.answer||"",select:c.select||1})),oe=s.value.testSets.length+1}catch(d){console.error("è§£ææµ‹è¯•é›†å¤±è´¥:",d)}s.value.testSets.length===0&&(s.value.testSets=[{id:1,answer:"",select:1},{id:2,answer:"",select:1}],oe=3),u.testValidateFiles&&(de.value=u.testValidateFiles.split(",").map((d,c)=>({uid:`${c}`,name:d.split("/").pop()||`æ–‡ä»¶${c+1}`,status:"done",url:d,response:d}))),m.value={showAnswer:u.showAnswer||1,prohibitCopyAnswer:u.prohibitCopyAnswer||1,referenceAnswer:u.referenceAnswer||""},u.secondType&&(h.value.secondType=u.secondType),u.timeLimitM&&(h.value.timeLimitM=u.timeLimitM),M.value=!0,H.value=!0}}}catch(t){console.error("è·å–ä»»åŠ¡åˆ—è¡¨å¤±è´¥ï¼š",t)}},Fe=async t=>{var d;if(!(t.size/1024/1024<12))return r.error("å›¾ç‰‡å¤§å°ä¸èƒ½è¶…è¿‡ 12MB!"),!1;if(!(t.type==="image/jpeg"||t.type==="image/png"))return r.error("åªèƒ½ä¸Šä¼  JPG/PNG æ ¼å¼çš„å›¾ç‰‡!"),!1;try{$.value=!0;const c=await Se(t);J.value=O+c,i.value.topCover=c,(d=N.value)==null||d.validateFields(["topCover"]),r.success("é¡¶éƒ¨èƒŒæ™¯å›¾ä¸Šä¼ æˆåŠŸ")}catch{r.error("é¡¶éƒ¨èƒŒæ™¯å›¾ä¸Šä¼ å¤±è´¥")}finally{$.value=!1}return!1},De=async t=>{var d;if(!(t.size/1024/1024<12))return r.error("å›¾ç‰‡å¤§å°ä¸èƒ½è¶…è¿‡ 12MB!"),!1;if(!(t.type==="image/jpeg"||t.type==="image/png"))return r.error("åªèƒ½ä¸Šä¼  JPG/PNG æ ¼å¼çš„å›¾ç‰‡!"),!1;try{B.value=!0;const c=await Se(t);z.value=O+c,i.value.cover=c,(d=N.value)==null||d.validateFields(["cover"]),r.success("å°é¢å›¾ä¸Šä¼ æˆåŠŸ")}catch{r.error("å°é¢å›¾ä¸Šä¼ å¤±è´¥")}finally{B.value=!1}return!1};he(()=>i.value.environment,t=>{console.log("formData.environment å˜åŒ–:",t,"å½“å‰ selectedEnvironment:",k.value),t&&String(t)!==k.value&&(k.value=String(t),h.value.dockerImage=String(t),console.log("å·²åŒæ­¥åˆ°ç¬¬å››æ­¥:",k.value))}),he(()=>k.value,t=>{console.log("selectedEnvironment å˜åŒ–ä¸º:",t)});const T=()=>{ke(()=>{window.scrollTo({top:0,behavior:"smooth"}),document.documentElement.scrollTop=0,document.body.scrollTop=0;const t=document.querySelector(".page-content");t&&(t.scrollTop=0);const e=document.querySelector(".ant-layout-content");e&&(e.scrollTop=0),document.querySelectorAll("*").forEach(d=>{d.scrollTop>0&&(d.scrollTop=0)})})},Ee=async()=>{w.value>0?(w.value--,T(),w.value===1&&y.value&&await pe()):D.back()},Ne=async()=>{var t,e;if(w.value===0)try{await Promise.all([(t=N.value)==null?void 0:t.validate(),(e=ne.value)==null?void 0:e.validate()]),await ce(!1),w.value=1,T(),y.value&&await pe()}catch{r.error("è¯·å®Œå–„å¿…å¡«ä¿¡æ¯"),T()}else if(w.value===1)y.value&&await Be(),w.value=2,T();else if(w.value===2)try{if(!y.value){r.error("ä»»åŠ¡IDä¸å­˜åœ¨ï¼Œè¯·é‡æ–°åˆ›å»ºä»»åŠ¡");return}if(s.value.openTestValidate===1){if(!s.value.timeLimitM){r.error("è¯·è¾“å…¥è¯„æµ‹æ—¶é•¿é™åˆ¶"),T();return}if(!s.value.classHour||s.value.classHour<=0){r.error("è¯·è¾“å…¥æœ‰æ•ˆçš„å­¦æ—¶"),T();return}if(!s.value.testSets||s.value.testSets.length===0){r.error("è¯·è‡³å°‘æ·»åŠ ä¸€ä¸ªæµ‹è¯•é›†"),T();return}const v=s.value.testSets.filter(A=>A.select===1);if(v.length===0){r.error("è¯·è‡³å°‘é€‰ä¸­ä¸€ä¸ªæµ‹è¯•é›†"),T();return}for(let A=0;A<v.length;A++){const P=v[A];if(!P.answer||P.answer.trim()===""){r.error(`æµ‹è¯•é›†${A+1}çš„æœŸæœ›è¾“å‡ºä¸èƒ½ä¸ºç©º`),T();return}}}if(!m.value.referenceAnswer||m.value.referenceAnswer.trim()===""){r.error("è¯·è¾“å…¥å‚è€ƒç­”æ¡ˆå†…å®¹"),T();return}if(!m.value.referenceAnswer.replace(/<[^>]*>/g,"").trim()){r.error("è¯·è¾“å…¥å‚è€ƒç­”æ¡ˆå†…å®¹"),T();return}const d=s.value.testSets.map(v=>({answer:v.answer,select:v.select})),c={taskId:y.value,projectId:C.value,openTestValidate:s.value.openTestValidate,testValidateFiles:s.value.testValidateFiles,testValidateSh:s.value.testValidateSh,timeLimitM:s.value.timeLimitM,classHour:s.value.classHour,scoreRule:s.value.scoreRule,evaluationSetting:s.value.evaluationSetting,testContent:JSON.stringify(d),showAnswer:m.value.showAnswer,prohibitCopyAnswer:m.value.prohibitCopyAnswer,referenceAnswer:m.value.referenceAnswer};console.log("ä¸‹ä¸€æ­¥æ—¶ä¿å­˜è¯„æµ‹è®¾ç½®å’Œå‚è€ƒç­”æ¡ˆæ•°æ®ï¼š",c),await X(c),M.value=!0,H.value=!0,w.value=3,T()}catch(u){console.error("ä¿å­˜æ•°æ®å¤±è´¥ï¼š",u),r.error("ä¿å­˜æ•°æ®å¤±è´¥ï¼Œè¯·é‡è¯•"),T()}else w.value===3&&await $e()},ce=async(t=!1)=>{try{j.value=!0;const e={id:C.value,projectType:3,environment:i.value.environment,name:i.value.name,tag:i.value.tag,fieldType:i.value.fieldType,difficulty:i.value.difficulty,classHour:i.value.classHour,topCover:i.value.topCover,cover:i.value.cover,description:i.value.description,showTaskRequire:i.value.showTaskRequire?1:2,authType:i.value.authType,enableCodeRepository:i.value.enableCodeRepository,secondType:i.value.secondType};t&&(e.status=10),i.value.enableCodeRepository&&(e.repositoryType=i.value.repositoryType,e.gitUrl=i.value.gitUrl),await at(e),t?(r.success("é¡¹ç›®æ›´æ–°æˆåŠŸï¼"),setTimeout(()=>{D.push("/dashboard/analysis")},500)):r.success("ä¿å­˜æˆåŠŸï¼")}catch(e){throw console.error("æ›´æ–°å¤±è´¥ï¼š",e),r.error(e.message||"é¡¹ç›®æ›´æ–°å¤±è´¥ï¼Œè¯·ç¨åé‡è¯•"),e}finally{j.value=!1}},Je=async()=>{try{if(!y.value){r.error("ä»»åŠ¡IDä¸å­˜åœ¨ï¼Œè¯·é‡æ–°åˆ›å»ºä»»åŠ¡");return}if(s.value.openTestValidate===1){if(!s.value.timeLimitM){r.error("è¯·è¾“å…¥è¯„æµ‹æ—¶é•¿é™åˆ¶");return}if(!s.value.classHour||s.value.classHour<=0){r.error("è¯·è¾“å…¥æœ‰æ•ˆçš„å­¦æ—¶");return}if(!s.value.testSets||s.value.testSets.length===0){r.error("è¯·è‡³å°‘æ·»åŠ ä¸€ä¸ªæµ‹è¯•é›†");return}const d=s.value.testSets.filter(c=>c.select===1);if(d.length===0){r.error("è¯·è‡³å°‘é€‰ä¸­ä¸€ä¸ªæµ‹è¯•é›†");return}for(let c=0;c<d.length;c++){const v=d[c];if(!v.answer||v.answer.trim()===""){r.error(`æµ‹è¯•é›†${c+1}çš„æœŸæœ›è¾“å‡ºä¸èƒ½ä¸ºç©º`);return}}}if(!m.value.referenceAnswer||m.value.referenceAnswer.trim()===""){r.error("è¯·è¾“å…¥å‚è€ƒç­”æ¡ˆå†…å®¹");return}if(!m.value.referenceAnswer.replace(/<[^>]*>/g,"").trim()){r.error("è¯·è¾“å…¥å‚è€ƒç­”æ¡ˆå†…å®¹");return}const e=s.value.testSets.map(d=>({answer:d.answer,select:d.select})),u={taskId:y.value,projectId:C.value,openTestValidate:s.value.openTestValidate,testValidateFiles:s.value.testValidateFiles,testValidateSh:s.value.testValidateSh,timeLimitM:s.value.timeLimitM,classHour:s.value.classHour,scoreRule:s.value.scoreRule,evaluationSetting:s.value.evaluationSetting,testContent:JSON.stringify(e),showAnswer:m.value.showAnswer,prohibitCopyAnswer:m.value.prohibitCopyAnswer,referenceAnswer:m.value.referenceAnswer};console.log("ä¿å­˜è¯„æµ‹è®¾ç½®å’Œå‚è€ƒç­”æ¡ˆæ•°æ®ï¼š",u),await X(u),M.value=!0,H.value=!0,r.success("è¯„æµ‹è®¾ç½®å’Œå‚è€ƒç­”æ¡ˆä¿å­˜æˆåŠŸï¼")}catch(t){console.error("è¯„æµ‹è®¾ç½®å’Œå‚è€ƒç­”æ¡ˆä¿å­˜å¤±è´¥ï¼š",t),r.error("è¯„æµ‹è®¾ç½®å’Œå‚è€ƒç­”æ¡ˆä¿å­˜å¤±è´¥ï¼Œè¯·é‡è¯•")}},ze=async()=>{try{if(!y.value){r.error("ä»»åŠ¡IDä¸å­˜åœ¨ï¼Œè¯·é‡æ–°åˆ›å»ºä»»åŠ¡");return}if(s.value.openTestValidate===1){if(!s.value.timeLimitM){r.error("è¯·è¾“å…¥è¯„æµ‹æ—¶é•¿é™åˆ¶");return}if(!s.value.classHour||s.value.classHour<=0){r.error("è¯·è¾“å…¥æœ‰æ•ˆçš„å­¦æ—¶");return}if(!s.value.testSets||s.value.testSets.length===0){r.error("è¯·è‡³å°‘æ·»åŠ ä¸€ä¸ªæµ‹è¯•é›†");return}const d=s.value.testSets.filter(c=>c.select===1);if(d.length===0){r.error("è¯·è‡³å°‘é€‰ä¸­ä¸€ä¸ªæµ‹è¯•é›†");return}for(let c=0;c<d.length;c++){const v=d[c];if(!v.answer||v.answer.trim()===""){r.error(`æµ‹è¯•é›†${c+1}çš„æœŸæœ›è¾“å‡ºä¸èƒ½ä¸ºç©º`);return}}}if(!m.value.referenceAnswer||m.value.referenceAnswer.trim()===""){r.error("è¯·è¾“å…¥å‚è€ƒç­”æ¡ˆå†…å®¹");return}if(!m.value.referenceAnswer.replace(/<[^>]*>/g,"").trim()){r.error("è¯·è¾“å…¥å‚è€ƒç­”æ¡ˆå†…å®¹");return}const e=s.value.testSets.map(d=>({answer:d.answer,select:d.select})),u={taskId:y.value,projectId:C.value,openTestValidate:s.value.openTestValidate,testValidateFiles:s.value.testValidateFiles,testValidateSh:s.value.testValidateSh,timeLimitM:s.value.timeLimitM,classHour:s.value.classHour,scoreRule:s.value.scoreRule,evaluationSetting:s.value.evaluationSetting,testContent:JSON.stringify(e),showAnswer:m.value.showAnswer,prohibitCopyAnswer:m.value.prohibitCopyAnswer,referenceAnswer:m.value.referenceAnswer};console.log("ä¿å­˜è¯„æµ‹è®¾ç½®å’Œå‚è€ƒç­”æ¡ˆæ•°æ®ï¼š",u),await X(u),M.value=!0,H.value=!0,r.success("è¯„æµ‹è®¾ç½®å’Œå‚è€ƒç­”æ¡ˆä¿å­˜æˆåŠŸï¼")}catch(t){console.error("è¯„æµ‹è®¾ç½®å’Œå‚è€ƒç­”æ¡ˆä¿å­˜å¤±è´¥ï¼š",t),r.error("è¯„æµ‹è®¾ç½®å’Œå‚è€ƒç­”æ¡ˆä¿å­˜å¤±è´¥ï¼Œè¯·é‡è¯•")}},$e=async()=>{try{if(!C.value||!y.value){r.error("é¡¹ç›®IDæˆ–ä»»åŠ¡IDä¸å­˜åœ¨");return}if(!M.value){r.error("è¯·å…ˆä¿å­˜è¯„æµ‹è®¾ç½®åå†å®Œæˆæ›´æ–°");return}if(!H.value){r.error("è¯·å…ˆä¿å­˜å‚è€ƒç­”æ¡ˆåå†å®Œæˆæ›´æ–°");return}if(!h.value.dockerImage){r.error("è¯·é€‰æ‹©å®éªŒç¯å¢ƒ");return}if(!h.value.timeLimitM){r.error("è¯·è¾“å…¥å®éªŒç¯å¢ƒä½¿ç”¨æ—¶é•¿");return}await X({taskId:y.value,projectId:C.value,dockerImage:h.value.dockerImage,secondType:h.value.secondType,timeLimitM:h.value.timeLimitM}),await ce(!0)}catch(t){console.error("å®Œæˆæ›´æ–°å¤±è´¥ï¼š",t),r.error("å®Œæˆæ›´æ–°å¤±è´¥ï¼Œè¯·é‡è¯•")}},pe=async()=>{if(!y.value){console.log("taskIdä¸å­˜åœ¨ï¼Œæ— æ³•è·å–Podé…ç½®");return}try{ee.value=!0,console.log("æ­£åœ¨è·å–Podé…ç½®ï¼ŒtaskId:",y.value);const t=await lt({taskId:y.value});console.log("è·å–åˆ°Podæ•°æ®ï¼š",t),t&&t.config&&t.config.url?(Z.value=t.config.url,console.log("æ›´æ–°Jupyter URLä¸ºï¼š",Z.value),r.success("å®éªŒç¯å¢ƒåŠ è½½æˆåŠŸï¼")):(console.error("Podé…ç½®ä¸­æ²¡æœ‰urlå­—æ®µ"),r.warning("æœªè·å–åˆ°å®éªŒç¯å¢ƒURL"))}catch(t){console.error("è·å–Podé…ç½®å¤±è´¥ï¼š",t),r.error("è·å–å®éªŒç¯å¢ƒå¤±è´¥ï¼Œè¯·ç¨åé‡è¯•")}finally{ee.value=!1}},Be=async()=>{if(!y.value){console.log("taskIdä¸å­˜åœ¨ï¼Œæ— æ³•åœæ­¢Pod");return}try{console.log("æ­£åœ¨åœæ­¢Podï¼ŒtaskId:",y.value),await st({taskId:y.value}),console.log("Podåœæ­¢æˆåŠŸ"),r.success("å®éªŒç¯å¢ƒå·²åœæ­¢")}catch(t){console.error("åœæ­¢Podå¤±è´¥ï¼š",t),r.error("åœæ­¢å®éªŒç¯å¢ƒå¤±è´¥ï¼Œè¯·ç¨åé‡è¯•")}};return Xe(async()=>{te.load(),ue.load(),ae.load();const t=Ce.query.id;t?(C.value=Number(t),await xe(),await He()):(r.error("ç¼ºå°‘é¡¹ç›®ID"),D.back())}),(t,e)=>{const u=_t,d=gt,c=ht,v=wt,A=kt,P=Tt,fe=bt,b=Ct,R=St,K=At,U=Lt,me=xt,ge=Ut,E=yt,Oe=Vt,_e=It,Ge=qt,ye=jt,Ke=Rt;return g(),_("div",Pt,[e[50]||(e[50]=n("div",{class:"page-header"},[n("h2",null,"ç¼–è¾‘JupyterLabç¯å¢ƒå®è®­é¡¹ç›®")],-1)),a(_e,{spinning:j.value},{default:l(()=>[n("div",Ft,[n("div",Dt,[a(d,{current:w.value,class:"custom-steps"},{default:l(()=>[(g(),_(x,null,W(Le,(o,Y)=>a(u,{key:Y,title:o.title},null,8,["title"])),64))]),_:1},8,["current"])]),w.value===0?(g(),_("div",Et,[e[29]||(e[29]=n("div",{class:"section-title"},[n("h3",null,"åŸºæœ¬ä¿¡æ¯")],-1)),n("div",Nt,[a(E,{ref_key:"formRef",ref:N,model:i.value,rules:ie,layout:"horizontal","label-col":{span:2},"wrapper-col":{span:18}},{default:l(()=>[a(v,{label:"åç§°",name:"name",required:""},{default:l(()=>[a(c,{value:i.value.name,"onUpdate:value":e[0]||(e[0]=o=>i.value.name=o),placeholder:"è¯·è¾“å…¥åç§°"},null,8,["value"])]),_:1}),a(fe,null,{default:l(()=>[a(A,{span:12},{default:l(()=>[a(v,{label:"æŠ€èƒ½æ ‡ç­¾",name:"tag",required:"","label-col":{span:4},"wrapper-col":{span:20}},{default:l(()=>[a(c,{value:i.value.tag,"onUpdate:value":e[1]||(e[1]=o=>i.value.tag=o),placeholder:"è¯·è¾“å…¥æŠ€èƒ½æ ‡ç­¾"},null,8,["value"])]),_:1})]),_:1}),a(A,{span:12},{default:l(()=>[a(v,{label:"é¢†åŸŸç±»åˆ«",name:"fieldType",required:"","label-col":{span:4},"wrapper-col":{span:12}},{default:l(()=>[a(P,{value:i.value.fieldType,"onUpdate:value":e[2]||(e[2]=o=>i.value.fieldType=o),placeholder:"è¯·é€‰æ‹©é¢†åŸŸç±»åˆ«",options:F(te).options.value,loading:F(te).loading.value},null,8,["value","options","loading"])]),_:1})]),_:1})]),_:1}),a(v,{label:"éš¾åº¦",name:"difficulty",required:""},{default:l(()=>[a(R,{value:i.value.difficulty,"onUpdate:value":e[3]||(e[3]=o=>i.value.difficulty=o),class:"custom-radio"},{default:l(()=>[(g(!0),_(x,null,W(F(ue).data.value,o=>(g(),Ze(b,{key:o.value,value:Number(o.value)},{default:l(()=>[f(L(o.name),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value"])]),_:1}),a(fe,null,{default:l(()=>[a(A,{span:12},{default:l(()=>[a(v,{label:"å®éªŒç¯å¢ƒ",name:"environment",required:"","label-col":{span:4},"wrapper-col":{span:20}},{default:l(()=>[a(P,{value:i.value.environment,"onUpdate:value":e[4]||(e[4]=o=>i.value.environment=o),placeholder:"è¯·é€‰æ‹©å®éªŒç¯å¢ƒ",options:S.value,loading:le.value},null,8,["value","options","loading"])]),_:1})]),_:1})]),_:1}),a(v,{label:"å­¦æ—¶",name:"classHour"},{default:l(()=>[a(K,{min:0,disabled:"",class:"w-full",value:i.value.classHour,"onUpdate:value":e[5]||(e[5]=o=>i.value.classHour=o),placeholder:"é…ç½®ä»»åŠ¡åè‡ªåŠ¨è®¡ç®—å­¦æ—¶"},null,8,["value"])]),_:1}),a(v,{label:"é¡¶éƒ¨èƒŒæ™¯å›¾",name:"topCover",required:""},{default:l(()=>[n("div",Jt,[n("div",zt,[a(me,{"before-upload":Fe,"show-upload-list":!1,accept:"image/png,image/jpeg"},{default:l(()=>[a(U,{loading:$.value},{default:l(()=>[$.value?(g(),_(x,{key:1},[f("ä¸Šä¼ ä¸­...")],64)):(g(),_(x,{key:0},[f("é€‰æ‹©æ–‡ä»¶")],64))]),_:1},8,["loading"])]),_:1}),J.value?(g(),_("div",$t,[n("img",{src:J.value,alt:"é¡¶éƒ¨èƒŒæ™¯å›¾é¢„è§ˆ",style:{"max-width":"290px","max-height":"218px","border-radius":"4px"}},null,8,Bt)])):V("",!0)]),e[22]||(e[22]=n("div",{class:"upload-hint"}," è¯´æ˜ï¼šæ”¯æŒä¸Šä¼ png/jpegç­‰æ ¼å¼æ–‡ä»¶ï¼Œæ–‡ä»¶å¤§å°ä¸èƒ½è¶…è¿‡12M,å»ºè®®ä½¿ç”¨290*218åƒç´ ã€‚ ",-1))])]),_:1}),a(v,{label:"å°é¢å›¾",name:"cover",required:""},{default:l(()=>[n("div",Ot,[n("div",Gt,[a(me,{"before-upload":De,"show-upload-list":!1,accept:"image/png,image/jpeg"},{default:l(()=>[a(U,{loading:B.value},{default:l(()=>[B.value?(g(),_(x,{key:1},[f("ä¸Šä¼ ä¸­...")],64)):(g(),_(x,{key:0},[f("é€‰æ‹©æ–‡ä»¶")],64))]),_:1},8,["loading"])]),_:1}),z.value?(g(),_("div",Kt,[n("img",{src:z.value,alt:"å°é¢å›¾é¢„è§ˆ",style:{"max-width":"290px","max-height":"218px","border-radius":"4px"}},null,8,Yt)])):V("",!0)]),e[23]||(e[23]=n("div",{class:"upload-hint"}," è¯´æ˜ï¼šæ”¯æŒä¸Šä¼ png/jpegç­‰æ ¼å¼æ–‡ä»¶ï¼Œæ–‡ä»¶å¤§å°ä¸èƒ½è¶…è¿‡12M,å»ºè®®ä½¿ç”¨290*218åƒç´ ã€‚ ",-1))])]),_:1}),a(v,{label:"ç®€ä»‹",name:"description"},{default:l(()=>[a(Te,{modelValue:i.value.description,"onUpdate:modelValue":e[6]||(e[6]=o=>i.value.description=o)},null,8,["modelValue"])]),_:1}),a(v,{label:"ä»»åŠ¡è¦æ±‚",name:"showTaskRequire"},{default:l(()=>[a(ge,{checked:i.value.showTaskRequire,"onUpdate:checked":e[7]||(e[7]=o=>i.value.showTaskRequire=o)},{default:l(()=>e[24]||(e[24]=[f(" æ˜¾ç¤ºä»»åŠ¡è¦æ±‚ï¼ˆå‹¾é€‰åï¼Œå°†ä½œä¸ºä»»åŠ¡è¦æ±‚æ˜¾ç¤ºåœ¨ä»»åŠ¡é¡¹ç›®é‡Œï¼‰ ")])),_:1,__:[24]},8,["checked"])]),_:1})]),_:1},8,["model"])]),e[30]||(e[30]=n("div",{class:"section-title"},[n("h3",null,"åŸ¹è®­å…¬å¼€èŒƒå›´")],-1)),n("div",Qt,[a(E,{ref_key:"trainingScopeFormRef",ref:ne,model:i.value,rules:ie,layout:"horizontal","label-col":{span:2},"wrapper-col":{span:18}},{default:l(()=>[a(v,{label:"åŸ¹è®­å…¬å¼€èŒƒå›´",name:"authType",required:""},{default:l(()=>[a(R,{value:i.value.authType,"onUpdate:value":e[8]||(e[8]=o=>i.value.authType=o),class:"custom-radio"},{default:l(()=>[a(b,{value:1},{default:l(()=>e[25]||(e[25]=[f("å®Œå…¨å…¬å¼€")])),_:1,__:[25]}),a(b,{value:2},{default:l(()=>e[26]||(e[26]=[f("å…¨é™¢å…¬å¼€")])),_:1,__:[26]}),a(b,{value:3},{default:l(()=>e[27]||(e[27]=[f("æœ¬å•ä½å…¬å¼€")])),_:1,__:[27]}),a(b,{value:4},{default:l(()=>e[28]||(e[28]=[f("ä¸å…¬å¼€")])),_:1,__:[28]})]),_:1},8,["value"])]),_:1})]),_:1},8,["model"])])])):V("",!0),w.value===1?(g(),_("div",Wt,[n("div",{class:be(["jupyter-container",{fullscreen:q.value}])},[n("div",Xt,[e[31]||(e[31]=n("h3",null,"Jupyter Lab ç¼–è¾‘å™¨",-1)),n("div",Zt,[a(Oe,{title:q.value?"é€€å‡ºå…¨å±":"å…¨å±"},{default:l(()=>[a(U,{type:"text",icon:q.value?"fullscreen-exit":"fullscreen",onClick:Ae},{default:l(()=>[f(L(q.value?"é€€å‡ºå…¨å±":"å…¨å±"),1)]),_:1},8,["icon"])]),_:1},8,["title"])])]),n("div",ea,[ee.value?(g(),_("div",ta,[a(_e,{size:"large",tip:"æ­£åœ¨åŠ è½½å®éªŒç¯å¢ƒ..."})])):(g(),_("iframe",{key:1,src:Z.value,class:"jupyter-iframe",frameborder:"0",allowfullscreen:""},null,8,aa))])],2)])):V("",!0),w.value===2?(g(),_("div",la,[a(Ke,{activeKey:ve.value,"onUpdate:activeKey":e[17]||(e[17]=o=>ve.value=o),class:"evaluation-tabs"},{default:l(()=>[a(ye,{key:"settings",tab:"è¯„æµ‹è®¾ç½®"},{default:l(()=>[n("div",sa,[n("div",oa,[e[39]||(e[39]=n("div",{class:"block-header"},"è¯„æµ‹æ–‡ä»¶",-1)),n("div",ra,[a(E,{layout:"horizontal","label-col":{span:3},"wrapper-col":{span:20}},{default:l(()=>[a(v,{label:"æ˜¯å¦å¯ç”¨è¯„æµ‹åŠŸèƒ½",required:""},{default:l(()=>[a(R,{value:s.value.openTestValidate,"onUpdate:value":e[9]||(e[9]=o=>s.value.openTestValidate=o),class:"custom-radio"},{default:l(()=>[a(b,{value:1},{default:l(()=>e[32]||(e[32]=[f("æ˜¯")])),_:1,__:[32]}),a(b,{value:2},{default:l(()=>e[33]||(e[33]=[f("å¦")])),_:1,__:[33]})]),_:1},8,["value"])]),_:1}),s.value.openTestValidate===1?(g(),_(x,{key:0},[a(v,{label:"è¯„æµ‹æ—¶é•¿é™åˆ¶",required:""},{default:l(()=>[n("div",na,[a(K,{value:s.value.timeLimitM,"onUpdate:value":e[10]||(e[10]=o=>s.value.timeLimitM=o),min:1,placeholder:"è¯·è¾“å…¥è¯„æµ‹æ—¶é•¿ï¼ˆåˆ†é’Ÿï¼‰",style:{width:"580px"}},null,8,["value"]),e[34]||(e[34]=n("span",null,"åˆ†é’Ÿ",-1))])]),_:1}),a(v,{label:"å­¦æ—¶",required:""},{default:l(()=>[a(K,{value:s.value.classHour,"onUpdate:value":e[11]||(e[11]=o=>s.value.classHour=o),min:0,placeholder:"è¯·è¾“å…¥å­¦æ—¶",style:{width:"600px"}},null,8,["value"])]),_:1}),a(v,{label:"ç³»ç»Ÿè¯„åˆ†è§„åˆ™"},{default:l(()=>[a(R,{value:s.value.scoreRule,"onUpdate:value":e[12]||(e[12]=o=>s.value.scoreRule=o),class:"custom-radio"},{default:l(()=>[a(b,{value:1},{default:l(()=>e[35]||(e[35]=[f(" é€šè¿‡å…¨éƒ¨æµ‹è¯•é›†ï¼ˆä»…å½“æ‰€æœ‰æµ‹è¯•é›†éƒ½æ­£ç¡®æ—¶ï¼Œè·å¾—é¡¹ç›®å­¦æ—¶ï¼‰ ")])),_:1,__:[35]}),a(b,{value:2},{default:l(()=>e[36]||(e[36]=[f(" é€šè¿‡éƒ¨åˆ†æµ‹è¯•é›†ï¼ˆä»»æ„ä¸€ä¸ªæµ‹è¯•é›†æ­£ç¡®æ—¶ï¼Œè·å¾—é¡¹ç›®å­¦æ—¶ï¼‰ ")])),_:1,__:[36]})]),_:1},8,["value"])]),_:1}),a(v,{label:"è¯„æµ‹è®¾ç½®",required:""},{default:l(()=>[a(R,{value:s.value.evaluationSetting,"onUpdate:value":e[13]||(e[13]=o=>s.value.evaluationSetting=o),class:"custom-radio"},{default:l(()=>[a(b,{value:1},{default:l(()=>e[37]||(e[37]=[f(" é€šè¿‡æ‰€æœ‰ä»£ç å—è¯„æµ‹ï¼ˆå¯¹å­¦å‘˜ä»»åŠ¡æ–‡ä»¶çš„æ‰€æœ‰éç©ºä»£ç å—è¿›è¡Œè¯„æµ‹ï¼‰ ")])),_:1,__:[37]}),a(b,{value:2},{default:l(()=>e[38]||(e[38]=[f(" é€šè¿‡æŒ‡å®šä»£ç å—è¯„æµ‹ï¼ˆå¯¹å­¦å‘˜ä»»åŠ¡æ–‡ä»¶çš„æŒ‡å®šéç©ºä»£ç å—è¿›è¡Œè¯„æµ‹ï¼‰ ")])),_:1,__:[38]})]),_:1},8,["value"])]),_:1})],64)):V("",!0)]),_:1})])]),s.value.openTestValidate===1?(g(),_("div",ia,[n("div",ua,[e[41]||(e[41]=n("span",null,"æµ‹è¯•é›†",-1)),n("div",va,[a(U,{onClick:Ue},{default:l(()=>e[40]||(e[40]=[f("æ–°å¢æµ‹è¯•é›†")])),_:1,__:[40]})])]),n("div",da,[(g(!0),_(x,null,W(s.value.testSets,(o,Y)=>(g(),_("div",{key:o.id,class:"test-set-item"},[a(ge,{checked:o.select===1,onChange:Q=>Ie(o,Q.target.checked),class:"test-set-checkbox"},null,8,["checked","onChange"]),n("span",ca,"æµ‹è¯•é›†"+L(Y+1),1),a(Ge,{value:o.answer,"onUpdate:value":Q=>o.answer=Q,placeholder:"è¯·è¾“å…¥æœŸæœ›è¾“å‡º",class:"test-set-input","auto-size":{minRows:3}},null,8,["value","onUpdate:value"]),a(F(Mt),{class:"delete-test-set-icon",onClick:Q=>Ve(o.id)},null,8,["onClick"])]))),128))])])):V("",!0),n("div",pa,[a(U,{type:"primary",onClick:Je},{default:l(()=>[f(L(M.value?"æ›´æ–°":"ä¿å­˜"),1)]),_:1})])])]),_:1}),a(ye,{key:"reference",tab:"å‚è€ƒç­”æ¡ˆ"},{default:l(()=>[n("div",fa,[n("div",ma,[e[46]||(e[46]=n("div",{class:"block-header"},"å‚è€ƒç­”æ¡ˆ",-1)),n("div",ga,[a(E,{layout:"horizontal","label-col":{span:3},"wrapper-col":{span:20}},{default:l(()=>[a(v,{label:"æ˜¯å¦æ˜¾ç¤ºå‚è€ƒç­”æ¡ˆæ¨¡å—",required:""},{default:l(()=>[a(R,{value:m.value.showAnswer,"onUpdate:value":e[14]||(e[14]=o=>m.value.showAnswer=o),class:"custom-radio"},{default:l(()=>[a(b,{value:1},{default:l(()=>e[42]||(e[42]=[f("æ˜¯")])),_:1,__:[42]}),a(b,{value:2},{default:l(()=>e[43]||(e[43]=[f("å¦")])),_:1,__:[43]})]),_:1},8,["value"])]),_:1}),a(v,{label:"æ˜¯å¦ç¦æ­¢å¤åˆ¶å‚è€ƒç­”æ¡ˆ",required:""},{default:l(()=>[a(R,{value:m.value.prohibitCopyAnswer,"onUpdate:value":e[15]||(e[15]=o=>m.value.prohibitCopyAnswer=o),class:"custom-radio"},{default:l(()=>[a(b,{value:1},{default:l(()=>e[44]||(e[44]=[f("æ˜¯")])),_:1,__:[44]}),a(b,{value:2},{default:l(()=>e[45]||(e[45]=[f("å¦")])),_:1,__:[45]})]),_:1},8,["value"])]),_:1}),a(v,{label:"å‚è€ƒç­”æ¡ˆ",required:""},{default:l(()=>[a(Te,{modelValue:m.value.referenceAnswer,"onUpdate:modelValue":e[16]||(e[16]=o=>m.value.referenceAnswer=o)},null,8,["modelValue"])]),_:1})]),_:1})])]),n("div",_a,[a(U,{type:"primary",onClick:ze},{default:l(()=>[f(L(H.value?"æ›´æ–°":"ä¿å­˜"),1)]),_:1})])])]),_:1})]),_:1},8,["activeKey"])])):V("",!0),w.value===3?(g(),_("div",ya,[n("div",wa,[e[49]||(e[49]=n("h3",{class:"section-main-title"},"å®éªŒç¯å¢ƒ",-1)),n("div",ha,[n("div",ba,[n("div",ka,[a(c,{value:G.value,"onUpdate:value":e[18]||(e[18]=o=>G.value=o),placeholder:"æœç´¢éœ€è¦çš„å®éªŒç¯å¢ƒ","allow-clear":""},{suffix:l(()=>e[47]||(e[47]=[n("span",{class:"search-icon"},"ğŸ”",-1)])),_:1},8,["value"])]),n("div",Ta,[(g(!0),_(x,null,W(je.value,o=>(g(),_("div",{key:o.value,class:be(["environment-item",{active:k.value===o.value}]),onClick:Y=>Me(o.value)},L(o.label),11,Sa))),128))])]),n("div",Ca,[n("div",Aa," å®éªŒç¯å¢ƒ: "+L(qe.value),1),a(E,{model:h.value,layout:"horizontal","label-col":{span:6},"wrapper-col":{span:16}},{default:l(()=>[a(v,{label:"é™„å¸¦ç¯å¢ƒ"},{default:l(()=>[a(P,{value:h.value.secondType,"onUpdate:value":e[19]||(e[19]=o=>h.value.secondType=o),placeholder:"è¯·é€‰æ‹©é™„å¸¦ç¯å¢ƒ",options:F(ae).options.value,loading:F(ae).loading.value},null,8,["value","options","loading"])]),_:1}),a(v,{label:"å®éªŒç¯å¢ƒä½¿ç”¨æ—¶é•¿"},{default:l(()=>[n("div",xa,[a(K,{value:h.value.timeLimitM,"onUpdate:value":e[20]||(e[20]=o=>h.value.timeLimitM=o),min:1,placeholder:"è¯·è¾“å…¥å®éªŒç¯å¢ƒä½¿ç”¨æ—¶é•¿",style:{flex:"1"}},null,8,["value"]),e[48]||(e[48]=n("span",null,"åˆ†",-1))])]),_:1})]),_:1},8,["model"])])])])])):V("",!0),n("div",La,[a(U,{onClick:Ee},{default:l(()=>[f(L(w.value===0?"è¿”å›":"ä¸Šä¸€æ­¥"),1)]),_:1}),a(U,{type:"primary",loading:j.value,onClick:Ne},{default:l(()=>[f(L(w.value===3?"å®Œæˆ":"ä¸‹ä¸€æ­¥"),1)]),_:1},8,["loading"])])])]),_:1},8,["spinning"]),a(mt,{open:se.value,"onUpdate:open":e[21]||(e[21]=o=>se.value=o),title:"é€‰æ‹©è¯„æµ‹æ–‡ä»¶","git-url":i.value.gitUrl,onConfirm:Re},null,8,["open","git-url"])])}}}),Da=Ht(Ua,[["__scopeId","data-v-e9c3e981"]]);export{Da as default};
