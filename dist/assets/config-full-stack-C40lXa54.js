import{d as Rt,ak as Ft,f as y,o as It,c as Pt,w as St,_ as m,a1 as u,$ as n,k as a,ac as k,a7 as o,u as s,F as R,ag as S,a6 as h,G as v,a9 as U,H as nl,a2 as Lt,ae as Nt,ab as A,B as il,y as Fe}from"./vue-PnzzEkKE.js";import{u as Mt,a as Et,b as Vt,c as $t,R as Ie,d as rl,e as jt,s as Bt,f as At,g as ul,h as Ht}from"./RichTextEditor-WzL9jkMd.js";import{u as Dt,a as dl,c as Kt}from"./index-Bjm5j8hH.js";import{H as L,j as Qt,t as Ot,x as Pe,c as zt,a as Gt,m as Jt,u as Wt,F as Yt,b as Zt,R as Xt,N as ea,d as la,e as cl}from"./useFileTree-BSIqVJdR.js";import{u as ta,Q as aa}from"./useTaskLevel-C3cq3ZFd.js";import{Y as oa,Z as sa,z as na,I as ia,$ as ra,a0 as ua,a1 as da,a2 as ca,a3 as pa,a4 as va,H as fa,J as ga,K as ma,a5 as ya,a6 as pl,f as _a,e as ka,s as ha,a7 as ba,a8 as Ca,a9 as Ta,aa as vl,ab as re,ac as wa,T as Ua,ad as xa,D as qa,u as Ra,ae as p,M as Fa}from"./antd-Drh1eHWx.js";import{_ as Ia}from"./index-D7n1rqpJ.js";import"./dictionary-Bt2e5LnJ.js";const Pa={class:"config-full-stack-page"},Sa={class:"page-content"},La={class:"steps-container"},Na={key:0},Ma={class:"form-section"},Ea={class:"flex items-top gap-16px"},Va={class:"flex flex-col gap-12px"},$a={key:0,class:"image-preview"},ja=["src"],Ba={class:"flex items-top gap-16px"},Aa={class:"flex flex-col gap-12px"},Ha={key:0,class:"image-preview"},Da=["src"],Ka={style:{display:"flex","flex-direction":"column",gap:"8px"}},Qa={class:"form-section"},Oa={key:1},za={class:"form-section repository-section"},Ga={class:"repository-top-bar flex items-center gap-16px justify-between"},Ja={class:"repository-url-group"},Wa={class:"repository-main-area"},Ya={class:"repository-left"},Za={class:"repository-switch-box flex items-center justify-between"},Xa={class:"flex items-center gap-12px"},eo={key:1,class:"repository-tips"},lo={class:"repository-right"},to={key:1,class:"empty-area"},ao={key:2},oo={class:"task-level-section"},so={class:"task-level-header"},no={class:"header-buttons"},io={class:"task-level-main"},ro={class:"task-level-list"},uo={class:"list-title"},co={class:"list-items"},po=["onClick"],vo={class:"item-name"},fo={class:"task-level-detail"},go={key:0,class:"detail-content"},mo={key:0,class:"questions-content"},yo={key:1,class:"questions-list"},_o=["onDragstart","onDrop"],ko={class:"question-header"},ho={class:"question-number-with-drag"},bo={class:"question-number"},Co={class:"action-icons"},To={class:"question-title"},wo={key:0,class:"flex"},Uo=["innerHTML"],xo={key:1,style:{color:"#bfbfbf"}},qo={class:"question-options"},Ro={class:"option-label"},Fo={class:"option-content"},Io={key:0,class:"correct-tag"},Po={class:"question-explanation"},So={class:"explanation-content"},Lo={key:0},No={key:1,style:{color:"#bfbfbf"}},Mo={class:"evaluation-content"},Eo={class:"evaluation-section"},Vo={class:"file-select-wrapper"},$o={class:"selected-files-list"},jo={class:"file-select-wrapper"},Bo={class:"selected-files-list"},Ao={class:"evaluation-section"},Ho={class:"evaluation-section"},Do={class:"case-type-row"},Ko={key:0,class:"test-case-buttons"},Qo={key:0,class:"test-cases-list"},Oo={class:"test-case-label"},zo={key:0,class:"form-footer-buttons"},Go={key:1,class:"empty-detail"},Jo={key:3,class:"step-content"},Wo={class:"content-card"},Yo={class:"environment-header"},Zo={class:"environment-actions"},Xo={class:"tab-label"},es=["onDblclick"],ls={class:"experiment-image-info"},ts={class:"experiment-interfaces"},as={key:0,style:{color:"#999"}},os={key:1,style:{color:"#999"}},ss={class:"page-footer"},fl="http://101.200.13.193",ns=Rt({name:"ConfigFullStack",__name:"config-full-stack",setup(is){L.registerLanguage("javascript",Qt),L.registerLanguage("typescript",Ot),L.registerLanguage("xml",Pe),L.registerLanguage("html",Pe),L.registerLanguage("vue",Pe),L.registerLanguage("css",zt),L.registerLanguage("json",Gt),L.registerLanguage("markdown",Jt);const Se=Ft(),q=y(0),P=y(null),W=y(),Le=y(),Y=y(),i=y({name:"",tag:"",fieldType:void 0,difficulty:1,classHour:"",topCover:"",cover:"",description:"",showTaskRequire:!1,authType:1,enableCodeRepository:!1,repositoryType:"代码仓库",gitUrl:"",environment:void 0}),ue=y(""),de=y(""),Z=y(!1),X=y(!1),N=y(void 0),gl=()=>({1:"Python3.6",2:"Python3.13",3:"Python3.12/VNC"})[N.value||1]||"Python3.6";It(()=>{var e;ce.load(),pe.load(),ve.load(),fe.load();const l=history.state;console.log("接收到的路由数据:",l),l&&l.name?(i.value.name=l.name||"",i.value.description=l.description||"",i.value.difficulty=l.difficulty||1,i.value.classHour=l.classHour||"",i.value.showTaskRequire=l.showTaskRequire||!1,N.value=l.environment||1,console.log("已自动填充表单数据:",{name:i.value.name,description:i.value.description,descriptionLength:((e=i.value.description)==null?void 0:e.length)||0,difficulty:i.value.difficulty,classHour:i.value.classHour,showTaskRequire:i.value.showTaskRequire,environment:N.value})):(console.log("未接收到路由数据"),N.value=1),yl()});const Ne={name:[{required:!0,message:"请输入名称",trigger:"blur"}],tag:[{required:!0,message:"请输入技能标签",trigger:"blur"}],fieldType:[{required:!0,message:"请选择领域类别",trigger:"change"}],difficulty:[{required:!0,message:"请选择难度",trigger:"change"}],topCover:[{required:!0,message:"请上传顶部背景图",trigger:"change"}],cover:[{required:!0,message:"请上传封面图",trigger:"change"}],authType:[{required:!0,message:"请选择培训公开范围",trigger:"change"}]},ce=Mt(),pe=Et(),ve=Vt(),fe=$t(),ml=[{label:"切换仓库",value:"切换仓库"},{label:"代码仓库",value:"代码仓库"},{label:"私密代码仓库",value:"私密代码仓库"}],H=y(!1),ge=y(new Set),F=y([]),yl=()=>{F.value.length===0&&(F.value=[{id:"1",name:"实验环境1",isEditing:!1,isSaved:!1,config:{dockerImage:N.value||1,viewTypes:[],secondType:void 0,taskId:void 0,codeType:void 0,shellBegin:void 0,containerPort:void 0,containerPath:void 0}}])},j=y("1"),D=y(""),_l={dockerImage:[{required:!0,message:"请选择实验镜像",trigger:"change"}],viewTypes:[{required:!0,type:"array",min:1,message:"请至少选择一个实验界面",trigger:"change"}],secondType:[{required:!0,message:"请选择附带环境",trigger:"change"}],taskId:[{required:!0,message:"请选择任务关卡",trigger:"change"}],codeType:[{required:!0,message:"请选择编程语言",trigger:"change"}],shellBegin:[{required:!0,message:"请输入开启时触发命令",trigger:"blur"}],containerPort:[{required:!0,message:"请输入容器端口",trigger:"blur"}]},Me=Pt(()=>{var e;const l=F.value.find(d=>d.id===j.value);return(l==null?void 0:l.config)||((e=F.value[0])==null?void 0:e.config)}),{fileTreeData:Ee,expandedKeys:me,selectedFile:kl,highlightedCode:hl,dynamicFileContents:bl,handleSelectFile:Cl,getNodePath:Ve,addFileToTree:$e,addFolderToTree:Tl,handleRenameNode:wl,handleCopyPath:Ul,loadRemoteFileTree:xl,loadChildrenData:ql,getNodePathFromMap:ye}=Wt(),{taskLevels:M,selectedTaskLevelId:je,currentTab:B,taskLevelFormRef:_e,evaluationFormRef:Rl,taskLevelFormData:_,evaluationFormData:C,learningResourceFileList:ke,taskLevelFormRules:Fl,evaluationFormRules:Il,isKernelTask:Pl,isChoiceTask:he,isProgrammingTask:Be,addTaskLevel:be,deleteTaskLevel:Sl,selectTaskLevel:Ce,saveTaskLevel:Ll,resetTaskLevel:Nl,handleLearningResourceCustomRequest:Ml,handleLearningResourceUpload:El,handleUserFilesSelect:Vl,handleTestValidateFilesSelect:$l,userFileList:ee,testValidateFileList:le,addTestCase:jl,removeTestCase:Bl,clearAllTestCases:Al,downloadTemplate:Hl,batchUploadTestCases:Dl,getCurrentQuestions:te,addQuestion:Kl,deleteQuestion:Ql,updateQuestion:Ol,updateQuestionsOrder:zl,loadQuestions:Ae,saveQuestionsOrder:Gl}=ta(P),K=y(!1),ae=y(!1),oe=y(!1),se=y(!1),Te=y(!1),we=y(!1),Q=y(null),O=y("/"),z=y("/"),He=y(null),ne=y("/"),Jl=async l=>{var g;if(!(l.size/1024/1024<12))return p.error("图片大小不能超过 12MB!"),!1;if(!(l.type==="image/jpeg"||l.type==="image/png"))return p.error("只能上传 JPG/PNG 格式的图片!"),!1;try{Z.value=!0;const c=await rl(l);ue.value=fl+c,i.value.topCover=c,(g=W.value)==null||g.validateFields(["topCover"]),p.success("顶部背景图上传成功")}catch{p.error("顶部背景图上传失败")}finally{Z.value=!1}return!1},Wl=async l=>{var g;if(!(l.size/1024/1024<12))return p.error("图片大小不能超过 12MB!"),!1;if(!(l.type==="image/jpeg"||l.type==="image/png"))return p.error("只能上传 JPG/PNG 格式的图片!"),!1;try{X.value=!0;const c=await rl(l);de.value=fl+c,i.value.cover=c,(g=W.value)==null||g.validateFields(["cover"]),p.success("封面图上传成功")}catch{p.error("封面图上传失败")}finally{X.value=!1}return!1},Yl=l=>{(typeof l=="boolean"?l:!!l)?K.value=!0:i.value.enableCodeRepository=!1},De=async()=>{try{const l=p.loading("正在查询仓库文件...",0),e=await ul(i.value.gitUrl,"");xl(e),ge.value.clear(),l(),p.success("仓库文件查询成功"),console.log("查询仓库地址：",i.value.gitUrl),console.log("获取到的文件列表：",e)}catch(l){p.error(l.message||"仓库文件查询失败"),console.error("仓库文件查询失败：",l)}},Zl=async(l,e)=>{const{expanded:d,node:g}=e;if(d&&!g.isLeaf){const c=String(g.key);if(ge.value.has(c)){console.log("文件夹已加载，跳过：",c);return}try{const r=ye(c);console.log("加载文件夹：",r,"节点key:",c);const T=p.loading(`正在加载 ${g.title}...`,0),I=await ul(i.value.gitUrl,r);ql(c,I),ge.value.add(c),T(),console.log("文件夹加载成功：",r,I)}catch(r){p.error(r.message||"加载文件夹失败"),console.error("加载文件夹失败：",r)}}},Xl=async()=>{if(!i.value.gitUrl||!i.value.gitUrl.trim()){p.error("请先配置仓库地址"),Ke();return}i.value.enableCodeRepository=!0,K.value=!1,H.value=!0,await De()},Ke=()=>{i.value.enableCodeRepository=!1,K.value=!1};St(()=>i.value.repositoryType,l=>{l==="切换仓库"&&i.value.enableCodeRepository&&(H.value=!1,p.info("已解锁仓库地址，请重新输入"),Fe(()=>{i.value.repositoryType="代码仓库"}))});const et=()=>{var l;i.value.enableCodeRepository&&!H.value&&((l=i.value.gitUrl)!=null&&l.trim())&&(H.value=!0,De())},lt=l=>{switch(String(l.key)){case"newFile":Oe();break;case"newFolder":ze();break;case"upload":Qe("/");break}},tt=(l,e)=>{const d=String(l.key),g=ye(e.key)||Ve(e.key);switch(d){case"newFile":Oe(g);break;case"newFolder":ze(g);break;case"upload":Qe(g);break;case"rename":wl(e);break;case"copyPath":Ul(e);break;case"delete":ot(e);break}},at=l=>{const e=d=>{const g=d.findIndex(c=>c.key===l);if(g!==-1)return d.splice(g,1),!0;for(const c of d)if(c.children&&e(c.children))return!0;return!1};e(Ee.value)},ot=async l=>{const e=l.children!==void 0||l.isLeaf===!1,d=l.title,c=(ye(l.key)||Ve(l.key)).split("/");c.pop();const r=c.join("/")||"";Fa.confirm({title:"确认删除",content:`确定要删除${e?"文件夹":"文件"} "${d}" 吗？${e?"文件夹下的所有内容也会被删除。":""}`,okText:"确定",cancelText:"取消",okType:"danger",onOk:async()=>{let T=null;try{T=p.loading("正在删除...",0),await Ht({fileName:d,gitUrl:i.value.gitUrl,path:r}),at(l.key),T(),p.success("删除成功"),console.log("删除成功：",{fileName:d,path:r})}catch(I){T&&T(),p.error(I.message||"删除失败"),console.error("删除失败：",I)}}})},Qe=l=>{var e;ne.value=l,(e=He.value)==null||e.click()},st=async l=>{var g;const e=l.target,d=(g=e.files)==null?void 0:g[0];if(d)try{let c=ne.value==="/"?"":ne.value.replace(/^\//,"");const r=p.loading(`正在上传 ${d.name}...`,0);await jt(d,i.value.gitUrl,c);const T=new FileReader;T.onload=I=>{var w;const qe=(w=I.target)==null?void 0:w.result;$e(d.name,qe,ne.value)},T.readAsText(d),r(),p.success(`文件 ${d.name} 上传成功`),console.log("文件上传成功：",{fileName:d.name,path:c})}catch(c){p.error(c.message||"文件上传失败"),console.error("文件上传失败：",c)}finally{e&&(e.value="")}},Oe=(l="/")=>{ae.value=!0,O.value=l},nt=async l=>{try{let e=O.value==="/"?"":O.value.replace(/^\//,"");const d=p.loading("正在保存文件...",0);await Bt({fileContent:l.fileContent,fileName:l.fileName,gitUrl:i.value.gitUrl,path:e,commit:l.commitMessage}),$e(l.fileName,l.fileContent,O.value),d(),p.success("文件创建成功"),ae.value=!1,console.log("文件保存成功：",{fileName:l.fileName,path:e})}catch(e){p.error(e.message||"文件创建失败"),console.error("文件创建失败：",e)}},ze=(l="/")=>{oe.value=!0,z.value=l},it=async l=>{try{let e=z.value==="/"?l.folderName:`${z.value.replace(/^\//,"")}/${l.folderName}`;const d=p.loading("正在创建文件夹...",0);await At({commit:l.commitMessage,gitUrl:i.value.gitUrl,path:e}),Tl(l.folderName,z.value),d(),p.success("文件夹创建成功"),oe.value=!1,console.log("文件夹创建成功：",{folderName:l.folderName,path:e})}catch(e){p.error(e.message||"文件夹创建失败"),console.error("文件夹创建失败：",e)}},G=()=>{Fe(()=>{window.scrollTo({top:0,behavior:"smooth"}),document.documentElement.scrollTop=0,document.body.scrollTop=0;const l=document.querySelector(".page-content");l&&(l.scrollTop=0);const e=document.querySelector(".ant-layout-content");e&&(e.scrollTop=0),document.querySelectorAll("*").forEach(g=>{g.scrollTop>0&&(g.scrollTop=0)})})},Ge=()=>{q.value>0?(q.value--,G()):Se.back()},rt=async()=>{var l,e;if(q.value===0)try{await Promise.all([(l=W.value)==null?void 0:l.validate(),(e=Le.value)==null?void 0:e.validate()]),console.log("表单数据：",i.value),q.value=1,G()}catch{p.error("请完善必填信息"),G()}else if(q.value===1){if(i.value.enableCodeRepository&&(!i.value.gitUrl||i.value.gitUrl.trim()==="")){p.error("请输入仓库地址");return}await ut()}else if(q.value===2){if(M.value.length===0){p.error("请至少添加一个任务关卡");return}if(M.value.some(r=>!r.taskId)){p.error("请先保存所有任务关卡后再进行下一步");return}const g=M.value.find(r=>r.type==="choice"&&r.taskId&&(!r.questions||r.questions.length===0));if(g){p.warning("请至少新增一条题目"),Ce(g.id),B.value="questions";return}const c=M.value.find(r=>r.type!=="programming"||!r.taskId||!r.evaluationSettings?!1:r.evaluationSettings.testValidateType===1?!r.evaluationSettings.testContent||r.evaluationSettings.testContent.length===0:!1);if(c){p.warning("用例类型为文本时，必须至少创建一条测试集"),Ce(c.id),B.value="evaluation";return}q.value=3,G()}},ut=async()=>{try{const l={projectType:1,environment:N.value,name:i.value.name,tag:i.value.tag,fieldType:i.value.fieldType,difficulty:i.value.difficulty,classHour:i.value.classHour,topCover:i.value.topCover,cover:i.value.cover,description:i.value.description,showTaskRequire:i.value.showTaskRequire?1:2,authType:i.value.authType,enableCodeRepository:i.value.enableCodeRepository};i.value.enableCodeRepository&&(l.repositoryType=i.value.repositoryType,l.gitUrl=i.value.gitUrl),console.log("提交项目数据：",l);let e;P.value?(l.id=P.value,e=await dl(l),p.success("项目更新成功！"),console.log("更新成功：",e)):(e=await Kt(l),e&&e.id&&(P.value=e.id,console.log("项目ID已保存：",P.value)),p.success("项目创建成功！"),console.log("创建成功：",e)),q.value=2,G()}catch(l){console.error("操作失败：",l),p.error(P.value?"项目更新失败，请稍后重试":"项目创建失败，请稍后重试")}},Ue=async(l,e=0)=>{var d,g;try{if(e!==1){const r=["dockerImage","viewTypes","secondType","taskId"],T=[];l.config.viewTypes.includes(1)?r.push("codeType"):T.push("codeType"),l.config.viewTypes.includes(2)?r.push("shellBegin"):T.push("shellBegin"),l.config.viewTypes.includes(3)?r.push("containerPort"):T.push("containerPort"),T.length>0&&((d=Y.value)==null||d.clearValidate(T)),await((g=Y.value)==null?void 0:g.validate(r))}if(!P.value){p.error("项目ID不存在，无法保存");return}const c={title:l.name,dockerImage:l.config.dockerImage,viewTypes:l.config.viewTypes.join(","),secondType:l.config.secondType,taskId:l.config.taskId?Number(l.config.taskId):void 0,codeType:l.config.codeType,shellBegin:l.config.shellBegin,containerPort:l.config.containerPort,containerPath:l.config.containerPath,projectId:P.value,envisDel:e};console.log("保存实验环境数据：",c),await Dt(c),e!==1?(l.isSaved=!0,p.success("实验环境保存成功！")):p.success("删除成功！")}catch(c){console.error("保存失败：",c),p.error(e===1?"删除失败":"请完善必填信息")}},dt=async()=>{if(F.value.filter(e=>!e.isSaved).length>0){p.error("请先保存实验环境配置");return}if(!P.value){p.error("项目ID不存在，请先创建项目");return}try{await dl({id:P.value,status:1}),p.success("项目创建成功！"),setTimeout(()=>{Se.push("/dashboard/analysis")},500)}catch(e){console.error("项目发布失败：",e),p.error(e.message||"项目发布失败")}},ct=l=>{var d;l.replace(/<[^>]*>/g,"").trim()&&((d=_e.value)==null||d.clearValidate(["require"]))},pt=l=>{var d;l.replace(/<[^>]*>/g,"").trim()&&((d=_e.value)==null||d.clearValidate(["referenceAnswer"]))},vt=()=>{Q.value=null,se.value=!0},ft=l=>{Q.value=l,se.value=!0},gt=async l=>{Q.value?Ol(l):Kl(l),Q.value=null,_.value.taskId&&await Ae(_.value.taskId)},mt=l=>{try{return JSON.parse(l.selects||"[]").map(d=>{const g=Object.keys(d)[0];return{label:g,content:d[g]}})}catch{return[]}},Je=(l,e)=>l.answer.includes(e),E=y(null),yt=l=>{E.value=l},_t=l=>{l.preventDefault()},kt=async(l,e)=>{if(l.preventDefault(),E.value!==null&&E.value!==e){const d=[...te.value],[g]=d.splice(E.value,1);d.splice(e,0,g),d.forEach((c,r)=>{c.weight=r+1}),zl(d);try{console.log("开始保存题目排序..."),await Gl(d),p.success("题目顺序已更新")}catch(c){console.error("保存题目排序失败:",c),p.error(c.message||"保存题目排序失败，请重试")}}E.value=null},ht=()=>{E.value=null},xe=l=>{const e=Me.value;if(!e)return;const d=e.viewTypes.indexOf(l);d>-1?(e.viewTypes.splice(d,1),l===1?e.codeType=void 0:l===2?e.shellBegin=void 0:l===3&&(e.containerPort=void 0,e.containerPath=void 0)):e.viewTypes.push(l),Fe(()=>{var g;(g=Y.value)==null||g.clearValidate(["viewTypes"])})},We=(l,e)=>{if(!e)return!1;const d=typeof e=="string"?Number(e):e;return F.value.some(g=>{if(!g.config.taskId)return!1;const c=typeof g.config.taskId=="string"?Number(g.config.taskId):g.config.taskId;return g.id!==l&&c===d})},bt=()=>{const l=String(Date.now()),e={id:l,name:`实验环境${F.value.length+1}`,isEditing:!1,isSaved:!1,config:{dockerImage:N.value||1,viewTypes:[],secondType:void 0,taskId:void 0,codeType:void 0,shellBegin:void 0,containerPort:void 0,containerPath:void 0}};F.value.push(e),j.value=l,p.success("添加实验环境成功")},Ct=async l=>{if(F.value.length===1){p.warning("至少保留一个实验环境");return}const e=F.value.findIndex(d=>d.id===l);if(e>-1){const d=F.value[e];d.isSaved&&await Ue(d,1),F.value.splice(e,1),j.value===l&&(j.value=F.value[0].id),d.isSaved||p.success("删除实验环境成功")}},Ye=l=>{l.isEditing=!0,D.value=l.name},Ze=l=>{D.value.trim()?(l.name=D.value.trim(),l.isEditing=!1,l.isSaved&&(p.success("重命名成功"),Ue(l))):p.warning("名称不能为空")},Tt=async l=>{const e=String(l);if(he.value&&e==="questions"){if(!_.value.taskId){p.warning("请先保存创建任务后再添加题目");return}_.value.taskId&&await Ae(_.value.taskId)}if(Be.value&&e==="evaluation"&&!_.value.taskId){p.warning("请先保存创建任务后再配置评测设置");return}B.value=e},wt=(l,e)=>{l.select=e?1:2};return(l,e)=>{const d=oa,g=sa,c=ia,r=na,T=ua,I=da,qe=ra,w=pa,V=ca,b=fa,Re=va,Xe=ga,$=ma,Ut=ya,J=ka,el=_a,ll=qa,tl=ba,ie=ha,al=Ca,ol=wa,sl=Ua,xt=xa;return u(),m("div",Pa,[e[102]||(e[102]=n("div",{class:"page-header"},[n("h2",null,"全栈环境实训项目配置")],-1)),n("div",Sa,[n("div",La,[a(g,{current:q.value,class:"custom-steps"},{default:o(()=>[a(d,{title:"基本信息"}),a(d,{title:"代码仓库"}),a(d,{title:"任务关卡"}),a(d,{title:"实验环境"})]),_:1},8,["current"])]),q.value===0?(u(),m("div",Na,[e[50]||(e[50]=n("div",{class:"section-title"},[n("h3",null,"基本信息")],-1)),n("div",Ma,[a($,{ref_key:"formRef",ref:W,model:i.value,rules:Ne,layout:"horizontal","label-col":{span:2},"wrapper-col":{span:18}},{default:o(()=>[a(r,{label:"名称",name:"name",required:""},{default:o(()=>[a(c,{value:i.value.name,"onUpdate:value":e[0]||(e[0]=t=>i.value.name=t),placeholder:"请输入名称"},null,8,["value"])]),_:1}),a(qe,null,{default:o(()=>[a(T,{span:12},{default:o(()=>[a(r,{label:"技能标签",name:"tag",required:"","label-col":{span:4},"wrapper-col":{span:20}},{default:o(()=>[a(c,{value:i.value.tag,"onUpdate:value":e[1]||(e[1]=t=>i.value.tag=t),placeholder:"请输入技能标签"},null,8,["value"])]),_:1})]),_:1}),a(T,{span:12},{default:o(()=>[a(r,{label:"领域类别",name:"fieldType",required:"","label-col":{span:4},"wrapper-col":{span:12}},{default:o(()=>[a(I,{value:i.value.fieldType,"onUpdate:value":e[2]||(e[2]=t=>i.value.fieldType=t),placeholder:"请选择领域类别",options:s(ce).options.value,loading:s(ce).loading.value},null,8,["value","options","loading"])]),_:1})]),_:1})]),_:1}),a(r,{label:"难度",name:"difficulty",required:""},{default:o(()=>[a(V,{value:i.value.difficulty,"onUpdate:value":e[3]||(e[3]=t=>i.value.difficulty=t),class:"custom-radio"},{default:o(()=>[(u(!0),m(R,null,S(s(pe).data.value,t=>(u(),h(w,{key:t.value,value:Number(t.value)},{default:o(()=>[v(U(t.name),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value"])]),_:1}),a(r,{label:"学时",name:"classHour"},{default:o(()=>[a(c,{value:i.value.classHour,"onUpdate:value":e[4]||(e[4]=t=>i.value.classHour=t),placeholder:"配置任务后自动计算",disabled:""},null,8,["value"])]),_:1}),a(r,{label:"顶部背景图",name:"topCover",required:""},{default:o(()=>[n("div",Ea,[n("div",Va,[a(Re,{"before-upload":Jl,"show-upload-list":!1,accept:"image/png,image/jpeg"},{default:o(()=>[a(b,{loading:Z.value},{default:o(()=>[Z.value?(u(),m(R,{key:1},[v("上传中...")],64)):(u(),m(R,{key:0},[v("选择文件")],64))]),_:1},8,["loading"])]),_:1}),ue.value?(u(),m("div",$a,[n("img",{src:ue.value,alt:"顶部背景图预览",style:{"max-width":"290px","max-height":"218px","border-radius":"4px"}},null,8,ja)])):k("",!0)]),e[43]||(e[43]=n("div",{class:"upload-hint"}," 说明：支持上传png/jpeg等格式文件，文件大小不能超过12M,建议使用290*218像素。 ",-1))])]),_:1}),a(r,{label:"封面图",name:"cover",required:""},{default:o(()=>[n("div",Ba,[n("div",Aa,[a(Re,{"before-upload":Wl,"show-upload-list":!1,accept:"image/png,image/jpeg"},{default:o(()=>[a(b,{loading:X.value},{default:o(()=>[X.value?(u(),m(R,{key:1},[v("上传中...")],64)):(u(),m(R,{key:0},[v("选择文件")],64))]),_:1},8,["loading"])]),_:1}),de.value?(u(),m("div",Ha,[n("img",{src:de.value,alt:"封面图预览",style:{"max-width":"290px","max-height":"218px","border-radius":"4px"}},null,8,Da)])):k("",!0)]),e[44]||(e[44]=n("div",{class:"upload-hint"}," 说明：支持上传png/jpeg等格式文件，文件大小不能超过12M,建议使用290*218像素。 ",-1))])]),_:1}),a(r,{label:"简介",name:"description"},{default:o(()=>[n("div",Ka,[a(Ie,{modelValue:i.value.description,"onUpdate:modelValue":e[5]||(e[5]=t=>i.value.description=t)},null,8,["modelValue"])])]),_:1}),a(r,{label:"任务要求",name:"showTaskRequire"},{default:o(()=>[a(Xe,{checked:i.value.showTaskRequire,"onUpdate:checked":e[6]||(e[6]=t=>i.value.showTaskRequire=t)},{default:o(()=>e[45]||(e[45]=[v(" 显示任务要求（勾选后，将帮作为任务要求显示在任务项目政策面） ")])),_:1,__:[45]},8,["checked"])]),_:1})]),_:1},8,["model"])]),e[51]||(e[51]=n("div",{class:"section-title"},[n("h3",null,"培训公开范围")],-1)),n("div",Qa,[a($,{ref_key:"trainingScopeFormRef",ref:Le,model:i.value,rules:Ne,layout:"horizontal","label-col":{span:2},"wrapper-col":{span:18}},{default:o(()=>[a(r,{label:"培训公开范围",name:"authType",required:""},{default:o(()=>[a(V,{value:i.value.authType,"onUpdate:value":e[7]||(e[7]=t=>i.value.authType=t),class:"custom-radio"},{default:o(()=>[a(w,{value:1},{default:o(()=>e[46]||(e[46]=[v("完全公开")])),_:1,__:[46]}),a(w,{value:2},{default:o(()=>e[47]||(e[47]=[v("全院公开")])),_:1,__:[47]}),a(w,{value:3},{default:o(()=>e[48]||(e[48]=[v("本单位公开")])),_:1,__:[48]}),a(w,{value:4},{default:o(()=>e[49]||(e[49]=[v("不公开")])),_:1,__:[49]})]),_:1},8,["value"])]),_:1})]),_:1},8,["model"])])])):k("",!0),q.value===1?(u(),m("div",Oa,[n("div",za,[n("div",Ga,[a(I,{value:i.value.repositoryType,"onUpdate:value":e[8]||(e[8]=t=>i.value.repositoryType=t),options:ml,class:"repository-type-select"},null,8,["value"]),n("div",Ja,[e[52]||(e[52]=n("span",{class:"url-label"},"仓库地址：",-1)),a(c,{value:i.value.gitUrl,"onUpdate:value":e[9]||(e[9]=t=>i.value.gitUrl=t),placeholder:"请输入仓库地址",class:"url-input",disabled:H.value,onBlur:et},null,8,["value","disabled"])])]),n("div",Wa,[n("div",Ya,[n("div",Za,[n("div",Xa,[e[53]||(e[53]=n("span",{class:"switch-label"},"代码仓库",-1)),a(Ut,{checked:i.value.enableCodeRepository,disabled:i.value.enableCodeRepository,onChange:Yl},null,8,["checked","disabled"])]),i.value.enableCodeRepository?(u(),h(ll,{key:0},{overlay:o(()=>[a(el,{onClick:lt},{default:o(()=>[a(J,{key:"newFile"},{default:o(()=>e[54]||(e[54]=[v("新建文件")])),_:1,__:[54]}),a(J,{key:"newFolder"},{default:o(()=>e[55]||(e[55]=[v("新建文件夹")])),_:1,__:[55]}),a(J,{key:"upload"},{default:o(()=>e[56]||(e[56]=[v("上传")])),_:1,__:[56]})]),_:1})]),default:o(()=>[a(b,{type:"primary",size:"small"},{default:o(()=>[a(s(pl)),e[57]||(e[57]=v(" 新建 "))]),_:1,__:[57]})]),_:1})):k("",!0)]),i.value.enableCodeRepository?(u(),h(Yt,{key:0,"file-tree-data":s(Ee),"expanded-keys":s(me),"onUpdate:expandedKeys":e[10]||(e[10]=t=>nl(me)?me.value=t:null),onSelect:s(Cl),onMenuClick:tt,onExpand:Zl},null,8,["file-tree-data","expanded-keys","onSelect"])):k("",!0),i.value.enableCodeRepository?(u(),m("div",eo,e[58]||(e[58]=[Lt('<div class="tips-title" data-v-669443c5>提示：</div><div class="tips-content" data-v-669443c5> 此处存放本实训所需的所有代码等相关文件，你可以通过以下： </div><div class="tips-list" data-v-669443c5> 1、<a href="#" class="tips-link" data-v-669443c5>Gitee客户端</a> 上传已有文件来开始使用。 </div><div class="tips-list" data-v-669443c5> 2、直接在平台上创建文件目录以及相关代码文件。 </div>',4)]))):k("",!0)]),n("div",lo,[i.value.enableCodeRepository?(u(),h(Zt,{key:0,"selected-file":s(kl),"highlighted-code":s(hl),"dynamic-file-contents":s(bl)},null,8,["selected-file","highlighted-code","dynamic-file-contents"])):(u(),m("div",to," 在左侧代码仓库区域点击目录打开文件 "))])])])])):k("",!0),q.value===2?(u(),m("div",ao,[n("div",oo,[n("div",so,[n("div",no,[a(b,{type:"primary",onClick:e[11]||(e[11]=t=>s(be)("kernel"))},{default:o(()=>e[59]||(e[59]=[v("添加内核链接任务")])),_:1,__:[59]}),a(b,{type:"primary",onClick:e[12]||(e[12]=t=>s(be)("choice"))},{default:o(()=>e[60]||(e[60]=[v("添加选择题任务")])),_:1,__:[60]}),i.value.enableCodeRepository?(u(),h(b,{key:0,type:"primary",onClick:e[13]||(e[13]=t=>s(be)("programming"))},{default:o(()=>e[61]||(e[61]=[v("添加编程任务")])),_:1,__:[61]})):k("",!0)])]),n("div",io,[n("div",ro,[n("div",uo,"任务关卡 ("+U(s(M).length)+")",1),n("div",co,[(u(!0),m(R,null,S(s(M),t=>(u(),m("div",{key:t.id,class:A(["list-item",{active:s(je)===t.id}]),onClick:f=>s(Ce)(t.id)},[n("span",vo,U(t.name),1),a(s(re),{class:"delete-icon",onClick:il(f=>s(Sl)(t.id),["stop"])},null,8,["onClick"])],10,po))),128))])]),n("div",fo,[s(je)?(u(),m("div",go,[a(sl,{activeKey:s(B),onChange:Tt},Nt({default:o(()=>[a(ie,{key:"task",tab:"关联任务"},{default:o(()=>[a($,{ref_key:"taskLevelFormRef",ref:_e,model:s(_),rules:s(Fl),layout:"horizontal","label-col":{span:4},"wrapper-col":{span:18}},{default:o(()=>[a(r,{label:"任务名称",name:"name",required:""},{default:o(()=>[a(c,{value:s(_).name,"onUpdate:value":e[14]||(e[14]=t=>s(_).name=t),placeholder:"请输入任务名称"},null,8,["value"])]),_:1}),a(r,{label:"学习资源",name:"source",required:""},{default:o(()=>[a(Re,{"file-list":s(ke),"onUpdate:fileList":e[15]||(e[15]=t=>nl(ke)?ke.value=t:null),"custom-request":s(Ml),onChange:s(El),accept:".doc,.docx,.pdf,.ppt,.pptx,.mp4","max-count":10},{default:o(()=>[a(b,{type:"primary"},{default:o(()=>e[63]||(e[63]=[v("点击上传")])),_:1,__:[63]})]),_:1},8,["file-list","custom-request","onChange"]),e[64]||(e[64]=n("div",{class:"upload-hint"}," 说明：支持上传word、pdf、ppt、mp4等格式文件，每个文件大小不能超过500M。 ",-1))]),_:1,__:[64]}),a(r,{label:"任务要求",name:"require",required:""},{default:o(()=>[a(Ie,{modelValue:s(_).require,"onUpdate:modelValue":e[16]||(e[16]=t=>s(_).require=t),placeholder:"请输入任务要求",onChange:ct},null,8,["modelValue"])]),_:1}),a(r,{label:"参考答案",name:"referenceAnswer",required:""},{default:o(()=>[a(Ie,{modelValue:s(_).referenceAnswer,"onUpdate:modelValue":e[17]||(e[17]=t=>s(_).referenceAnswer=t),placeholder:"请输入参考答案",onChange:pt},null,8,["modelValue"])]),_:1}),a(r,{label:"难度系数",name:"difficulty",required:""},{default:o(()=>[a(V,{value:s(_).difficulty,"onUpdate:value":e[18]||(e[18]=t=>s(_).difficulty=t),class:"custom-radio"},{default:o(()=>[(u(!0),m(R,null,S(s(pe).data.value,t=>(u(),h(w,{key:t.value,value:Number(t.value)},{default:o(()=>[v(U(t.name),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value"])]),_:1}),a(r,{label:"技能标签",name:"tag",required:""},{default:o(()=>[a(c,{value:s(_).tag,"onUpdate:value":e[19]||(e[19]=t=>s(_).tag=t),placeholder:"请输入技能标签"},null,8,["value"])]),_:1}),s(Pl)?(u(),h(r,{key:0,label:"内嵌链接",name:"jumpUrl",required:""},{default:o(()=>[a(c,{value:s(_).jumpUrl,"onUpdate:value":e[20]||(e[20]=t=>s(_).jumpUrl=t),placeholder:"请输入内嵌链接"},null,8,["value"])]),_:1})):k("",!0),a(r,{label:"任务学时",name:"classHour",required:""},{default:o(()=>[a(tl,{style:{width:"100%"},min:0,value:s(_).classHour,"onUpdate:value":e[21]||(e[21]=t=>s(_).classHour=t),placeholder:"请输入任务学时"},null,8,["value"])]),_:1})]),_:1},8,["model","rules"])]),_:1}),s(he)?(u(),h(ie,{key:"questions",tab:"题目"},{default:o(()=>[s(te).length===0?(u(),m("div",mo,[a(al,{description:"暂无题目，请点击右上方按钮新增题目"})])):(u(),m("div",yo,[(u(!0),m(R,null,S(s(te),(t,f)=>(u(),m("div",{key:t.id,class:A(["question-item",{dragging:E.value===f}]),draggable:"true",onDragstart:x=>yt(f),onDragover:_t,onDrop:x=>kt(x,f),onDragend:ht},[n("div",ko,[n("div",ho,[a(s(Ta),{class:"drag-handle"}),n("span",bo,"题目"+U(f+1),1)]),n("div",Co,[a(s(vl),{class:"edit-icon",onClick:x=>ft(t)},null,8,["onClick"]),a(s(re),{class:"delete-icon",onClick:x=>s(Ql)(t.id)},null,8,["onClick"])])]),n("div",To,[t.name?(u(),m("div",wo,[v(U(f+1)+"、 ",1),n("div",{innerHTML:t.name},null,8,Uo)])):(u(),m("div",xo,"暂无题干"))]),n("div",qo,[(u(!0),m(R,null,S(mt(t),(x,qt)=>(u(),m("div",{key:qt,class:A(["option-row",{"is-correct":Je(t,x.label)}])},[n("span",Ro,U(x.label)+".",1),n("span",Fo,U(x.content),1),Je(t,x.label)?(u(),m("span",Io,"正确答案")):k("",!0)],2))),128))]),n("div",Po,[e[65]||(e[65]=n("div",{class:"explanation-label"},"答案解析：",-1)),n("div",So,[t.answerKey?(u(),m("span",Lo,U(t.answerKey),1)):(u(),m("span",No,"暂无答案解析"))])])],42,_o))),128))]))]),_:1})):k("",!0),s(Be)?(u(),h(ie,{key:"evaluation",tab:"评测设置"},{default:o(()=>[n("div",Mo,[n("div",Eo,[e[72]||(e[72]=n("div",{class:"section-header"},"评测文件",-1)),a($,{ref_key:"evaluationFormRef",ref:Rl,model:s(C),rules:s(Il),layout:"horizontal","label-col":{span:4},"wrapper-col":{span:18}},{default:o(()=>[a(r,{label:"评测时长限制",name:"timeLimitM",required:""},{default:o(()=>[a(tl,{value:s(C).timeLimitM,"onUpdate:value":e[22]||(e[22]=t=>s(C).timeLimitM=t),min:0,placeholder:"请输入评测时长限制",style:{width:"200px"}},null,8,["value"]),e[66]||(e[66]=n("span",{style:{"margin-left":"8px"}},"分钟",-1))]),_:1,__:[66]}),a(r,{label:"学员任务文件",name:"userFiles",required:""},{default:o(()=>[n("div",Vo,[a(b,{type:"primary",onClick:e[23]||(e[23]=t=>Te.value=!0)},{default:o(()=>e[67]||(e[67]=[v("点击选择")])),_:1,__:[67]}),n("div",$o,[(u(!0),m(R,null,S(s(ee),t=>(u(),h(ol,{key:t.uid,closable:"",onClose:()=>{ee.value=s(ee).filter(f=>f.uid!==t.uid),s(C).userFiles=[...s(ee)]},style:{margin:"4px"}},{default:o(()=>[v(U(t.name),1)]),_:2},1032,["onClose"]))),128))])]),e[68]||(e[68]=n("div",{class:"upload-hint"}," 说明：从代码仓库中选择文件。（学员评测基本任务时名称，查看效果页上需要编辑的文件类型） ",-1))]),_:1,__:[68]}),a(r,{label:"评测执行文件",name:"testValidateFiles",required:""},{default:o(()=>[n("div",jo,[a(b,{type:"primary",onClick:e[24]||(e[24]=t=>we.value=!0)},{default:o(()=>e[69]||(e[69]=[v("点击选择")])),_:1,__:[69]}),n("div",Bo,[(u(!0),m(R,null,S(s(le),t=>(u(),h(ol,{key:t.uid,closable:"",onClose:()=>{le.value=s(le).filter(f=>f.uid!==t.uid),s(C).testValidateFiles=[...s(le)]},style:{margin:"4px"}},{default:o(()=>[v(U(t.name),1)]),_:2},1032,["onClose"]))),128))])]),e[70]||(e[70]=n("div",{class:"upload-hint"},' 说明：从代码仓库中选择文件。（点击评测按钮时调用的文件，用于检验学员任务结果是否正确，可与"学员任务文件"一致） ',-1))]),_:1,__:[70]}),a(r,{label:"评测执行命令",name:"testValidateSh",required:""},{default:o(()=>[a(c,{value:s(C).testValidateSh,"onUpdate:value":e[25]||(e[25]=t=>s(C).testValidateSh=t),placeholder:"请输入评测执行命令，例如：python main.py"},null,8,["value"]),e[71]||(e[71]=n("div",{class:"upload-hint"}," （执行评测文件的命令，如：python main.py、node index.js、java Main 等） ",-1))]),_:1,__:[71]})]),_:1},8,["model","rules"])]),n("div",Ao,[e[79]||(e[79]=n("div",{class:"section-header"},"评测规则",-1)),a($,{layout:"horizontal","label-col":{span:4},"wrapper-col":{span:18}},{default:o(()=>[a(r,{label:"通关判定"},{default:o(()=>[a(V,{value:s(C).passType,"onUpdate:value":e[26]||(e[26]=t=>s(C).passType=t),class:"custom-radio"},{default:o(()=>[a(w,{value:1},{default:o(()=>e[73]||(e[73]=[v("实际输出与期望输出对比")])),_:1,__:[73]}),a(w,{value:2},{default:o(()=>e[74]||(e[74]=[v("实际输出满足规则")])),_:1,__:[74]})]),_:1},8,["value"])]),_:1}),s(C).passType===2?(u(),h(r,{key:0,label:"判定规则"},{default:o(()=>[a(c,{value:s(C).passTypeRule,"onUpdate:value":e[27]||(e[27]=t=>s(C).passTypeRule=t),placeholder:"请输入判定规则"},null,8,["value"]),e[75]||(e[75]=n("div",{class:"upload-hint"}," （请输入实际输出满足的规则描述） ",-1))]),_:1,__:[75]})):k("",!0),a(r,{label:"空格处理"},{default:o(()=>[a(V,{value:s(C).blankCode,"onUpdate:value":e[28]||(e[28]=t=>s(C).blankCode=t),class:"custom-radio"},{default:o(()=>[a(w,{value:1},{default:o(()=>e[76]||(e[76]=[v("不忽略空格")])),_:1,__:[76]}),a(w,{value:2},{default:o(()=>e[77]||(e[77]=[v("忽略首尾空格")])),_:1,__:[77]}),a(w,{value:3},{default:o(()=>e[78]||(e[78]=[v("忽略所有空格(仅通过空格中自动添加所有空格进行对比)")])),_:1,__:[78]})]),_:1},8,["value"])]),_:1})]),_:1})]),n("div",Ho,[e[88]||(e[88]=n("div",{class:"section-header"},"测试集",-1)),a($,{layout:"horizontal","label-col":{span:4},"wrapper-col":{span:18}},{default:o(()=>[a(r,{label:"得分规则"},{default:o(()=>[a(V,{value:s(C).scoreRule,"onUpdate:value":e[29]||(e[29]=t=>s(C).scoreRule=t),class:"custom-radio"},{default:o(()=>[a(w,{value:1},{default:o(()=>e[80]||(e[80]=[v("通过全部测试集（所有测试集都正确，才获取对应积分；否则得0学分）")])),_:1,__:[80]}),a(w,{value:2},{default:o(()=>e[81]||(e[81]=[v("通过部分测试集（选中的测试集全部正确，获取任务学分；否则得0学分）")])),_:1,__:[81]})]),_:1},8,["value"])]),_:1}),a(r,{label:"用例类型"},{default:o(()=>[n("div",Do,[a(V,{value:s(C).testValidateType,"onUpdate:value":e[30]||(e[30]=t=>s(C).testValidateType=t),class:"custom-radio"},{default:o(()=>[a(w,{value:1},{default:o(()=>e[82]||(e[82]=[v("文本")])),_:1,__:[82]}),a(w,{value:2},{default:o(()=>e[83]||(e[83]=[v("文件")])),_:1,__:[83]})]),_:1},8,["value"]),s(C).testValidateType===1?(u(),m("div",Ko,[a(b,{type:"primary",onClick:s(jl)},{default:o(()=>e[84]||(e[84]=[v("新增测试集")])),_:1,__:[84]},8,["onClick"]),a(b,{onClick:s(Al)},{default:o(()=>e[85]||(e[85]=[v("一键删除测试用例")])),_:1,__:[85]},8,["onClick"]),a(b,{onClick:s(Hl)},{default:o(()=>e[86]||(e[86]=[v("下载测试用例模板")])),_:1,__:[86]},8,["onClick"]),a(b,{onClick:s(Dl)},{default:o(()=>e[87]||(e[87]=[v("批量上传测试用例")])),_:1,__:[87]},8,["onClick"])])):k("",!0)])]),_:1}),s(C).testValidateType===1&&s(C).testContent.length>0?(u(),m("div",Qo,[(u(!0),m(R,null,S(s(C).testContent,(t,f)=>(u(),m("div",{key:t.id,class:"test-case-item"},[a(Xe,{checked:t.select===1,onChange:x=>wt(t,x.target.checked),class:"test-case-checkbox"},null,8,["checked","onChange"]),n("span",Oo,"测试集"+U(f+1),1),a(c,{value:t.arg,"onUpdate:value":x=>t.arg=x,placeholder:"请输入输入内容",class:"test-case-input"},null,8,["value","onUpdate:value"]),a(c,{value:t.answer,"onUpdate:value":x=>t.answer=x,placeholder:"请输入期望输出",class:"test-case-output"},null,8,["value","onUpdate:value"]),a(s(re),{class:"delete-test-case",onClick:x=>s(Bl)(t.id)},null,8,["onClick"])]))),128))])):k("",!0)]),_:1})])])]),_:1})):k("",!0)]),_:2},[s(he)&&s(B)==="questions"?{name:"tabBarExtraContent",fn:o(()=>[a(b,{type:"primary",onClick:vt},{default:o(()=>[a(s(pl)),e[62]||(e[62]=v(" 新增题目 "))]),_:1,__:[62]})]),key:"0"}:void 0]),1032,["activeKey"]),s(B)!=="questions"?(u(),m("div",zo,[s(_).taskId?k("",!0):(u(),h(b,{key:0,onClick:s(Nl)},{default:o(()=>e[89]||(e[89]=[v("重置")])),_:1,__:[89]},8,["onClick"])),a(b,{type:"primary",onClick:s(Ll)},{default:o(()=>[v(U(s(_).taskId?"更新":"保存"),1)]),_:1},8,["onClick"])])):k("",!0)])):(u(),m("div",Go,[a(al,{description:"请先添加任务关卡"})]))])])])])):k("",!0),q.value===3?(u(),m("div",Jo,[n("div",Wo,[n("div",Yo,[e[92]||(e[92]=n("h3",{class:"environment-title"},"实验环境",-1)),n("div",Zo,[a(b,{type:"primary",onClick:bt},{default:o(()=>e[90]||(e[90]=[v("添加实验环境")])),_:1,__:[90]}),a(b,null,{default:o(()=>e[91]||(e[91]=[v("设置")])),_:1,__:[91]})])]),a($,{ref_key:"experimentFormRef",ref:Y,model:s(Me),rules:_l,"label-col":{span:4},"wrapper-col":{span:18}},{default:o(()=>[a(sl,{activeKey:j.value,"onUpdate:activeKey":e[36]||(e[36]=t=>j.value=t)},{default:o(()=>[(u(!0),m(R,null,S(F.value,t=>(u(),h(ie,{key:t.id},{tab:o(()=>[n("div",Xo,[t.isEditing?(u(),h(c,{key:0,value:D.value,"onUpdate:value":e[31]||(e[31]=f=>D.value=f),size:"small",style:{width:"120px"},onPressEnter:f=>Ze(t),onBlur:f=>Ze(t)},null,8,["value","onPressEnter","onBlur"])):(u(),m(R,{key:1},[n("span",{onDblclick:f=>Ye(t)},U(t.name),41,es),a(ll,{trigger:["click"]},{overlay:o(()=>[a(el,null,{default:o(()=>[a(J,{onClick:f=>Ye(t)},{default:o(()=>[a(s(vl)),e[93]||(e[93]=v(" 重命名 "))]),_:2,__:[93]},1032,["onClick"]),a(J,{onClick:f=>Ct(t.id)},{default:o(()=>[a(s(re)),e[94]||(e[94]=v(" 删除 "))]),_:2,__:[94]},1032,["onClick"])]),_:2},1024)]),default:o(()=>[a(s(Ra),{class:"tab-more-icon",onClick:e[32]||(e[32]=il(()=>{},["stop"]))})]),_:2},1024)],64))])]),default:o(()=>[a(r,{label:"实验镜像",name:"dockerImage",required:""},{default:o(()=>[n("div",ls," 系统实验镜像默认为"+U(gl())+"。 ",1)]),_:1}),a(r,{label:"实验界面",name:"viewTypes",required:""},{default:o(()=>[n("div",ts,[n("div",{class:A(["interface-card",{active:t.config.viewTypes.includes(1)}]),onClick:e[33]||(e[33]=f=>xe(1))},e[95]||(e[95]=[n("div",{class:"card-title"},"代码编辑器",-1),n("div",{class:"card-desc"},"提供代码编辑器，编辑器，调试器等工具",-1)]),2),n("div",{class:A(["interface-card",{active:t.config.viewTypes.includes(2)}]),onClick:e[34]||(e[34]=f=>xe(2))},e[96]||(e[96]=[n("div",{class:"card-title"},"命令行终端",-1),n("div",{class:"card-desc"},"提供命令行窗口",-1)]),2),n("div",{class:A(["interface-card",{active:t.config.viewTypes.includes(3)}]),onClick:e[35]||(e[35]=f=>xe(3))},e[97]||(e[97]=[n("div",{class:"card-title"},"容器内服务",-1),n("div",{class:"card-desc"},"直接预览容器内部Web服务",-1)]),2)])]),_:2},1024),a(r,{label:"附带环境",name:"secondType",required:""},{default:o(()=>[a(I,{value:t.config.secondType,"onUpdate:value":f=>t.config.secondType=f,placeholder:"请选择附带环境",options:s(ve).options.value,loading:s(ve).loading.value,allowClear:""},null,8,["value","onUpdate:value","options","loading"])]),_:2},1024),a(r,{label:"任务关卡",name:"taskId",required:""},{default:o(()=>[a(I,{value:t.config.taskId,"onUpdate:value":f=>t.config.taskId=f,placeholder:"请选择任务关卡",allowClear:""},{default:o(()=>[(u(!0),m(R,null,S(s(M),f=>(u(),h(xt,{key:f.taskId||f.id,value:f.taskId?String(f.taskId):void 0,disabled:!f.taskId||We(t.id,f.taskId)},{default:o(()=>[v(U(f.name)+" ",1),f.taskId?We(t.id,f.taskId)?(u(),m("span",os," (已被使用)")):k("",!0):(u(),m("span",as," (未保存)"))]),_:2},1032,["value","disabled"]))),128))]),_:2},1032,["value","onUpdate:value"])]),_:2},1024),t.config.viewTypes.includes(1)?(u(),h(r,{key:0,label:"编程语言",name:"codeType",required:""},{default:o(()=>[a(I,{value:t.config.codeType,"onUpdate:value":f=>t.config.codeType=f,placeholder:"请选择编程语言",options:s(fe).options.value,loading:s(fe).loading.value,allowClear:""},null,8,["value","onUpdate:value","options","loading"])]),_:2},1024)):k("",!0),t.config.viewTypes.includes(2)?(u(),h(r,{key:1,label:"开启时触发命令",name:"shellBegin",required:""},{default:o(()=>[a(c,{value:t.config.shellBegin,"onUpdate:value":f=>t.config.shellBegin=f,placeholder:"请输入命令"},null,8,["value","onUpdate:value"])]),_:2},1024)):k("",!0),t.config.viewTypes.includes(3)?(u(),h(r,{key:2,label:"容器端口",name:"containerPort",required:""},{default:o(()=>[a(c,{value:t.config.containerPort,"onUpdate:value":f=>t.config.containerPort=f,placeholder:"请输入容器端口"},null,8,["value","onUpdate:value"])]),_:2},1024)):k("",!0),t.config.viewTypes.includes(3)?(u(),h(r,{key:3,label:"路由"},{default:o(()=>[a(c,{value:t.config.containerPath,"onUpdate:value":f=>t.config.containerPath=f,placeholder:"请输入路由（选填）"},null,8,["value","onUpdate:value"])]),_:2},1024)):k("",!0),a(r,{"wrapper-col":{offset:4,span:18}},{default:o(()=>[a(b,{class:"w-full",type:"primary",onClick:f=>Ue(t)},{default:o(()=>[v(U(t.isSaved?"更新":"保存"),1)]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024))),128))]),_:1},8,["activeKey"])]),_:1},8,["model"])])])):k("",!0),n("div",ss,[q.value===0?(u(),h(b,{key:0,onClick:Ge},{default:o(()=>e[98]||(e[98]=[v("返回")])),_:1,__:[98]})):(u(),h(b,{key:1,onClick:Ge},{default:o(()=>e[99]||(e[99]=[v("上一步")])),_:1,__:[99]})),q.value===3?(u(),h(b,{key:2,type:"primary",onClick:dt},{default:o(()=>e[100]||(e[100]=[v("完成创建")])),_:1,__:[100]})):(u(),h(b,{key:3,type:"primary",onClick:rt},{default:o(()=>e[101]||(e[101]=[v("下一步")])),_:1,__:[101]}))])]),n("input",{ref_key:"fileUploadInput",ref:He,type:"file",style:{display:"none"},onChange:st},null,544),a(Xt,{open:K.value,"onUpdate:open":e[37]||(e[37]=t=>K.value=t),onConfirm:Xl,onCancel:Ke},null,8,["open"]),a(ea,{open:ae.value,"onUpdate:open":e[38]||(e[38]=t=>ae.value=t),"parent-path":O.value,onConfirm:nt},null,8,["open","parent-path"]),a(la,{open:oe.value,"onUpdate:open":e[39]||(e[39]=t=>oe.value=t),"parent-path":z.value,onConfirm:it},null,8,["open","parent-path"]),a(aa,{open:se.value,"onUpdate:open":e[40]||(e[40]=t=>se.value=t),question:Q.value,"project-id":P.value??void 0,"task-id":s(_).taskId,"existing-questions":s(te),onConfirm:gt},null,8,["open","question","project-id","task-id","existing-questions"]),a(cl,{open:Te.value,"onUpdate:open":e[41]||(e[41]=t=>Te.value=t),title:"选择学员任务文件","git-url":i.value.gitUrl,onConfirm:s(Vl)},null,8,["open","git-url","onConfirm"]),a(cl,{open:we.value,"onUpdate:open":e[42]||(e[42]=t=>we.value=t),title:"选择评测执行文件","git-url":i.value.gitUrl,onConfirm:s($l)},null,8,["open","git-url","onConfirm"])])}}}),ms=Ia(ns,[["__scopeId","data-v-669443c5"]]);export{ms as default};
